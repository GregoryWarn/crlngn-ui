{"version":3,"file":"crlngn-ui.js","sources":["../../src/constants/Hooks.mjs","../../src/constants/General.mjs","../../src/components/LogUtil.mjs","../../src/constants/Settings.mjs","../../src/components/settings-dialogs/CameraDockSettings.mjs","../../src/components/settings-dialogs/ChatMessagesSettings.mjs","../../src/components/GeneralUtil.mjs","../../src/components/settings-dialogs/CustomFontSettings.mjs","../../src/components/settings-dialogs/LeftControlsSettings.mjs","../../src/components/settings-dialogs/SceneNavSettings.mjs","../../src/components/settings-dialogs/ThemeAndStylesSettings.mjs","../../src/constants/SettingMenus.mjs","../../src/components/CameraUtil.mjs","../../src/components/ChatUtil.mjs","../../src/components/ModuleCompatUtil.mjs","../../src/components/TopNavUtil.mjs","../../src/components/SceneFoldersUtil.mjs","../../src/components/SettingsUtil.mjs","../../src/components/PlayersListUtil.mjs","../../src/components/LeftControlsUtil.mjs","../../src/components/Main.mjs","../../src/module.mjs"],"sourcesContent":["/**\n * Foundry Core hooks\n * https://foundryvtt.com/api/classes/client.Hooks.html\n * https://foundryvtt.com/api/modules/hookEvents.html\n * */ \nexport const HOOKS_CORE = {\n  INIT: \"init\", \n  READY: \"ready\", \n\n  /* Chat Messages */\n  RENDER_CHAT_MESSAGE: \"renderChatMessage\" ,\n\n  /* Left Side Controls */\n  GET_SCENE_CONTROLS: \"getSceneControlButtons\",\n  RENDER_SCENE_CONTROLS: \"renderSceneControls\",\n  RENDER_PLAYERS_LIST: \"renderPlayerList\",\n\n  /* Scenes */\n  RENDER_SCENE_NAV: \"renderSceneNavigation\",\n  COLLAPSE_SCENE_NAV: \"collapseSceneNavigation\",\n  EXPAND_SCENE_NAV: \"expandSceneNavigation\",\n  GET_SCENE_NAV_CONTEXT: \"getSceneNavigationContext\",\n  GET_SCENE_DIRECTORY_ENTRY_CONTEXT: \"getSceneDirectoryEntryContext\",\n\n  /* Document Directory */\n  RENDER_DOCUMENT_DIRECTORY: \"renderDocumentDirectory\",\n\n  /* Folders */\n  CREATE_FOLDER: \"createFolder\",\n  UPDATE_FOLDER: \"updateFolder\",\n  DELETE_FOLDER: \"deleteFolder\",\n\n  /* Scene Document */\n  CREATE_SCENE: \"createScene\",\n  UPDATE_SCENE: \"updateScene\",\n  DELETE_SCENE: \"deleteScene\",\n\n  /* Right Side Panel */\n  COLLAPSE_SIDE_BAR: \"collapseSidebar\",\n\n  /* Macros */\n  RENDER_HOTBAR: \"renderHotbar\",\n\n  /* Camera Views */\n  RENDER_CAMERA_VIEWS: \"renderCameraViews\",\n\n  /* Update user */\n  UPDATE_USER: \"updateUser\",\n  UPDATE_DOCUMENT: \"updateDocument\"\n}","export const MODULE_ID = \"crlngn-ui\";\nexport const MODULE_TITLE = \"Carolingian UI\";\nexport const MODULE_SHORT = \"crlngn-ui\";\nexport const DEBUG_TAG = [\n  `%cCarolingian UI`,\n  `color:rgb(54, 0, 119); font-weight: bold;`,\n  `|`,\n];\n\nexport const ROLL_TYPES = {\n  abilityCheck: \"ability\",\n  abilitySave: \"save\",\n  attack: \"attack\",\n  check: \"check\",\n  concentration: \"concentration\",\n  damage: \"damage\",\n  deathSave: \"death\",\n  formula: \"formula\",\n  healing: \"heal\",\n  custom: \"roll\",\n  skillCheck: \"skill\",\n  toolCheck: \"tool\"\n}\n\nexport const CHAR_ABILITIES = [\n  { abbrev: \"str\", name: \"strength\" },\n  { abbrev: \"dex\", name: \"dexterity\" },\n  { abbrev: \"con\", name: \"constitution\" },\n  { abbrev: \"int\", name: \"intelligence\" },\n  { abbrev: \"wis\", name: \"wisdom\" },\n  { abbrev: \"cha\", name: \"charisma\" }\n]\n\nexport const CLASS_PREFIX = 'crlngn';","import { DEBUG_TAG } from \"../constants/General.mjs\";\n\n/**\n * Utility class for handling logging operations in the module\n * Provides methods for debug, warning, and error logging with module context\n */\nexport class LogUtil {\n  /** @type {boolean} Whether debug logging is enabled */\n  static debugOn = false;\n  /**\n   * Outputs information on console, adding module name and reference\n   * @param {string} ref - Reference information to log after module name\n   * @param {any[]} data - data to log on console\n   */\n  static log(ref=\"\", data=[], bypassSettings=false){\n    try{\n      const debugSetting = LogUtil.debugOn;\n      const isDebugModeOn = bypassSettings || debugSetting;\n      if(!isDebugModeOn){ return };\n      console.log(...DEBUG_TAG, ref, ...data);\n    }catch(e){\n      console.log(...DEBUG_TAG, ref, ...data);\n    }\n  }\n\n  /**\n   * Outputs information on console, adding module name and reference\n   * @param {string} ref - Reference information to log after module name\n   * @param {any[]} data - data to log on console\n   */\n  static warn(ref=\"\", data=[]){\n    console.warn(...DEBUG_TAG, ref, ...data);\n  }\n\n  /**\n   * Logs an error to the console and/or UI notification\n   * @param {string} strRef - Reference string for the error\n   * @param {object} options - Error logging configuration\n   * @param {boolean} [options.ui=false] - Whether to show UI notification\n   * @param {boolean} [options.console=true] - Whether to log to console\n   * @param {boolean} [options.permanent=false] - Whether UI notification should be permanent\n   * @static\n   */\n  static logError(strRef, options){ // = { ui:false, console:true, permanent:false }) {\n      if(options.ui){\n          // console.log(ui.notifications);\n          ui.notifications?.error(strRef, { localize: true, permanent: options.permanent });\n      }\n      if(options.console) console.error(...DEBUG_TAG, strRef);\n  }\n}\n\n","export const SETTING_INPUT = {\n  select: \"select\", \n  checkbox: \"checkbox\",\n  text: \"text\",\n  number: \"number\"\n}\n\nexport const SETTING_SCOPE = {\n  client: \"client\",\n  world: \"world\"\n}\n\nexport const ICON_SIZES = {\n  small: { name: 'small', size: '36px'},\n  regular: { name: 'regular', size: '42px'},\n}\n\nexport const BORDER_COLOR_TYPES = {\n  playerColor: { name: 'playerColor'},\n  rollType: { name: 'rollType'},\n  none: {\n    name: 'none'\n  }\n}\n\nexport const THEMES = [\n  {\n    label: 'Carolingian Teal',\n    className: '',\n    colorPreview: [\n      'rgb(62, 62, 88)',\n      'rgb(68, 147, 173)'\n    ]\n  },\n  {\n    label: \"Gold and Chocolate\",\n    className: 'crlngn-theme-gold-chocolate',\n    colorPreview: [\n      'rgb(34, 25, 25)',\n      'rgb(164, 138, 51)'\n    ]\n  },\n  {\n    label: \"Royal Blood\",\n    className: 'crlngn-theme-royal-blood',\n    colorPreview: [\n      'rgb(40, 31, 49)',\n      'rgb(127, 18, 36)'\n    ]\n  },\n  {\n    label: \"Dark Sorcery\",\n    className: 'crlngn-theme-dark-sorcery',\n    colorPreview: [\n      'rgb(31, 47, 49)',\n      'rgb(94, 57, 127)'\n    ]\n  },\n  {\n    label: \"Tangerine\",\n    className: 'crlngn-theme-tangerine',\n    colorPreview: [\n      'rgb(40, 31, 49)',\n      'rgb(220, 120, 43)'\n    ]\n  }\n];\n\nexport function getSettings() { \n  return {\n    customFontsMenu: {\n      tag: \"custom-font-families\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.label\"),\n      title: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.hint\"),\n      description: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.description\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: [\n        'uiFontBody',\n        'uiFontTitles',\n        'journalFontBody',\n        'journalFontTitles'\n      ],\n      default: {\n        uiFontBody: `\"Work Sans\", Arial, sans-serif`,\n        uiFontTitles: `\"Roboto Slab\", Arial, sans-serif`,\n        journalFontBody: `\"Work Sans\", Arial, sans-serif`, \n        journalFontTitles: `\"Roboto Slab\", Arial, sans-serif`\n      },\n      scope: SETTING_SCOPE.world,\n      config: false, \n      requiresReload: false \n    },\n\n    themeAndStylesMenu: {\n      tag: \"theme-styles-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.label\"),\n      title: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.hint\"),\n      propType: String,\n      fields: [\n        \"colorTheme\", \n        \"adjustOtherModules\", \n        \"customStyles\" \n      ],\n      default: {\n        colorTheme: '',\n        adjustOtherModules: false,\n        customStyles: ''\n      },\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    chatMessagesMenu: {\n      tag: \"chat-messages-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: [\n        \"enableChatStyles\",\n        \"chatBorderColor\"\n      ],\n      default: { \n        enableChatStyles: true,\n        chatBorderColor: BORDER_COLOR_TYPES.playerColor.name\n      },\n      scope: SETTING_SCOPE.client,\n      config: false,\n      requiresReload: false\n    },\n\n    leftControlsMenu: {\n      tag: \"left-controls-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: [\n        \"controlsBottomBuffer\",\n        \"controlsIconSize\",\n        \"controlsAutoHide\",\n        \"hideFoundryLogo\"\n      ],\n      default: { \n        bottomBuffer: 200,\n        iconSize: ICON_SIZES.small.name,\n        autoHideSecondary: false,\n        hideFoundryLogo: true\n      },\n      scope: SETTING_SCOPE.client,\n      config: false,\n      requiresReload: false\n    },\n\n    cameraDockMenu: {\n      tag: \"camera-dock-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: {\n        enableFloatingDock: { \n          tag: \"enable-floating-camera-dock\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.enableFloatingDock.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.enableFloatingDock.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        },\n        dockPosX: {\n          tag: \"camera-dock-x\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosX.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosX.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockPosY: {\n          tag: \"camera-dock-y\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosY.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosY.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockWidth: {\n          tag: \"camera-dock-width\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockWidth.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockWidth.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockHeight: {\n          tag: \"camera-dock-height\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockHeight.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockHeight.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n      },\n      default: {\n        enableFloatingDock: true,\n        dockPosX: 0,\n        dockPosY: 120,\n        dockWidth: 140,\n        dockHeight: 140\n      },\n      scope: SETTING_SCOPE.client,\n      config: false, \n      requiresReload: false \n    },\n\n    sceneNavMenu: {\n      tag: \"scene-nav-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: [\n        \"sceneNavEnabled\",\n        \"navFoldersEnabled\",\n        \"showFolderListOnClick\",\n        \"navStartCollapsed\",\n        \"showNavOnHover\"\n      ],\n      default: {\n        sceneNavEnabled: true,\n        navFoldersEnabled: true,\n        navStartCollapsed: false,\n        showFolderListOnClick: false,\n        showNavOnHover: false\n      },\n      scope: SETTING_SCOPE.client,\n      config: false, \n      requiresReload: true \n    },\n\n    // sceneNavMenu: {\n    //   tag: \"scene-nav-menu\", \n    //   label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.label\"),\n    //   hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.hint\"),\n    //   propType: Object,\n    //   inputType: SETTING_INPUT.button,\n    //   fields: {\n    //     sceneNavEnabled: { \n    //       tag: \"scene-nav-enabled\", \n    //       label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.sceneNavEnabled.label\"), \n    //       hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.sceneNavEnabled.hint\"), \n    //       inputType: SETTING_INPUT.checkbox\n    //     },\n    //     showNavOnHover: {\n    //       tag: \"show-nav-on-hover\", \n    //       label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showNavOnHover.label\"), \n    //       hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showNavOnHover.hint\"), \n    //       inputType: SETTING_INPUT.checkbox\n    //     }\n    //   },\n    //   default: {\n    //     sceneNavEnabled: true,\n    //     showNavOnHover: false\n    //   },\n    //   scope: SETTING_SCOPE.client,\n    //   config: false, \n    //   requiresReload: true \n    // },\n\n    sceneNavEnabled: { \n      tag: \"scene-nav-enabled\", \n      oldName: \"sceneNavEnabled\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.sceneNavEnabled.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.sceneNavEnabled.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n    navFoldersEnabled: { \n      tag: \"nav-folders-enabled\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.navFoldersEnabled.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.navFoldersEnabled.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n    navFoldersForPlayers: { \n      tag: \"nav-folders-for-players\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.navFoldersForPlayers.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.navFoldersForPlayers.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: false, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n    navStartCollapsed: { \n      tag: \"nav-start-collapsed\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.navStartCollapsed.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.navStartCollapsed.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox,\n      default: false, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n    showFolderListOnClick: { \n      tag: \"nav-folders-list-on-click\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showFolderListOnClick.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showFolderListOnClick.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: false, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n    showNavOnHover: { \n      tag: \"show-nav-on-hover\", \n      oldName: \"showNavOnHover\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showNavOnHover.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showNavOnHover.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: false, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n    sceneNavCollapsed: { \n      tag: \"scene-nav-collapsed\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavCollapsed.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavCollapsed.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },  \n\n    sceneNavPos: { \n      tag: \"scene-nav-pos\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavPos.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavPos.hint\"), \n      propType: Number, \n      inputType: SETTING_INPUT.number, \n      default: 0, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n    /*\n    enableChatStyles: { \n      tag: \"enable-chat-styles\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.enableChatStyles.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.enableChatStyles.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: true \n    },\n    */\n\n    enableMacroLayout: { \n      tag: \"enable-macro-layout\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.enableMacroLayout.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.enableMacroLayout.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    collapseMacroBar: { \n      tag: \"collapse-macro-bar\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.collapseMacroBar.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.collapseMacroBar.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    /* DARK MODE */\n    enforceDarkMode: { \n      tag: \"enforce-dark-mode\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enforceDarkMode.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enforceDarkMode.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.world, \n      config: true \n    },  \n\n    autoHidePlayerList: { \n      tag: \"auto-hide-player-list\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.autoHidePlayersList.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.autoHidePlayersList.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    debugMode: { \n      tag: \"debug-mode\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.debugMode.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.debugMode.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: false,\n      scope: SETTING_SCOPE.client,\n      config: true\n    },\n\n    /* NON-CONFIG SETTINGS */\n    /* FONTS */\n    uiFontBody: {\n      tag: \"ui-font-body\",\n      oldName: \"uiFont\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiBody.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiBody.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: `\"Work Sans\", Arial, sans-serif`,\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n    uiFontTitles: {\n      tag: \"ui-font-titles\",\n      oldName: \"uiTitles\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiTitles.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiTitles.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: `\"Roboto Slab\", Arial, sans-serif`,\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n    journalFontBody: {\n      tag: \"journal-font-body\",\n      oldName: \"journalBody\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalBody.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalBody.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: `\"Work Sans\", Arial, sans-serif`,\n      scope: SETTING_SCOPE.world,\n      config: false\n    }, \n    journalFontTitles: {\n      tag: \"journal-font-titles\",\n      oldName: \"journalTitles\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalTitles.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalTitles.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: `\"Roboto Slab\", Arial, sans-serif`,\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    /* THEME AND STYLES */\n    colorTheme:{\n      tag: \"color-theme\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.colorTheme.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.colorTheme.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: \"\",\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    adjustOtherModules: {\n      tag: \"adjust-other-modules\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.adjustOtherModules.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.adjustOtherModules.hint\"),\n      inputType: SETTING_INPUT.checkbox,\n      propType: Boolean,\n      default: false,\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    customStyles:{\n      tag: \"custom-styles\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.customStyles.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.fields.customStyles.hint\"),\n      inputType: SETTING_INPUT.text,\n      propType: String,\n      default: \"\",\n      scope: SETTING_SCOPE.world,\n      config: false\n    },\n\n    /* CHAT STYLES */\n    chatBorderColor: {\n      tag: \"chat-border-color\",\n      oldName: \"borderColor\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.hint\"),\n      options: {\n        playerColor: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.playerColor\"), \n        rollType: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.rollType\"), \n        none: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.none\")\n      }, \n      propType: String, \n      inputType: SETTING_INPUT.text, \n      default: BORDER_COLOR_TYPES.playerColor.name, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n    enableChatStyles:{\n      tag: \"enable-chat-styles\", \n      oldName: \"enableChatStyles\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enableChatStyles.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enableChatStyles.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: false,\n      requiresReload: true \n    },\n\n    /* CONTROLS SETTINGS */\n    controlsBottomBuffer:{\n      tag: \"control-bottom-buffer\",\n      oldName: \"bottomBuffer\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.bottomBuffer.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.bottomBuffer.hint\"),\n      propType: Number,\n      inputType: SETTING_INPUT.number,\n      default: 200,\n      scope: SETTING_SCOPE.client,\n      config: false\n    }, \n    controlsIconSize: {\n      tag: \"control-icon-size\",\n      oldName: \"iconSize\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.hint\"),\n      inputType: SETTING_INPUT.select, \n      options: {\n        small: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.options.small\"), \n        regular: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.options.regular\")\n      },\n      propType: String,\n      default: ICON_SIZES.small.name,\n      scope: SETTING_SCOPE.client,\n      config: false\n    },\n    controlsAutoHide: {\n      tag: \"auto-hide-secondary-controls\",\n      oldName: \"autoHideSecondary\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.autoHideSecondary.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.autoHideSecondary.hint\"), \n      inputType: SETTING_INPUT.checkbox,\n      propType: Boolean,\n      default: false,\n      scope: SETTING_SCOPE.client,\n      config: false\n    },\n    hideFoundryLogo: {\n      tag: \"hide-foundry-logo\",\n      oldName: \"hideFoundryLogo\",\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.hideFoundryLogo.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.hideFoundryLogo.hint\"), \n      inputType: SETTING_INPUT.checkbox,\n      propType: Boolean,\n      default: true,\n      scope: SETTING_SCOPE.client,\n      config: false\n    }\n\n  }\n\n}","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Camera Dock Settings application for managing camera-related configurations.\n * Provides a form interface for users to customize camera dock behavior and appearance.\n * @extends {HandlebarsApplicationMixin(ApplicationV2)}\n */\nexport class CameraDockSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  /**\n   * Default application options\n   * @static\n   * @returns {object} Configuration object containing default settings for the application\n   */\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    \n    return {\n      id: SETTINGS.cameraDockMenu.tag,\n      actions: {\n        redefine: CameraDockSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: CameraDockSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-camera\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  /**\n   * Template parts used for rendering the application\n   * @static\n   */\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/camera-dock-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  /**\n   * Get the localized title for the settings dialog\n   * @returns {string} Localized title string\n   */\n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  /**\n   * Handles form submission and updates FoundryVTT settings\n   * @private\n   * @static\n   * @param {Event} event - The form submission event\n   * @param {HTMLFormElement} form - The form element\n   * @param {FormData} formData - The form data object\n   * @returns {Promise<void>}\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    let controlSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    let isFloating = controlSettings.enableFloatingDock;\n    event.preventDefault();\n    event.stopPropagation();\n\n    // Convert FormData into an object with proper keys and handle checkboxes\n    const rawData = formData.object;\n    // Ensure checkbox fields are properly represented as booleans\n    if (!rawData.hasOwnProperty('enableFloatingDock')) {\n      rawData.enableFloatingDock = false;\n    }\n    const settings = foundry.utils.expandObject(rawData);\n\n    await SettingsUtil.set(SETTINGS.cameraDockMenu.tag, settings);\n    controlSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    LogUtil.log(\"Saving settings:\", [SETTINGS.cameraDockMenu.tag, form, formData.object, settings, controlSettings]); // Debugging\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n\n    if(controlSettings.enableFloatingDock != isFloating){\n      location.reload();\n    }\n  }\n\n  /**\n   * Resets form fields to their default values\n   * @private\n   * @static\n   * @param {Event} a - The reset event\n   * @param {HTMLElement} b - The form element\n   * @returns {Promise<void>}\n   */\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.cameraDockMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.cameraDockMenu.default]);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  /**\n   * Prepares the context data for the template\n   * @protected\n   * @param {object} options - Application options\n   * @returns {object} The prepared context object\n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const setting = {\n      ...SettingsUtil.get(SETTINGS.cameraDockMenu.tag),\n      default: {\n        ...SETTINGS.cameraDockMenu.default\n      },\n      fields: { ...SETTINGS.cameraDockMenu.fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.cameraDockMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.cameraDockMenu.save\" }\n      ]\n    }\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    LogUtil.log(\"_onRender\", [context, options]);\n  }\n\n\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Chat Messages Settings application for managing chat-related configurations.\n * Provides a form interface for customizing chat message appearance and behavior.\n * @extends {HandlebarsApplicationMixin(ApplicationV2)}\n */\nexport class ChatMessagesSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  /**\n   * Default application options\n   * @static\n   * @returns {object} Configuration object containing default settings for the application\n   */\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n\n    return {\n      id: SETTINGS.chatMessagesMenu.tag,\n      actions: {\n        redefine: ChatMessagesSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: ChatMessagesSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  /**\n   * Template parts used for rendering the application\n   * @static\n   */\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/chat-messages-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  /**\n   * Get the localized title for the settings dialog\n   * @returns {string} Localized title string\n   */\n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  /**\n   * Handles form submission and updates chat message settings\n   * @private\n   * @static\n   * @param {Event} event - The form submission event\n   * @param {HTMLFormElement} form - The form element\n   * @param {FormData} formData - The form data object\n   * @returns {Promise<void>}\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n    const fieldNames = SETTINGS.chatMessagesMenu.fields;\n\n    // Convert FormData into an object with proper keys and handle checkboxes\n    const rawData = formData.object;\n    // Ensure checkbox fields are properly represented as booleans\n    fieldNames.forEach((fieldName) => {\n      if (SETTINGS[fieldName].inputType === 'checkbox' && !rawData.hasOwnProperty(fieldName)) {\n        rawData[fieldName] = false;\n      }\n    });\n    const settings = foundry.utils.expandObject(rawData);\n    const currBorderSettings = SettingsUtil.get(SETTINGS.chatBorderColor.tag);\n    LogUtil.log(\"Compared settings:\", [ settings.chatBorderColor, currBorderSettings ]);\n    \n    fieldNames.forEach((fieldName) => {\n      LogUtil.log(\"Saving setting >>\", [SETTINGS[fieldName].tag, settings[fieldName]]);\n      if(settings[fieldName] !== undefined) {\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n    \n    // if(settings.enforceDarkMode === undefined){\n    //   delete settings.enforceDarkMode;\n    // }\n\n    await SettingsUtil.set(SETTINGS.chatMessagesMenu.tag, settings);\n    // await SettingsUtil.set(SETTINGS.enforceDarkMode.tag, settings.enforceDarkMode);\n\n    const borderSettings = settings.chatBorderColor;\n    if(borderSettings !== currBorderSettings){\n      location.reload();\n    }\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  /**\n   * Resets form fields to their default values\n   * @private\n   * @static\n   * @param {Event} a - The reset event\n   * @param {HTMLElement} b - The form element\n   * @returns {Promise<void>}\n   */\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const fieldNames = SETTINGS.chatMessagesMenu.fields;\n\n    const fields = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    inputs.forEach(inputField => {\n      inputField.value = fieldDefaults[inputField.name];\n    })\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  /**\n   * Prepares the context data for the template\n   * @protected\n   * @param {object} options - Application options\n   * @returns {object} The prepared context object containing field values, defaults, and UI configuration\n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n    const fieldNames = SETTINGS.chatMessagesMenu.fields;\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      LogUtil.log(\"_prepareContext\", [SETTINGS[fieldName].oldName]);\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : menuValues[SETTINGS[fieldName].oldName] || SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    LogUtil.log(\"_prepareContext\", [fieldValues, fieldDefaults]);\n\n    const setting = {\n      ...fieldValues,\n      // enforceDarkMode: SettingsUtil.get(SETTINGS.enforceDarkMode.tag),\n      default: { ...fieldDefaults },\n      isGM: game.user.isGM,\n      fields: { ...fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.chatMessagesMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.chatMessagesMenu.save\" }\n      ]\n    }\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  /**\n   * Handles post-render operations\n   * @protected\n   * @param {object} context - The render context\n   * @param {object} options - The render options\n   */\n  _onRender(context, options) {\n    const SETTINGS = getSettings();\n    // const html = this.element;\n    // html.querySelector(\"button[type=reset]\").addEventListener(\"click\", ChatMessagesSettings.#onReset);\n\n    const controlSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n    LogUtil.log(\"_onRender\", [context, options, controlSettings]);\n  }\n\n\n}\n","import { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\n/**\n * Utility class providing general-purpose functionality for the module\n */\n/**\n * General utility functions\n */\nexport class GeneralUtil {\n  /**\n   * Checks if module is currently installed and active\n   * @param {string} moduleName \n   * @returns {boolean}\n   */\n  static isModuleOn(moduleName){\n    const module = game.modules?.get(moduleName);\n    // LogUtil.log(\"isModuleOn\", [module?.active]);\n    return Boolean(module?.active);\n  }\n\n  /**\n   * Finds and returns the first element matching the selector within the parent element\n   * @param {HTMLElement} parent - The parent element to search within\n   * @param {string} selector - CSS selector string\n   * @returns {HTMLElement|null} The first matching element or null if not found\n   */\n  static html(parent, selector) {\n    return parent.querySelector(selector);\n  }\n\n  /**\n   * Gets the full width of an element including margins and borders\n   * @param {HTMLElement} element - The element to measure\n   * @returns {number} The full width in pixels\n   */\n  static getFullWidth(element) {\n    const style = window.getComputedStyle(element);\n    if (style.width === '0px') {\n      return 0;\n    }\n    return element.offsetWidth;\n  }\n\n  /**\n   * Calculates the distance from the bottom of an element to the bottom of its offset parent\n   * @param {HTMLElement} element - The element to measure\n   * @returns {number} The offset from the bottom in pixels\n   */\n  static getOffsetBottom(element) {\n    const offsetTop = element.offsetTop;\n    const elementHeight = element.offsetHeight;\n    const offsetParent = element.offsetParent;\n    const parentHeight = offsetParent ? offsetParent.clientHeight : window.innerHeight;\n  \n    return parentHeight - (offsetTop + elementHeight);\n  }\n\n\n  // Function to get a list with all the fonts available \n  // (Foundry + CSS imported) - excludes Font Awesome\n  /**\n   * Retrieves a comprehensive list of available fonts from multiple sources\n   * Combines Foundry built-in fonts, custom fonts from settings, and CSS imported fonts\n   * Excludes Font Awesome fonts from the results\n   * @returns {Promise<string[]>} Array of font family names, sorted alphabetically\n   */\n  static getAllFonts = async () => {\n    // Get Foundry built-in fonts\n    const foundryFonts = new Set(Object.keys(CONFIG.fontDefinitions));\n    // LogUtil.log('Foundry built-in fonts:', [Array.from(foundryFonts)]);\n    \n    // Get custom fonts from settings\n    const customFontsObj = game.settings.get(\"core\", \"fonts\") || {};\n    const customFonts = Object.entries(customFontsObj).map(([fontFamily]) => fontFamily);\n    // LogUtil.log('Custom fonts from settings:', [customFonts]);\n  \n    // Get CSS imported fonts\n    const cssImportedFonts = new Set();\n    \n    for (const sheet of document.styleSheets) {\n      try {\n        // Handle stylesheet text content for @import rules\n        if (sheet.ownerNode) {\n          // Check if the stylesheet is from core Foundry or our module\n          const href = sheet.href || '';\n          const isFoundryCore = href.includes('/css/') || href.includes('/styles/');\n          const isOurModule = href.includes('/modules/crlngn-ui/');\n          \n          // Skip if not from core or our module\n          if (href && !isFoundryCore && !isOurModule) {\n            LogUtil.log('Skipping non-core/module stylesheet:', [href]);\n            continue;\n          }\n          \n          let cssText = '';\n          \n          if (sheet.ownerNode instanceof Element) {\n            // Get text content from style tags\n            if (sheet.ownerNode.tagName === 'STYLE') {\n              cssText = sheet.ownerNode.textContent;\n            }\n            // Get text content from link tags\n            else if (sheet.ownerNode.tagName === 'LINK') {\n              try {\n                const rules = sheet.cssRules || sheet.rules;\n                cssText = Array.from(rules).map(rule => rule.cssText).join('\\n');\n              } catch (e) {\n                LogUtil.warn('Could not read stylesheet rules:', [e]);\n              }\n            }\n          }\n          \n          LogUtil.log('Processing stylesheet:', [href || 'inline style']);\n\n          // Log the found CSS text for debugging\n          // LogUtil.log('Processing stylesheet text:', s[cssText.slice(0, 200) + '...']);\n\n          \n          // Extract URLs from @import statements\n          const importUrlRegex = /@import\\s+url\\(['\"]([^'\"]+)['\"]\\)/g;\n          let match;\n          \n          while ((match = importUrlRegex.exec(cssText)) !== null) {\n            let url = match[1]; // This is the actual URL\n\n            if (url.includes('fonts.googleapis.com')) {\n              // Extract font family names from Google Fonts URL\n              const familyMatch = url.match(/family=([^&]+)/);\n              if (familyMatch) {\n                const families = decodeURIComponent(familyMatch[1])\n                  .split('|') // Split multiple families\n                  .map(family => {\n                    // Remove weight/style variations\n                    return family.split(':')[0].replace(/\\+/g, ' ');\n                  });\n                \n                families.forEach(family => {\n                  cssImportedFonts.add(family);\n                  // LogUtil.log('Added Google Font family:', [family]);\n                });\n              }\n            } else {\n              // Skip relative path imports\n              if (url.startsWith('./') || url.startsWith('../')) {\n                LogUtil.log('Skipping relative import:', [url]);\n                continue;\n              }\n              \n              // For absolute paths or URLs, use as is\n              let resolvedUrl = url;\n\n              try {\n                const response = await fetch(resolvedUrl);\n                if (!response.ok) {\n                  LogUtil.warn('Error loading imported CSS:', [response.status]);\n                  continue;\n                }\n                const css = await response.text();\n                /** @type {RegExpMatchArray | null} */\n                const fontFaceRules = css.match(/@font-face\\s*{[^}]+}/g);\n                if (!fontFaceRules) continue;\n                \n                fontFaceRules.forEach(rule => {\n                  /** @type {RegExpMatchArray | null} */\n                  const fontFamilyMatch = rule.match(/font-family:\\s*['\"]?([^'\";]+)['\"]?/);\n                  if (fontFamilyMatch && fontFamilyMatch[1]) {\n                    const fontFamily = fontFamilyMatch[1].trim();\n                    cssImportedFonts.add(fontFamily);\n                  }\n                });\n              } catch (e) {\n                LogUtil.warn('Error processing imported CSS:', [e]);\n              }\n            }\n          }\n        }\n\n        // Check for @font-face rules in the current stylesheet\n        if (!sheet.href || sheet.href.startsWith(window.location.origin)) {\n          try {\n            const rules = sheet.cssRules || sheet.rules;\n            for (const rule of rules) {\n              if (rule instanceof CSSFontFaceRule) {\n                const fontFamily = rule.style.getPropertyValue('font-family')\n                  .replace(/['\"`]/g, '')\n                  .trim();\n                cssImportedFonts.add(fontFamily);\n                // LogUtil.log('Found font-face rule for:', [fontFamily]);\n              }\n            }\n          } catch (e) {\n            LogUtil.warn('Could not read stylesheet rules:', [e]);\n          }\n        }\n      } catch (e) {\n        LogUtil.warn('Error processing stylesheet:', [e]);\n      }\n    }\n    return [];\n  }\n\n  /**\n   * Gets the offset bottom of an element\n   * @param {HTMLElement} element \n   * @returns {number}\n   */\n  static getOffsetBottom(element) {\n    const offsetTop = element.offsetTop;\n    const elementHeight = element.offsetHeight;\n    const offsetParent = element.offsetParent;\n    const parentHeight = offsetParent ? offsetParent.clientHeight : window.innerHeight;\n  \n    return parentHeight - (offsetTop + elementHeight);\n  }\n\n\n  // Function to get a list with all the fonts available \n  // (Foundry + CSS imported) - excludes Font Awesome\n  /**\n   * Retrieves a list of all available fonts\n   * @returns {Promise<string[]>}\n   */\n  static async getAllFonts() {\n    // Get Foundry built-in fonts\n    const foundryFonts = new Set(Object.keys(CONFIG.fontDefinitions));\n    \n    // Get custom fonts from settings\n    const customFontsObj = SettingsUtil.get(\"fonts\",\"core\") || {};\n    const customFonts = Object.entries(customFontsObj).map(([fontFamily]) => fontFamily);\n  \n    // Get CSS imported fonts\n    const cssImportedFonts = new Set();\n\n    await this.processStyleSheets(cssImportedFonts);\n  \n    // Log what we found for debugging\n    LogUtil.log('Found fonts:', [{\n      foundry: Array.from(foundryFonts),\n      custom: customFonts,\n      cssImported: Array.from(cssImportedFonts)\n    }]);\n  \n    // Combine all fonts, filter, clean, sort\n    const allFonts = Array.from(new Set([\n      ...foundryFonts,\n      ...customFonts,\n      ...cssImportedFonts\n    ]))\n    .filter(f => !/FontAwesome|Font Awesome|FoundryVTT/.test(f))\n    .map(f => f.replace(/['\"`]/g, '').trim())\n    .sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));\n\n    // Move return statement to the end of the function\n    return allFonts || [];\n  }\n\n  // Helper function to format font names\n  /**\n   * Formats a font name by cleaning it and wrapping it in quotes if it contains spaces\n   * @param {string} fontName - The font name to format\n   * @returns {string} The formatted font name\n   */\n  static wrapFontName = (fontName) => {\n    const cleanName = fontName.replace(/['\"`]/g, '');\n    return cleanName.includes(' ') ? `\"${cleanName}\"` : cleanName;\n  }\n\n  /**\n   * Adds CSS variables to a style element\n   * @param {string} varName \n   * @param {string} varValue \n   */\n  static addCSSVars(varName, varValue) {\n    let bodyStyle = document.querySelector('#crlngn-ui-vars');\n    \n    if (!bodyStyle) {\n      // Create style element if it doesn't exist\n      const body = document.querySelector('body');\n      bodyStyle = document.createElement('style');\n      bodyStyle.id = 'crlngn-ui-vars';\n      bodyStyle.textContent = 'body.crlngn-ui {\\n}\\n';\n      body.prepend(bodyStyle);\n    }\n    \n    // Parse the current CSS content\n    let cssText = bodyStyle.textContent;\n    \n    // Find or create the rule block\n    let ruleStart = cssText.indexOf('body.crlngn-ui {');\n    let ruleEnd = cssText.indexOf('}', ruleStart);\n    \n    if (ruleStart === -1) {\n      // If rule doesn't exist, create it\n      cssText = 'body.crlngn-ui {\\n}\\n';\n      ruleStart = 0;\n      ruleEnd = cssText.indexOf('}');\n    }\n    \n    // Get all the current declarations\n    const rulePart = cssText.substring(ruleStart + 'body.crlngn-ui {'.length, ruleEnd);\n    \n    // Split by semicolons to get individual declarations\n    const declarations = rulePart.split(';')\n      .map(decl => decl.trim())\n      .filter(decl => decl !== '');\n    \n    // Create a map of existing variables\n    const varsMap = {};\n    declarations.forEach(decl => {\n      const parts = decl.split(':');\n      if (parts.length >= 2) {\n        const name = parts[0].trim();\n        const value = parts.slice(1).join(':').trim(); // Handle values that might contain colons\n        if (name) varsMap[name] = value;\n      }\n    });\n    \n    // Format the value if it appears to need quotes\n    // For string values used in content properties (i18n text)\n    if (varName.includes('i18n') && \n        typeof varValue === 'string' && \n        !varValue.startsWith('\"') && \n        !varValue.startsWith(\"'\") && \n        !varValue.match(/^url\\(|^rgba?\\(|^hsla?\\(/)) {\n      varValue = `\"${varValue}\"`;\n    }\n    \n    // Update or add the new variable\n    varsMap[varName] = varValue;\n    \n    // Rebuild the rule content\n    const newRuleContent = Object.entries(varsMap)\n      .map(([name, value]) => `  ${name}: ${value};`)\n      .join('\\n');\n    \n    // Rebuild the entire CSS\n    const newCss = \n      cssText.substring(0, ruleStart) + \n      'body.crlngn-ui {\\n' + \n      newRuleContent + \n      '\\n}' + \n      cssText.substring(ruleEnd + 1);\n    \n    // Update the style element\n    bodyStyle.textContent = newCss;\n  }\n\n  /**\n   * Adds custom CSS to a style element\n   * @param {string} content \n   */\n  static addCustomCSS(content) {\n    let customStyle = document.querySelector('#crlngn-ui-custom-css');\n    \n    if (!customStyle) {\n      // Create style element if it doesn't exist\n      const body = document.querySelector('body');\n      customStyle = document.createElement('style');\n      customStyle.id = 'crlngn-ui-custom-css';\n      customStyle.textContent = 'body.crlngn-ui {\\n}\\n';\n      body.appendChild(customStyle);\n    }\n\n    customStyle.textContent = content;\n  }\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { GeneralUtil } from \"../GeneralUtil.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Custom Fonts Settings application for managing font configurations.\n * Provides a form interface with dropdown font selection and keyboard navigation.\n * @extends {HandlebarsApplicationMixin(ApplicationV2)}\n */\nexport class CustomFontsSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  /** @type {HTMLElement} Private static reference to the form element */\n  static #element;\n  /**\n   * Default application options\n   * @static\n   * @returns {object} Configuration object containing default settings for the application\n   */\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n\n    return {\n      id: SETTINGS.customFontsMenu.tag,\n      actions: {\n        redefine: CustomFontsSettings.#onReset,\n      },\n      form: {\n        handler: CustomFontsSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-text\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n        // Add datalists to your content classes\n        contentClasses: [\"standard-form\", \"datalists\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  /**\n   * Template parts used for rendering the application\n   * @static\n   */\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/custom-fonts-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  /**\n   * Get the localized title for the settings dialog\n   * @returns {string} Localized title string\n   */\n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\");\n  }\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  /**\n   * Handles form submission and updates font settings\n   * @private\n   * @static\n   * @param {Event} event - The form submission event\n   * @param {HTMLFormElement} form - The form element\n   * @param {FormData} formData - The form data object\n   * @returns {Promise<void>}\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n    const fieldNames = SETTINGS.customFontsMenu.fields;\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    fieldNames.forEach((fieldName) => {\n      if(settings[fieldName] !== undefined) {\n        LogUtil.log(\"Saving setting:\", [settings[fieldName]]);\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n\n    // For compatibility - to be removed in future version\n    SettingsUtil.set(SETTINGS.customFontsMenu.tag, settings);\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns {Promise<Object>}\n   */\n  async _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.customFontsMenu.tag);\n    const fieldNames = SETTINGS.customFontsMenu.fields;\n\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : menuValues[SETTINGS[fieldName].oldName] || SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const setting = {\n      ...fieldValues,\n      default: {...fieldDefaults},\n      fontList: await GeneralUtil.getAllFonts(),\n      fields: { \n        ...fields\n      },\n      buttons: [\n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.customFontsMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.customFontsMenu.save\" }\n      ]\n    };\n\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    // LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  /**\n   * Handles post-render operations including dropdown setup and event listeners\n   * @protected\n   * @param {object} context - The render context\n   * @param {object} options - The render options\n   */\n  _onRender(context, options) {\n    CustomFontsSettings.#element = this.element;\n    \n    // Handle input focus and blur\n    const inputs = CustomFontsSettings.#element.querySelectorAll('input[type=\"text\"]');\n    inputs.forEach(input => {\n      const wrapper = input.closest('.dropdown-wrapper');\n      const dropdown = wrapper?.querySelector('.dropdown-options');\n      \n      if (!wrapper || !dropdown) return;\n  \n      // Show dropdown on input focus\n      const onFocus = () => {\n        CustomFontsSettings.#closeAllDropdowns();\n        dropdown.classList.add('active');\n      };\n      input.addEventListener('focus', onFocus);\n      input.addEventListener('click', onFocus);\n\n      // Add keyboard navigation\n      input.addEventListener('keydown', (e) => {\n        const isActive = dropdown.classList.contains('active');\n        const options = Array.from(dropdown.querySelectorAll('.dropdown-option'));\n        let currentIndex = options.findIndex(opt => opt.classList.contains('highlighted'));\n        \n        // Handle arrow down/up\n        if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n          e.preventDefault(); // Prevent cursor movement in input\n          \n          if (!isActive) {\n            dropdown.classList.add('active');\n          }\n          \n          // Remove current highlight\n          options.forEach(opt => opt.classList.remove('highlighted'));\n          \n          // Calculate new index\n          if (currentIndex === -1) {\n            currentIndex = e.key === 'ArrowDown' ? 0 : options.length - 1;\n          } else {\n            currentIndex = e.key === 'ArrowDown' \n              ? (currentIndex + 1) % options.length \n              : (currentIndex - 1 + options.length) % options.length;\n          }\n          \n          // Add highlight to new option and scroll into view\n          if (options[currentIndex]) {\n            options[currentIndex].classList.add('highlighted');\n            options[currentIndex].scrollIntoView({ block: 'nearest' });\n          }\n        }\n        \n        // Handle Enter key\n        else if (e.key === 'Enter') {\n          e.preventDefault();\n          \n          if (isActive && currentIndex !== -1 && options[currentIndex]) {\n            // Simulate click on the highlighted option\n            options[currentIndex].click();\n          }\n        }\n        \n        // Handle Escape key\n        else if (e.key === 'Escape') {\n          dropdown.classList.remove('active');\n        }\n      });\n\n      // Handle clicking outside\n      document.addEventListener('click', (e) => {\n        if (!wrapper.contains(e.target)) {\n          dropdown.classList.remove('active');\n        }\n      });\n    });\n  \n    // Handle option selection\n    const dropOptions = CustomFontsSettings.#element.querySelectorAll('.dropdown-option');\n    dropOptions.forEach(option => {\n      // Add mouse hover effect that syncs with keyboard highlighting\n      option.addEventListener('mouseenter', () => {\n        // Remove highlight from all options\n        const allOptions = option.closest('.dropdown-options').querySelectorAll('.dropdown-option');\n        allOptions.forEach(opt => opt.classList.remove('highlighted'));\n        \n        // Add highlight to current option\n        option.classList.add('highlighted');\n      });\n      \n      option.addEventListener('click', (e) => {\n        const input = option.closest('.dropdown-wrapper').querySelector('input');\n        // Get the value and handle potential quote escaping\n        let value = option.dataset.value;\n        \n        // If the value contains spaces but doesn't have quotes, add them\n        if (value.includes(' ') && !value.startsWith('\"')) {\n          value = `\"${value}\"`;\n        }\n        // If the value is already properly quoted, use it as is\n        else if (value.startsWith('&quot;')) {\n          value = value.replace(/&quot;/g, '\"');\n        }\n        \n        input.value = value;\n        const dropdown = option.closest('.dropdown-options');\n        dropdown.classList.remove('active');\n        \n        // Return focus to input after selection\n        // input.focus();\n      });\n    });\n  }\n  \n  /**\n   * Closes all open font dropdown menus\n   * @private\n   * @static\n   */\n  static #closeAllDropdowns() {\n    CustomFontsSettings.#element.querySelectorAll('.dropdown-options').forEach(dropdown => {\n      dropdown.classList.remove('active');\n    });\n  }\n  \n\n  /**\n   * Resets form fields to their default values\n   * @private\n   * @static\n   * @param {Event} a - The reset event\n   * @param {HTMLElement} b - The form element\n   * @returns {Promise<void>}\n   */\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input[type=text]\");\n    // const menuValues = SettingsUtil.get(SETTINGS.customFontsMenu.tag);\n    const fieldNames = SETTINGS.customFontsMenu.fields;\n\n    const fields = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    inputs.forEach(inputField => {\n      inputField.value = fieldDefaults[inputField.name];\n    })\n  }\n\n  \n\n}","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Left Controls Settings application for managing left sidebar control configurations.\n * Provides a form interface for customizing the behavior and appearance of left-side controls.\n * @extends {HandlebarsApplicationMixin(ApplicationV2)}\n */\nexport class LeftControlsSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  /**\n   * Default application options\n   * @static\n   * @returns {object} Configuration object containing default settings for the application\n   */\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    return {\n      id: SETTINGS.leftControlsMenu.tag,\n      actions: {\n        redefine: LeftControlsSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: LeftControlsSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  /**\n   * Template parts used for rendering the application\n   * @static\n   */\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/left-controls-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  /**\n   * Get the localized title for the settings dialog\n   * @returns {string} Localized title string\n   */\n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\");\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  /**\n   * Handles form submission and updates left controls settings\n   * @private\n   * @static\n   * @param {Event} event - The form submission event\n   * @param {HTMLFormElement} form - The form element\n   * @param {FormData} formData - The form data object\n   * @returns {Promise<void>}\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n    const fieldNames = SETTINGS.leftControlsMenu.fields;\n    \n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    fieldNames.forEach((fieldName) => {\n      if(settings[fieldName] !== undefined) {\n        LogUtil.log(\"Saving setting:\", [settings[fieldName]]);\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n\n    // For compatibility - to be removed in future version\n    await SettingsUtil.set(SETTINGS.leftControlsMenu.tag, settings);\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  /**\n   * Resets form fields to their default values\n   * @private\n   * @static\n   * @param {Event} a - The reset event\n   * @param {HTMLElement} b - The form element\n   * @returns {Promise<void>}\n   */\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.leftControlsMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.leftControlsMenu.default]);\n    // await SettingsUtil.set(SETTINGS.leftControlsMenu.tag, SETTINGS.leftControlsMenu.default);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  /**\n   * Prepares the context data for the template\n   * @protected\n   * @param {object} options - Application options\n   * @returns {object} The prepared context object containing field values, defaults, and UI configuration\n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n    const fieldNames = SETTINGS.leftControlsMenu.fields;\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : menuValues[SETTINGS[fieldName].oldName] || SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const setting = {\n      ...fieldValues,\n      default: {...fieldDefaults},\n      fields: { \n        ...fields\n      },\n      buttons: [\n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.leftControlsMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.leftControlsMenu.save\" }\n      ]\n    }\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  /**\n   * Handles post-render operations\n   * @protected\n   * @param {object} context - The render context\n   * @param {object} options - The render options\n   */\n  _onRender(context, options) {\n    const SETTINGS = getSettings();\n    // const html = this.element;\n    // html.querySelector(\"button[type=reset]\").addEventListener(\"click\", LeftControlsSettings.#onReset);\n\n    const controlSettings = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n\n    LogUtil.log(\"_onRender\", [context, options, controlSettings]);\n  }\n\n\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Scene Navigation Settings application for managing scene navigation configurations.\n * Provides a form interface for customizing the behavior and appearance of the scene navigation bar.\n * @extends {HandlebarsApplicationMixin(ApplicationV2)}\n */\nexport class SceneNavSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  /**\n   * Default application options\n   * @static\n   * @returns {object} Configuration object containing default settings for the application\n   */\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    return {\n      id: SETTINGS.sceneNavMenu.tag,\n      actions: {\n        redefine: SceneNavSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: SceneNavSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  /**\n   * Template parts used for rendering the application\n   * @static\n   */\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/scene-nav-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  /**\n   * Get the localized title for the settings dialog\n   * @returns {string} Localized title string\n   */\n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  /**\n   * Handles form submission and updates scene navigation settings\n   * @private\n   * @static\n   * @param {Event} event - The form submission event\n   * @param {HTMLFormElement} form - The form element\n   * @param {FormData} formData - The form data object\n   * @returns {Promise<void>}\n   */\n  static async #onSubmit(event, form, formData) {\n    event.preventDefault();\n    event.stopPropagation();\n    const SETTINGS = getSettings(); \n    const fieldNames = SETTINGS.sceneNavMenu.fields;\n    let navEnabledBefore = SettingsUtil.get(SETTINGS.sceneNavEnabled.tag);\n    let foldersEnabledBefore = SettingsUtil.get(SETTINGS.navFoldersEnabled.tag);\n    \n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    fieldNames.forEach((fieldName) => {\n      if(settings[fieldName] !== undefined) {\n        LogUtil.log(\"Saving setting:\", [settings[fieldName]]);\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n    let navEnabledAfter = SettingsUtil.get(SETTINGS.sceneNavEnabled.tag); \n    let foldersEnabledAfter = SettingsUtil.get(SETTINGS.navFoldersEnabled.tag);\n\n    LogUtil.log(\"Saving settings...\", [form, formData.object, settings]); // Debugging\n    await SettingsUtil.set(SETTINGS.sceneNavMenu.tag, settings);\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n\n    if( navEnabledBefore !== navEnabledAfter ||\n      foldersEnabledBefore !== foldersEnabledAfter ){\n      location.reload();\n    }\n  }\n\n  /**\n   * Resets form fields to their default values\n   * @private\n   * @static\n   * @param {Event} a - The reset event\n   * @param {HTMLElement} b - The form element\n   * @returns {Promise<void>}\n   */\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.sceneNavMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.sceneNavMenu.default]);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  /**\n   * Prepares the context data for the template\n   * @protected\n   * @param {object} options - Application options\n   * @returns {object} The prepared context object containing field values, defaults, and UI configuration\n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n    const fieldNames = SETTINGS.sceneNavMenu.fields;\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : menuValues[SETTINGS[fieldName].oldName] || SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const setting = {\n      ...fieldValues,\n      default: {...fieldDefaults},\n      fields: { \n        ...fields\n      },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.sceneNavMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.sceneNavMenu.save\" }\n      ]\n    }\n    // game.settings.get(\"foo\", \"config\");\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  /**\n   * Handles post-render operations\n   * @protected\n   * @param {object} context - The render context\n   * @param {object} options - The render options\n   */\n  _onRender(context, options) {\n    LogUtil.log(\"_onRender\", [context, options]);\n  }\n\n\n}\n","import { getSettings, THEMES } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Theme and Styles Settings application for managing UI theme and style configurations.\n * Provides a form interface with dropdown theme selection and live preview capabilities.\n * @extends {HandlebarsApplicationMixin(ApplicationV2)}\n */\nexport class ThemeAndStyleSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  /** @type {HTMLElement} Private static reference to the form element */\n  static #element;\n\n  /**\n   * Default application options\n   * @static\n   * @returns {object} Configuration object containing default settings for the application\n   */\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n\n    return {\n      id: SETTINGS.themeAndStylesMenu.tag,\n      actions: {\n        redefine: ThemeAndStyleSettings.#onReset,\n      },\n      form: {\n        handler: ThemeAndStyleSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-brush\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\"),\n        // Add datalists to your content classes\n        contentClasses: [\"standard-form\", \"datalists\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  /**\n   * Template parts used for rendering the application\n   * @static\n   */\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/theme-and-styles-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  /**\n   * Get the localized title for the settings dialog\n   * @returns {string} Localized title string\n   */\n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\");\n  }\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  /**\n   * Handles form submission and updates theme settings\n   * @private\n   * @static\n   * @param {Event} event - The form submission event\n   * @param {HTMLFormElement} form - The form element\n   * @param {FormData} formData - The form data object\n   * @returns {Promise<void>}\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n    const fieldNames = SETTINGS.themeAndStylesMenu.fields;\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n    const selectedTheme = THEMES.find(theme => theme.label===settings.colorTheme);\n    settings.colorTheme = selectedTheme ? selectedTheme.className : '';\n\n    fieldNames.forEach((fieldName) => {\n      if(settings[fieldName] !== undefined) {\n        LogUtil.log(\"Saving setting:\", [settings[fieldName]]);\n        SettingsUtil.set(SETTINGS[fieldName].tag, settings[fieldName]);\n      }\n    });\n\n    // For compatibility - to be removed in future version\n    SettingsUtil.set(SETTINGS.themeAndStylesMenu.tag, settings);\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  /**\n   * Prepares the context data for the template\n   * @protected\n   * @param {object} options - Application options\n   * @returns {object} The prepared context object containing field values, defaults, theme list, and UI configuration\n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const menuValues = SettingsUtil.get(SETTINGS.themeAndStylesMenu.tag);\n    const fieldNames = SETTINGS.themeAndStylesMenu.fields;\n    const fields = {};\n    const fieldValues = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        const value = SettingsUtil.get(SETTINGS[fieldName].tag);\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldValues[fieldName] = value!== undefined ? value : SETTINGS[fieldName].default;\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const selectedTheme = THEMES.find(theme => {\n      return theme.className===fieldValues.colorTheme\n    });\n    fieldValues.colorTheme = selectedTheme?.label || THEMES[0].label;\n\n    const setting = {\n      ...fieldValues,\n      default: {...fieldDefaults},\n      fields: { \n        ...fields\n      },\n      selectedTheme: selectedTheme,\n      themes: THEMES,\n      buttons: [\n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.themeAndStylesMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.themeAndStylesMenu.save\" }\n      ]\n    }\n\n    // Store the initial context for later updates\n    this._initialContext = { ...fieldValues };\n\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    // LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  /**\n   * Handles post-render operations including dropdown setup, keyboard navigation, and theme preview\n   * @protected\n   * @param {object} context - The render context\n   * @param {object} options - The render options\n   */\n  _onRender(context, options) {\n    ThemeAndStyleSettings.#element = this.element;\n    \n    // Store reference to themes for later use\n    this._themes = THEMES;\n    \n    // Handle input focus and blur\n    const inputs = ThemeAndStyleSettings.#element.querySelectorAll('input[type=\"text\"]');\n    inputs.forEach(input => {\n      const wrapper = input.closest('.dropdown-wrapper');\n      const dropdown = wrapper?.querySelector('.dropdown-options');\n      \n      if (!wrapper || !dropdown) return;\n  \n      // Show dropdown on input focus\n      const onFocus = () => {\n        ThemeAndStyleSettings.#closeAllDropdowns();\n        dropdown.classList.add('active');\n      };\n      input.addEventListener('focus', onFocus);\n      input.addEventListener('click', onFocus);\n\n      // Add keyboard navigation\n      input.addEventListener('keydown', (e) => {\n        const isActive = dropdown.classList.contains('active');\n        const options = Array.from(dropdown.querySelectorAll('.dropdown-option'));\n        let currentIndex = options.findIndex(opt => opt.classList.contains('highlighted'));\n        \n        if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n          e.preventDefault();\n          \n          if (!isActive) {\n            dropdown.classList.add('active');\n          }\n          \n          // Remove current highlight\n          options.forEach(opt => opt.classList.remove('highlighted'));\n          \n          // Calculate new index\n          if (currentIndex === -1) {\n            currentIndex = e.key === 'ArrowDown' ? 0 : options.length - 1;\n          } else {\n            currentIndex = e.key === 'ArrowDown' \n              ? (currentIndex + 1) % options.length \n              : (currentIndex - 1 + options.length) % options.length;\n          }\n          \n          // Add highlight to new option and scroll into view\n          if (options[currentIndex]) {\n            options[currentIndex].classList.add('highlighted');\n            options[currentIndex].scrollIntoView({ block: 'nearest' });\n          }\n        }\n        \n        // Handle Enter key\n        else if (e.key === 'Enter') {\n          e.preventDefault();\n          \n          if (isActive && currentIndex !== -1 && options[currentIndex]) {\n            // Simulate click on the highlighted option\n            options[currentIndex].click();\n          }\n        }\n        \n        // Handle Escape key\n        else if (e.key === 'Escape') {\n          dropdown.classList.remove('active');\n        }\n      });\n\n      // Handle clicking outside\n      document.addEventListener('click', (e) => {\n        if (!wrapper.contains(e.target)) {\n          dropdown.classList.remove('active');\n        }\n      });\n    });\n  \n    // Handle option selection\n    const dropOptions = ThemeAndStyleSettings.#element.querySelectorAll('.dropdown-option');\n    const that = this; // Store reference to this for use in event handlers\n    \n    dropOptions.forEach(option => {\n      // Add mouse hover effect that syncs with keyboard highlighting\n      option.addEventListener('mouseenter', () => {\n        // Remove highlight from all options\n        const allOptions = option.closest('.dropdown-options').querySelectorAll('.dropdown-option');\n        allOptions.forEach(opt => opt.classList.remove('highlighted'));\n        \n        // Add highlight to current option\n        option.classList.add('highlighted');\n      });\n      \n      option.addEventListener('click', function(e) {\n        LogUtil.log('option', [option, option.querySelector('.theme-name')]);\n        const input = option.closest('.dropdown-wrapper').querySelector('input');\n        let value = option.querySelector('.theme-name').innerHTML.toString();\n        \n        // Update the input value\n        input.value = value;\n        \n        // Update the selectedTheme if this is the theme input\n        if (input.name === 'colorTheme') {\n          const selectedTheme = that._themes.find(theme => {\n            return theme.label === value;\n          });\n          \n          // Store the selected theme for form submission\n          that._selectedTheme = selectedTheme;\n          \n          // Update any UI elements that depend on selectedTheme\n          that._updateThemePreview(selectedTheme);\n        }\n        \n        const dropdown = option.closest('.dropdown-options');\n        dropdown.classList.remove('active');\n      });\n    });\n  }\n\n  /**\n   * Update any UI elements that depend on the theme selection\n   * @param {Object} theme - The selected theme object\n   * @private\n   */\n  _updateThemePreview(theme) {\n    // Implement any preview updates here\n    LogUtil.log(\"Selected theme updated:\", [theme]);\n    \n    if (!theme) return;\n    \n    const selectedThemeSpan = this.element.querySelectorAll('span.selected-theme');\n\n    selectedThemeSpan.forEach((span,i) => {\n      span.style.setProperty('background-color', theme.colorPreview[i]);\n    });\n  }\n  \n  /**\n   * Closes all open theme dropdown menus\n   * @private\n   * @static\n   */\n  static #closeAllDropdowns() {\n    ThemeAndStyleSettings.#element.querySelectorAll('.dropdown-options').forEach(dropdown => {\n      dropdown.classList.remove('active');\n    });\n  }\n\n  /**\n   * Resets form fields to their default values and updates theme preview\n   * @private\n   * @static\n   * @param {Event} a - The reset event\n   * @param {HTMLElement} b - The form element\n   * @returns {Promise<void>}\n   */\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input[type=text]\");\n    const fieldNames = SETTINGS.themeAndStylesMenu.fields;\n\n    const fields = {};\n    const fieldDefaults = {};\n\n    fieldNames.forEach((fieldName) => {\n      if(SETTINGS[fieldName]) {\n        fields[fieldName] = SETTINGS[fieldName];\n        fieldDefaults[fieldName] = SETTINGS[fieldName].default;\n      }\n    });\n\n    const selectedTheme = THEMES.find(theme => theme.label===SETTINGS.colorTheme.default);\n    fieldDefaults.colorTheme = selectedTheme?.label || THEMES[0].label;\n\n    inputs.forEach(inputField => {\n      inputField.value = fieldDefaults[inputField.name];\n    })\n  }\n\n}","// import * as lang from '../lang/en.json';\nimport { CameraDockSettings } from '../components/settings-dialogs/CameraDockSettings.mjs';\nimport { ChatMessagesSettings } from '../components/settings-dialogs/ChatMessagesSettings.mjs';\nimport { CustomFontsSettings } from '../components/settings-dialogs/CustomFontSettings.mjs';\nimport { LeftControlsSettings } from '../components/settings-dialogs/LeftControlsSettings.mjs';\nimport { SceneNavSettings } from '../components/settings-dialogs/SceneNavSettings.mjs';\nimport { ThemeAndStyleSettings } from '../components/settings-dialogs/ThemeAndStylesSettings.mjs';\n// import * as lang from '../lang/en.json' assert { type: \"json\" };\n\nexport function getSettingMenus() {\n  return {\n    customFonts: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.hint\"),\n      icon: \"fas fa-text\",  \n      propType: CustomFontsSettings,\n      restricted: true \n    },\n    themeAndStylesMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.themeAndStylesMenu.hint\"),\n      icon: \"fas fa-brush\",\n      propType: ThemeAndStyleSettings,\n      restricted: true \n    },\n    chatMessagesMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.hint\"),\n      icon: \"fas fa-cog\",\n      propType: ChatMessagesSettings,\n      restricted: false \n    },\n    leftControls: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.hint\"),\n      icon: \"fas fa-cog\",\n      propType: LeftControlsSettings,\n      restricted: false \n    },\n    cameraDockMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.hint\"),\n      icon: \"fas fa-camera\",  \n      propType: CameraDockSettings,\n      restricted: false \n    },\n    sceneNavMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.hint\"),\n      icon: \"fas fa-cog\",  \n      propType: SceneNavSettings,\n      restricted: false \n    }\n  };\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\n/**\n * Utility class for managing the camera dock functionality in FoundryVTT\n * Handles camera positioning, dragging, resizing, and UI controls\n */\nexport class CameraUtil {\n  /** @type {number} Private offset X for dragging */\n  static #offsetX = 0;\n  /** @type {number} Private offset Y for dragging */\n  static #offsetY = 0;\n  /** @type {boolean} Flag indicating if camera is being dragged */\n  static isDragging = false;\n  /** @type {HTMLElement|null} Reference to the camera container element */\n  static cameraContainer;\n  /** @type {boolean} Flag indicating if camera is being resized */\n  static isResizing = false;\n  /** @type {number} Private starting X position for resizing */\n  static #startX = 0;\n  /** @type {number} Private starting Y position for resizing */\n  static #startY = 0;\n  /** @type {number} Private starting width for resizing */\n  static #startWidth = 0;\n  /** @type {number} Private starting height for resizing */\n  static #startHeight = 0;\n  /** @type {number} Private starting bottom position for resizing */\n  static #startBottom = 0;\n\n  /**\n   * Initializes the camera utility\n   * Sets up event hooks based on camera dock settings\n   */\n  static init(){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    if(cameraSettings.enableFloatingDock){ \n      Hooks.on(HOOKS_CORE.RENDER_CAMERA_VIEWS, CameraUtil.onRenderFloating);\n      LogUtil.log(\"CameraUtil\", [cameraSettings]);\n      CameraUtil.onRenderFloating();\n    }else{ \n      Hooks.on(HOOKS_CORE.RENDER_CAMERA_VIEWS, CameraUtil.onRenderPlain);\n      CameraUtil.onRenderPlain();\n    } \n  }\n\n  /**\n   * Renders the camera in plain mode (non-floating)\n   * Adds visibility class to camera views\n   */\n  static onRenderPlain(){\n    document.querySelector('#camera-views')?.classList.add('visible');\n  }\n\n  /**\n   * Renders the camera in floating mode\n   * Sets up draggable and resizable functionality\n   * Positions camera based on saved settings\n   */\n  static onRenderFloating(){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    document.querySelector('#camera-views')?.classList.add('crlngn-ui');\n    CameraUtil.cameraContainer = document.querySelector('#camera-views .camera-container');\n\n    const controlsElem = document.querySelector('#camera-views .user-controls');\n    const cameraGrid = document.querySelector('#camera-views .camera-grid');\n\n    LogUtil.log(\"CameraUtil.onRender\", [ cameraSettings.dockPosX, cameraSettings.dockPosY ]);\n\n    if(CameraUtil.cameraContainer && cameraGrid && controlsElem){\n      CameraUtil.cameraContainer?.insertBefore(controlsElem, cameraGrid);\n      document.querySelector('#camera-views .camera-container')?.classList.add('visible');\n    }\n    CameraUtil.makeDraggable();\n    CameraUtil.makeResizeable();\n    CameraUtil.resetPositionAndSize();\n    CameraUtil.placeControlsToggle();\n  }\n\n  /**\n   * Places the camera controls toggle button\n   * Creates and positions play/pause button if it doesn't exist\n   */\n  static placeControlsToggle(){ \n    const camControls = document.querySelector('#camera-views .user-controls');\n    const existingButtons = camControls?.querySelectorAll(\".crlngn-video-toggle\");\n    LogUtil.log(\"placeControlsToggle\", [camControls, existingButtons]);\n\n    if(existingButtons?.length > 0){\n      return; \n    }\n\n    const controlBar = document.querySelector('#camera-views .user-controls .control-bar');\n    const btnToggle = document.createElement(\"button\"); \n    btnToggle.classList.add(\"crlngn-video-toggle\"); \n    btnToggle.innerHTML = '<i class=\"fa fa-play-circle\" aria-hidden=\"true\"></i>';\n\n    camControls?.insertBefore(btnToggle, controlBar);\n  }\n\n  /**\n   * Makes the camera container draggable\n   * Sets up mouse event listeners for drag functionality\n   */\n  static makeDraggable(){\n    CameraUtil.cameraContainer?.addEventListener(\"mousedown\", (e) => {\n      const body = document.querySelector(\"body.crlngn-ui\");\n      \n      if(e.target.parentNode?.classList.contains('volume-bar')){\n        return;\n      }\n      body?.addEventListener(\"mousemove\", CameraUtil.#onDragMove);\n      body?.addEventListener(\"mouseup\", CameraUtil.#onDragRelease); \n\n      const offsetBottom = GeneralUtil.getOffsetBottom(CameraUtil.cameraContainer);\n      CameraUtil.isDragging = true;\n      CameraUtil.#offsetX = e.clientX - CameraUtil.cameraContainer?.offsetLeft;\n      CameraUtil.#offsetY = (window.innerHeight - e.clientY) - offsetBottom;\n      // CameraUtil.cameraContainer.style.zIndex = \"101\"; \n\n      e.stopPropagation();\n    }); \n\n  }\n\n  /**\n   * Makes the camera container resizable\n   * Adds resize handle and sets up mouse event listeners\n   */\n  static makeResizeable(){\n    if(CameraUtil.cameraContainer){\n      const body = document.querySelector(\"body.crlngn-ui\");\n      const resizeHandle = document.createElement(\"div\");\n      resizeHandle.classList.add(\"resize-handle\");\n      CameraUtil.cameraContainer.append(resizeHandle);\n\n      resizeHandle.addEventListener(\"mousedown\", (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        CameraUtil.isResizing = true;\n    \n        CameraUtil.#startX = e.clientX;\n        CameraUtil.#startY = e.clientY;\n        CameraUtil.#startBottom = parseInt(getComputedStyle(CameraUtil.cameraContainer).bottom) || 0;\n        CameraUtil.#startWidth = CameraUtil.cameraContainer.offsetWidth;\n        CameraUtil.#startHeight = CameraUtil.cameraContainer.offsetHeight;\n    \n        body?.addEventListener(\"mousemove\", CameraUtil.#onResize);\n        body?.addEventListener(\"mouseup\", CameraUtil.#onStopResize);\n      });\n    }\n  }\n\n  /**\n   * Resets the position and size of the camera container\n   * @param {Object} options - Position and size options\n   * @param {number|null} [options.x] - X position in pixels\n   * @param {number|null} [options.y] - Y position in pixels\n   * @param {number|null} [options.w] - Width in pixels\n   * @param {number|null} [options.h] - Height in pixels\n   */\n  static resetPositionAndSize({x, y, w, h} = { x: null, y: null, w: null, h: null }){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    if(!cameraSettings.enableFloatingDock || !CameraUtil.cameraContainer){ return }\n    if(!x && !y && !w && !h){\n      const savedPosX = cameraSettings.dockPosX || 0;\n      const savedPosY = cameraSettings.dockPosY || 0;\n      const savedWidth = cameraSettings.dockWidth || 0;\n      const savedHeight = cameraSettings.dockHeight || 0;\n\n      CameraUtil.cameraContainer.style.left = `${savedPosX}px`;\n      CameraUtil.cameraContainer.style.bottom = `${savedPosY}px`;\n      CameraUtil.cameraContainer.style.width = `${savedWidth}px`;\n      CameraUtil.cameraContainer.style.height = `${savedHeight}px`;\n    }else{\n      if(x){\n        CameraUtil.cameraContainer.style.left = `${x}px`;\n      }\n      if(y){\n        CameraUtil.cameraContainer.style.bottom = `${y}px`;\n      }\n      if(w){\n        CameraUtil.cameraContainer.style.width = `${w}px`;\n      }\n      if(h){\n        CameraUtil.cameraContainer.style.height = `${h}px`;\n      }\n    }\n    \n  }\n\n  // when user releases element\n  /**\n   * Handles the release of drag operation\n   * Saves the final position to settings\n   * @param {MouseEvent} e - Mouse event\n   * @private\n   */\n  static #onDragRelease(e){\n    const SETTINGS = getSettings();\n    const cameraSettings = {...SettingsUtil.get(SETTINGS.cameraDockMenu.tag)};\n\n    if(CameraUtil.isDragging){ \n      const body = document.querySelector(\"body.crlngn-ui\"); \n      cameraSettings.dockPosX = parseInt(CameraUtil.cameraContainer?.style.left) || 0; \n      cameraSettings.dockPosY = parseInt(CameraUtil.cameraContainer?.style.bottom) || 0; \n\n      if(cameraSettings.dockPosY <= 0){ cameraSettings.dockPosY = 0 }\n      SettingsUtil.set(SETTINGS.cameraDockMenu.tag, cameraSettings);\n      \n      body?.removeEventListener(\"mousemove\", CameraUtil.#onDragMove); \n      body?.removeEventListener(\"mouseup\", CameraUtil.#onDragRelease); \n  \n      CameraUtil.isDragging = false; \n      e.stopPropagation(); \n    }\n    \n  } \n\n  // when user drags element\n  /**\n   * Handles the drag movement of the camera container\n   * Updates position based on mouse movement\n   * @param {MouseEvent} e - Mouse event\n   * @private\n   */\n  static #onDragMove(e){ \n    if (!CameraUtil.isDragging) return; \n    LogUtil.log(\"mousemove\", [ e.target.parentNode ]); \n    \n    if(CameraUtil.cameraContainer){\n      let left = e.clientX - CameraUtil.#offsetX;\n      let bottom = (window.innerHeight - e.clientY) -  CameraUtil.#offsetY;\n\n      if(left + CameraUtil.cameraContainer.offsetWidth > window.innerWidth){  \n        left = window.innerWidth - CameraUtil.cameraContainer.offsetWidt;\n      }\n      CameraUtil.cameraContainer.style.left = `${left}px`;\n\n      if(bottom + CameraUtil.cameraContainer.offsetHeight > window.innerHeight){  \n        bottom = window.innerHeight - CameraUtil.cameraContainer.offsetHeight;\n      } \n      CameraUtil.cameraContainer.style.bottom = `${bottom}px`;\n    }\n    // e.stopPropagation(); \n  } \n\n  // when user drags the resize handle\n  /**\n   * Handles the resize operation of the camera container\n   * Updates size based on mouse movement\n   * @param {MouseEvent} e - Mouse event\n   * @private\n   */\n  static #onResize(e) {\n    if (!CameraUtil.isResizing) return;\n    const newWidth = CameraUtil.#startWidth + (e.clientX - CameraUtil.#startX);\n    const deltaY = e.clientY - CameraUtil.#startY; // How much the mouse moved\n    const newHeight = CameraUtil.#startHeight + deltaY;\n    const newBottom = CameraUtil.#startBottom - deltaY;\n\n    CameraUtil.cameraContainer.style.width = `${newWidth}px`;\n    CameraUtil.cameraContainer.style.height = `${newHeight}px`;\n    CameraUtil.cameraContainer.style.bottom = `${newBottom}px`;\n  }\n\n  // when user releases the resize handle\n  static #onStopResize() {\n    const SETTINGS = getSettings();\n    const cameraSettings = {...SettingsUtil.get(SETTINGS.cameraDockMenu.tag)};\n\n    const body = document.querySelector(\"body.crlngn-ui\");\n    CameraUtil.isResizing = false;\n    body?.removeEventListener(\"mousemove\", CameraUtil.#onResize);\n    body?.removeEventListener(\"mouseup\", CameraUtil.#onStopResize);\n\n    LogUtil.log(\"onStopResize\", [CameraUtil.cameraContainer?.style.width, CameraUtil.cameraContainer?.style.height, CameraUtil.cameraContainer?.style.bottom]);\n\n    cameraSettings.dockWidth = parseInt(CameraUtil.cameraContainer?.style.width || 0);\n    cameraSettings.dockHeight = parseInt(CameraUtil.cameraContainer?.style.height || 0);\n    cameraSettings.dockPosY = parseInt(CameraUtil.cameraContainer?.style.bottom || 0);\n\n    SettingsUtil.set(SETTINGS.cameraDockMenu.tag, cameraSettings);\n  }\n\n}","import { BORDER_COLOR_TYPES, getSettings } from \"../constants/Settings.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\n/**\n * Utility class for managing chat message styling and enhancements in FoundryVTT\n */\nexport class ChatUtil {\n  /** @type {string} Border color setting for chat messages */\n  static chatBorderColor;\n  /** @type {boolean} Flag indicating if custom chat styles are enabled */\n  static enableChatStyles;\n\n  /**\n   * Initializes chat utility settings\n   * Loads chat border color and style enablement from module settings\n   */\n  static init(){\n    const SETTINGS = getSettings();\n    ChatUtil.enableChatStyles = SettingsUtil.get(SETTINGS.enableChatStyles.tag);\n    ChatUtil.chatBorderColor = SettingsUtil.get(SETTINGS.chatBorderColor.tag);\n  }\n\n  /**\n   * Enriches chat message cards with additional styling and functionality\n   * @param {ChatMessage} chatMessage - The Foundry ChatMessage instance\n   * @param {jQuery|HTMLElement} html - The chat message HTML element\n   * @returns {Promise<void>}\n   */\n  static enrichCard = async(chatMessage, html) => {\n    LogUtil.log(\"renderChatMessage\", [ChatUtil.chatBorderColor, ChatUtil.enableChatStyles, BORDER_COLOR_TYPES.playerColor.name, chatMessage.author?.id]); \n    const rollType = chatMessage.flags?.dnd5e?.activity?.type || chatMessage.flags?.dnd5e?.roll?.type || \"custom\";\n    let chatItem = html.get ? html.get(0) : html;\n    if(!chatItem){ return; }\n    \n    chatItem.classList.add(rollType);\n    chatItem.classList.add('crlngn');\n\n    const saveButtons = chatItem.querySelectorAll('.card-buttons button[data-action=rollSave]');\n    if (saveButtons.length > 0) {      \n      saveButtons.forEach(button => {\n        const visibleDCSpan = button.querySelector('.visible-dc');\n        const hiddenDCSpan = button.querySelector('.hidden-dc');\n        LogUtil.log(\"enrichCard\",[visibleDCSpan, hiddenDCSpan]);\n\n        visibleDCSpan.setAttribute('data-ability', button.getAttribute('data-ability') || \"\");\n        visibleDCSpan.setAttribute('data-dc', button.getAttribute('data-dc') || \"\");\n        hiddenDCSpan.setAttribute('data-ability', button.getAttribute('data-ability') || \"\");\n      });\n    }\n\n    // add border color\n    if(ChatUtil.chatBorderColor===BORDER_COLOR_TYPES.playerColor.name && chatMessage.author?.id){ \n      chatItem.style.setProperty('border-color', `var(--user-color-${chatMessage.author.id})`);\n    }\n\n  }\n\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\n/**\n * Utility class for handling compatibility with other Foundry VTT modules\n * Manages interactions and adjustments needed for module interoperability\n */\nexport class ModuleCompatUtil {\n  /**\n   * @private\n   * Timeout handle for debouncing players list checks\n   */\n  static #checkPlayersTimeout;\n  /**\n   * Initializes module compatibility features\n   * Sets up hooks for players list and taskbar integration\n   */\n  static init(){\n\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, ModuleCompatUtil.checkPlayersList);\n    Hooks.on(HOOKS_CORE.RENDER_HOTBAR, ModuleCompatUtil.checkPlayersList);\n    // taskbar\n    const isTaskbarOn = GeneralUtil.isModuleOn('foundry-taskbar');\n    if(isTaskbarOn){\n      Hooks.on(HOOKS_CORE.UPDATE_USER, ModuleCompatUtil.checkTaskbarLock);\n    }\n    ModuleCompatUtil.checkTaskbarLock();\n  }\n\n  /**\n   * Checks and applies taskbar lock settings\n   * Adjusts UI variables based on taskbar module state and settings\n   */\n  static checkTaskbarLock = () => {\n    const isTaskbarOn = GeneralUtil.isModuleOn('foundry-taskbar');\n    // const body = document.querySelector('body.crlngn-ui');\n    // const bodyStyle = document.querySelector('#crlngn-ui-vars');\n    \n    /** @type {{taskbarSettings?: {locked?: boolean, reduceSidebar?: boolean}} | undefined} */\n    const taskbarFlag = game.user.flags?.['foundry-taskbar'];\n    LogUtil.log(\"checkTaskbarLock\",[taskbarFlag]);\n\n    if(!isTaskbarOn || !taskbarFlag?.taskbarSettings){\n      return;\n    }\n\n    const taskbarReduceSidebar = game.settings.get('foundry-taskbar','reduceSidebar');\n    if(taskbarFlag.taskbarSettings?.locked){\n      GeneralUtil.addCSSVars('--crlngn-sidebar-bottom', taskbarReduceSidebar ? '50px' : '0px');\n    }else{\n      GeneralUtil.addCSSVars('--crlngn-sidebar-bottom', '0px');\n    }\n\n    if(taskbarFlag.taskbarSettings?.locked){\n      GeneralUtil.addCSSVars('--crlngn-taskbar-height', '50px');\n    }else{\n      GeneralUtil.addCSSVars('--crlngn-taskbar-height', '10px');\n    }\n    const ftMoveStyle = document.querySelector(\"#ft-move-players-macro\");\n    if(ftMoveStyle){ftMoveStyle.innerHTML = '';}\n    ModuleCompatUtil.checkPlayersList();\n  }\n\n\n  /**\n   * Manages players list visibility and positioning\n   * Handles interaction between players list and taskbar module\n   */\n  static checkPlayersList = () => {\n    const body = document.querySelector('body');\n    const uiLeftPlayers = document.querySelector('#players');\n    const isTaskbarOn = GeneralUtil.isModuleOn('foundry-taskbar');\n    const isPlayersDocked = isTaskbarOn ? game.settings.get('foundry-taskbar','dockPlayersList') : false;\n    const isMacroDocked = isTaskbarOn ? game.settings.get('foundry-taskbar','dockMacroBar') : false;\n    LogUtil.log('checkPlayersList',[isPlayersDocked, isTaskbarOn, isMacroDocked, game.settings]);\n    let timeoutDelay = 10;\n    \n    if(isPlayersDocked){\n      timeoutDelay = 250;\n    }\n    const hotbar = document.querySelector('#hotbar');\n    if(hotbar && hotbar instanceof HTMLElement) hotbar.style.setProperty('visibility', 'hidden');\n    clearTimeout(ModuleCompatUtil.#checkPlayersTimeout);\n    ModuleCompatUtil.#checkPlayersTimeout =  setTimeout(()=>{\n      if(isPlayersDocked){\n\n        LogUtil.log('checkPlayersList TEST',[isPlayersDocked]);\n        body.classList.remove('with-players');\n        body.classList.remove('with-players-hide');\n        body.classList.add('players-hidden');\n      }else{\n        body.classList.remove('players-hidden');\n        if(body.querySelector('#players.auto-hide')){\n          body.classList.add('with-players-hide');\n          body.classList.remove('with-players');\n        }else if(uiLeftPlayers){\n          body.classList.add('with-players');\n          body.classList.remove('with-players-hide');\n        }\n      }\n      if(hotbar && hotbar instanceof HTMLElement) hotbar.style.removeProperty('visibility');\n      clearTimeout(ModuleCompatUtil.#checkPlayersTimeout);\n    }, timeoutDelay);\n    \n    \n  }\n\n\n}","import { MODULE_ID } from \"../constants/General.mjs\";\nimport { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SceneNavFolders } from \"./SceneFoldersUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\n/**\n * Manages the top navigation bar for scenes in FoundryVTT\n * Handles scene navigation, folder organization, and UI state\n */\nexport class TopNavigation {\n  static #navElem;\n  static #scenesList;\n  static #navTimeout;\n  static #navExtras;\n  static #navToggle;\n  static #uiMiddle;\n  static sceneFoldersTemplate;\n  static #timeout;\n  static #collapseTimeout;\n  static #navBtnsTimeout;\n  static #navFirstLoad = true;\n  // settings\n  static sceneNavEnabled;\n  static navFoldersEnabled;\n  static navFoldersForPlayers;\n  static navStartCollapsed;\n  static showFolderListOnClick;\n  static showNavOnHover;\n  static isCollapsed;\n  static navPos;\n\n  /**\n   * Initializes the top navigation system\n   * Sets up initial state, renders folders, and registers event hooks\n   * @returns {Promise<void>}\n   */\n  static init = async() => {\n    const SETTINGS = getSettings();\n    \n    // Load settings first\n    TopNavigation.navStartCollapsed = SettingsUtil.get(SETTINGS.navStartCollapsed.tag);\n    TopNavigation.showNavOnHover = SettingsUtil.get(SETTINGS.showNavOnHover.tag);\n    TopNavigation.sceneNavEnabled = SettingsUtil.get(SETTINGS.sceneNavEnabled.tag);\n    TopNavigation.navFoldersEnabled = SettingsUtil.get(SETTINGS.navFoldersEnabled.tag);\n    TopNavigation.navFoldersForPlayers = SettingsUtil.get(SETTINGS.navFoldersForPlayers.tag);\n    TopNavigation.showFolderListOnClick = SettingsUtil.get(SETTINGS.showFolderListOnClick.tag);\n    \n    // Then determine initial collapse state\n    TopNavigation.isCollapsed = TopNavigation.#navFirstLoad\n      ? TopNavigation.navStartCollapsed\n      : SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag);\n    TopNavigation.navPos = SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n\n    TopNavigation.resetLocalVars();\n    // if user disabled Scene Navigation Styles,\n    // skip everything\n    const uiMiddle = document.querySelector(\"#ui-middle\");\n\n    LogUtil.log(\"SCENE NAV INIT\", [TopNavigation.sceneNavEnabled]);\n    if(TopNavigation.sceneNavEnabled && uiMiddle){\n      uiMiddle.classList.add(\"crlngn-ui\");\n    }else if(uiMiddle){\n      uiMiddle.classList.remove(\"crlngn-ui\");\n      return;\n    }\n    \n    const isMonksSceneNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n    const isRipperSceneNavOn = GeneralUtil.isModuleOn(\"compact-scene-navigation\");\n    if(!isMonksSceneNavOn && !isRipperSceneNavOn){\n      await SceneNavFolders.renderSceneFolders();\n      \n      const scenePage = SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n      TopNavigation.setNavPosition(scenePage);\n      TopNavigation.placeNavButtons();\n      TopNavigation.addListeners();\n      //\n    }else if(isMonksSceneNavOn){\n      uiMiddle.classList.add('with-monks-scene');\n    }\n    // LogUtil.log(\"RENDER_NAV\", [ui.nav, game]);\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_NAV, async() => { \n      LogUtil.log(\"SCENE NAV\", [TopNavigation.navPos]);\n      LogUtil.log(\"TopNavigation\", [TopNavigation.isCollapsed, TopNavigation.navStartCollapsed]);\n\n      const SETTINGS = getSettings();\n      const isMonksSceneNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      const isRipperSceneNavOn = GeneralUtil.isModuleOn(\"compact-scene-navigation\");\n      LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, [ isMonksSceneNavOn, isRipperSceneNavOn ]);\n      \n      if(!isMonksSceneNavOn && !isRipperSceneNavOn){\n        LogUtil.log(\"NAV no transition add\");\n        TopNavigation.navPos = SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n\n        SceneNavFolders.init();\n        await SceneNavFolders.renderSceneFolders();\n        if(this.#scenesList) {this.#scenesList.classList.add(\"no-transition\")};\n        const scenePage = TopNavigation.navPos;\n        TopNavigation.setNavPosition(scenePage);\n        TopNavigation.placeNavButtons();\n        TopNavigation.addListeners();\n        // Only check sceneNavCollapsed setting if not first load\n        if (!TopNavigation.#navFirstLoad) {\n          TopNavigation.toggleNav(SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag));\n        }else{\n          LogUtil.log(\"TopNavigation\", [TopNavigation.isCollapsed, TopNavigation.navStartCollapsed]);\n        TopNavigation.#navFirstLoad = false;\n        TopNavigation.toggleNav(TopNavigation.navStartCollapsed);\n        }\n        \n        clearTimeout(TopNavigation.#timeout);\n        TopNavigation.#timeout = setTimeout(()=>{\n          LogUtil.log(\"NAV no transition remove\");\n          if(this.#scenesList) this.#scenesList.classList.remove(\"no-transition\");\n        }, 250);\n      }\n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SIDE_BAR, (value) => { \n      const isMonksSceneNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      LogUtil.log(HOOKS_CORE.COLLAPSE_SIDE_BAR, [\"isMonksSceneNavOn\",isMonksSceneNavOn]);\n      if(!isMonksSceneNavOn && !isRipperSceneNavOn){\n        TopNavigation.placeNavButtons(); \n      }\n      \n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SCENE_NAV, (nav, collapsed) => {\n      const SETTINGS = getSettings();\n      SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, collapsed); \n      LogUtil.log(\"NAV toggle\", [nav, collapsed]); \n\n\n      TopNavigation.isCollapsed = collapsed;\n      TopNavigation.toggleNav(collapsed);\n    }); \n\n    Hooks.on(HOOKS_CORE.EXPAND_SCENE_NAV, (nav, value) => {\n      // const SETTINGS = getSettings();\n      LogUtil.log(\"NAV expand\", [nav, false]); \n      // SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, false); \n      // TopNavigation.isCollapsed = false;\n    }); \n\n    // SettingsUtil.apply(SETTINGS.sceneNavCollapsed.tag); \n    window.addEventListener('resize', ()=>{\n      const isMonksSceneNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      const isRipperSceneNavOn = GeneralUtil.isModuleOn(\"compact-scene-navigation\");\n      if(!isMonksSceneNavOn && !isRipperSceneNavOn){\n        TopNavigation.placeNavButtons();\n      }\n    });\n\n    LogUtil.log(\"TopNavigation - init\", [TopNavigation.sceneNavEnabled])\n    \n    // if(TopNavigation.sceneNavEnabled){ \n    //   // TopNavigation.observeNavOffset(); \n    // } \n\n  } \n\n  /**\n   * Toggles the navigation bar's collapsed state\n   * @param {boolean} collapsed - Whether the navigation should be collapsed\n   */\n  static toggleNav(collapsed){\n    clearTimeout(TopNavigation.#collapseTimeout);\n    TopNavigation.#collapseTimeout = setTimeout(()=>{\n      TopNavigation.resetLocalVars();\n      if(collapsed){\n        ui.nav.collapse();\n        TopNavigation.#uiMiddle.classList.add('navigation-collapsed');\n      }else{\n        ui.nav.expand();\n        TopNavigation.#uiMiddle.classList.remove('navigation-collapsed');\n      }\n    }, 500);\n    \n  }\n\n  /**\n   * If Monk's Scene Navigation or Compact Scene Navigation are enabled, disable Carolingian UI Top Navigation\n   */\n  static checkSceneNavCompat(){\n    const SETTINGS = getSettings();\n    const isMonksSceneNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n    const isRipperSceneNavOn = GeneralUtil.isModuleOn(\"compact-scene-navigation\");\n    const uiMiddle = document.querySelector(\"#ui-middle\");\n\n    if((isMonksSceneNavOn || isRipperSceneNavOn) && TopNavigation.sceneNavEnabled){\n      uiMiddle.classList.remove(\"crlngn-ui\");\n      SettingsUtil.set(SETTINGS.sceneNavEnabled.tag, false);\n      SettingsUtil.set(SETTINGS.navFoldersEnabled.tag, false);\n      TopNavigation.sceneNavEnabled = false;\n      TopNavigation.navFoldersEnabled = false;\n\n      LogUtil.log(\"checkSceneNavCompat\", [isMonksSceneNavOn, isRipperSceneNavOn]);\n      \n      if(game.user.isGM && isMonksSceneNavOn){\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.monksScenesNotSupported\"), {permanent: true});\n      }\n      if(game.user.isGM && isRipperSceneNavOn){\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.ripperScenesNotSupported\"), {permanent: true});\n      }\n    }\n  }\n\n  /**\n   * Resets and reinitializes local DOM element references\n   */\n  static resetLocalVars(){\n    TopNavigation.#navElem = document.querySelector(\"#navigation\"); \n    TopNavigation.#navExtras = document.querySelector(\"#navigation .nav-item.is-root\"); \n    TopNavigation.#navToggle = document.querySelector(\"#nav-toggle\"); \n    TopNavigation.#uiMiddle = document.querySelector(\"#ui-middle\");\n\n    if(TopNavigation.navFoldersEnabled){\n      TopNavigation.#scenesList = document.querySelector(\"#crlngn-scene-list\"); \n      LogUtil.log(\"TopNavigation resetLocalVars\", [TopNavigation.#scenesList]);\n    }else{\n      TopNavigation.#scenesList = document.querySelector(\"#crlngn-scene-list\"); \n    }\n    // TopNavigation.#leftControls = document.querySelector(\"#ui-left #controls\"); \n  }\n\n  /**\n   * Adds event listeners for navigation interactions\n   * Handles hover and click events for navigation expansion/collapse\n   */\n  static addListeners(){\n    TopNavigation.#navElem?.addEventListener(\"mouseenter\", (e)=>{\n      LogUtil.log(\"TopNavigation mouseenter\", [ ]);\n    \n      if( !TopNavigation.isCollapsed ||\n          !TopNavigation.showNavOnHover ){ \n            return;\n      }\n      e.stopPropagation();\n      clearTimeout(TopNavigation.#navTimeout);\n\n      const navigation = document.querySelector(\"#navigation\");\n      navigation.classList.remove(\"collapsed\");\n    });\n\n    this.#navElem?.addEventListener(\"mouseleave\", (e)=>{\n      LogUtil.log(\"TopNavigation mouseleave\", [ ]);\n      if( !TopNavigation.isCollapsed ||\n          !TopNavigation.showNavOnHover ){ \n          return;\n      }\n      e.stopPropagation();\n\n      this.#navTimeout = setTimeout(()=>{\n        clearTimeout(this.#navTimeout);\n        this.#navTimeout = null;\n        const navigation = document.querySelector(\"#navigation\");\n        navigation.classList.add(\"collapsed\");\n      }, 700);\n    });\n  }\n\n  /**\n   * Places navigation buttons for scrolling through scenes\n   * Only adds buttons if navigation is overflowing and buttons don't already exist\n   */\n  static placeNavButtons(){ \n    clearTimeout(this.#navBtnsTimeout);\n    TopNavigation.#navBtnsTimeout = setTimeout(() => {\n      clearTimeout(this.#navBtnsTimeout);\n      TopNavigation.resetLocalVars();\n\n      const folderListWidth = this.#navElem?.querySelector(\"#crlngn-scene-folders\")?.offsetWidth || 0;\n      const existingButtons = this.#navElem?.querySelectorAll(\"button.crlngn-nav\");\n      const isNavOverflowing = this.#scenesList?.scrollWidth + folderListWidth >= this.#navElem?.offsetWidth;\n      LogUtil.log(\"placeNavButtons\", [ this.#scenesList, isNavOverflowing ]);\n      \n      if(!isNavOverflowing){\n        return;\n      }\n      existingButtons.forEach(b => b.remove());\n\n      const btnLast = document.createElement(\"button\"); \n      btnLast.classList.add(\"crlngn-nav\"); \n      btnLast.classList.add(\"ui-nav-left\"); \n      const arrowLeft = document.createElement(\"i\"); \n      arrowLeft.classList.add(\"fa\"); \n      arrowLeft.classList.add(\"fa-chevron-left\"); \n      btnLast.addEventListener(\"click\", this.#onNavLast);\n      btnLast.append(arrowLeft); \n\n      const btnNext = document.createElement(\"button\"); \n      btnNext.classList.add(\"crlngn-nav\"); \n      btnNext.classList.add(\"ui-nav-right\"); \n      const arrowRight = document.createElement(\"i\"); \n      arrowRight.classList.add(\"fa\"); \n      arrowRight.classList.add(\"fa-chevron-right\"); \n      btnNext.append(arrowRight); \n      btnNext.addEventListener(\"click\", this.#onNavNext);\n\n      this.#navElem?.appendChild(btnLast);\n      this.#navElem?.appendChild(btnNext);\n      if(this.#scenesList) this.#scenesList.classList.remove(\"no-transition\");\n    }, 250);\n  }\n\n\n  /**\n   * @private\n   * Handles click on the 'previous' navigation button\n   * Scrolls the scene list backward by one page\n   * @param {Event} e - The pointer event\n   */\n  static #onNavLast = (e) => {\n    const folderListWidth = this.#navElem?.querySelector(\"#crlngn-scene-folders\")?.offsetWidth || 0;\n    const toggleWidth = this.#navToggle?.offsetWidth;\n    const firstScene = this.#scenesList?.querySelector(\"li.nav-item:not(.is-root)\");\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item:not(.is-root)\") || [];\n    const itemWidth = firstScene.offsetWidth;\n    const currPos = TopNavigation.navPos || 0;\n    const itemsPerPage = Math.floor((this.#navElem?.offsetWidth - (currPos === 0 ? folderListWidth : 0) - (toggleWidth*2))/itemWidth);\n\n    let newPos = currPos - (itemsPerPage - 1);\n    newPos = newPos < 0 ? 0 : newPos;\n    LogUtil.log(\"onNavLast\", [\"currPos\", currPos, \"items\", itemsPerPage, newPos]);\n\n    TopNavigation.setNavPosition(newPos); \n  }\n\n  /**\n   * @private\n   * Handles click on the 'next' navigation button\n   * Scrolls the scene list forward by one page\n   * @param {Event} e - The pointer event\n   */\n  static #onNavNext = (e) => {\n    // const SETTINGS = getSettings();\n    const folderListWidth = this.#navElem?.querySelector(\"#crlngn-scene-folders\")?.offsetWidth || 0;\n    const toggleWidth = this.#navToggle?.offsetWidth;\n    const firstScene = this.#scenesList?.querySelector(\"li.nav-item:not(.is-root)\");\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item:not(.is-root)\") || [];\n    const itemWidth = firstScene.offsetWidth;\n    const currPos = TopNavigation.navPos || 0;\n    const itemsPerPage = Math.floor((this.#navElem?.offsetWidth - (currPos === 0 ? folderListWidth : 0) - (toggleWidth*2))/itemWidth);\n\n    let newPos = currPos + (itemsPerPage - 1);\n    newPos = newPos > scenes.length-1 ? scenes.length-1 : newPos;\n\n    LogUtil.log(\"onNavNext\", [\"currPos\", currPos, \"items\", itemsPerPage, newPos]);\n\n\n    TopNavigation.setNavPosition(newPos); \n  }\n\n  /**\n   * Sets the position of the scene navigation list\n   * @param {number} [pos] - The position to scroll to. If undefined, uses stored position\n   */\n  static setNavPosition(pos) { \n    const SETTINGS = getSettings();\n    if(!this.#scenesList){ return; }\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item:not(.is-root)\") || [];\n    const position = pos!==undefined ? pos : TopNavigation.navPos || 0;\n\n    const newMargin = parseInt(scenes[position]?.offsetLeft) * -1;\n    this.#scenesList.style.marginLeft = newMargin + 'px';\n\n    TopNavigation.navPos = position;\n    SettingsUtil.set(SETTINGS.sceneNavPos.tag, position);\n\n    LogUtil.log(\"setNavPosition\", [pos, position, scenes, scenes[position], newMargin]);\n  }\n}\n","import { MODULE_ID } from \"../constants/General.mjs\";\nimport { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { TopNavigation } from \"./TopNavUtil.mjs\";\n\nconst DEFAULT_FOLDER_ID = \"favorites\";\n\n/**\n * Manages scene navigation folders in the UI, providing functionality for folder organization,\n * selection, and display of scene folders.\n */\nexport class SceneNavFolders {\n  static selectedFolder;\n  static folderList;\n  static folderListData = [];\n  static searchValue = \"\";\n  static #defaultFolderName = 'Favorites';\n  static contextMenuSceneId = null;\n\n  static init(){\n    if(SceneNavFolders.noFolderView()){ return; }\n    SceneNavFolders.#defaultFolderName = game.i18n.localize(\"CRLNGN_UI.ui.sceneNav.favoritesFolder\");\n    if(!SceneNavFolders.folderListData || SceneNavFolders.folderListData.length === 0){\n      const isMonksSceneNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      const isRipperSceneNavOn = GeneralUtil.isModuleOn(\"compact-scene-navigation\");\n      if(!isMonksSceneNavOn && !isRipperSceneNavOn){\n        SceneNavFolders.preloadTemplate();\n      }\n      LogUtil.log(\"SceneNavFolders\",[ui.scenes]);\n      SceneNavFolders.folderListData = SceneNavFolders.getFolders(ui.scenes.folders);\n      SceneNavFolders.selectedFolder = SceneNavFolders.selectFolder(DEFAULT_FOLDER_ID);\n    }\n  }\n\n  /**\n   * \n   * @param {object[]} fromList \n   * @returns \n   */\n  /**\n   * Retrieves and sorts top-level folders from the provided folder list\n   * @param {object[]} fromList - Array of folder objects to filter\n   * @returns {object[]} Sorted array of top-level folders\n   */\n  static getFolders = (fromList) => {\n    let folders = fromList.filter(f => { \n      return f.folder === null;\n    });\n\n    // alphabetical order\n    folders.sort((a, b) => {\n      return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n    });\n    // LogUtil.log(\"getFolders\", [folders]);\n\n    return folders;\n  }\n\n  /**\n   * Selects a folder by its ID\n   * @param {string} id - The ID of the folder to select\n   * @returns {object|null} The selected folder object or null if not found\n   */\n  static selectFolder = (id) => {\n    return SceneNavFolders.getFolderById(id) || null;\n  }\n\n  /**\n   * \n   * @param {string} id - Scene folder id\n   */\n  /**\n   * Retrieves a folder by its ID\n   * @param {string} id - Scene folder id\n   * @returns {object|string} Found folder object or DEFAULT_FOLDER_ID if not found\n   */\n  static getFolderById(id){\n    return ui.scenes.folders.find(fd => {\n      return fd.id===id\n    }) || DEFAULT_FOLDER_ID;\n  }\n\n  /**\n   * Creates a new folder list item element\n   * @returns {HTMLLIElement} New folder list item element\n   */\n  static createFolderElem = () => {\n    const folderElem = document.createElement(\"li\");\n    return folderElem;\n  }\n\n  /**\n   * Creates an ordered list element containing folder items\n   * @param {object[]} folders - Array of folder objects to create list items for\n   * @returns {HTMLOListElement} Ordered list element containing folder items\n   */\n  static createListElement = (folders) => {\n    const folderList = document.createElement(\"ol\"); \n    folderList.classList.add('folder-list');\n\n    folders.forEach(f => {\n      const folder = document.createElement(\"li\");\n\n      LogUtil.log(\"createListElement\", [f]);\n      \n      if(f.children && f.children.length > 0){\n        folder.innerHTML = `<a class=\"with-subfolders\">${f.name}</a>`; \n      }else{\n        folder.innerHTML = `<a>${f.name}</a>`; \n      }\n      folderList.append(folder);\n    })\n\n    return folderList;\n  }\n\n  /**\n   * Preloads the Handlebars template for scene folder list\n   * @returns {Promise<boolean>} True when template is successfully loaded\n   */\n  static preloadTemplate = async() => {\n    const templatePath = [\n      `modules/${MODULE_ID}/templates/scene-folder-list.hbs`\n    ];\n    \n    // This returns an object with paths as keys and template functions as values\n    await loadTemplates(templatePath);\n\n    LogUtil.log(\"preloadTemplate\", [true]);\n  \n    return true;\n  }\n\n  /**\n   * Retrieves extended data for a folder\n   * @param {object} folder - The folder object to get data for\n   * @returns {object} Extended folder data\n   */\n  static getFoldersData = (folder) => {\n    return {\n      ...folder,\n      children: folder.children.map(fc => SceneNavFolders.getFoldersData(fc)),\n      hasSubfolders: folder.children.length > 0,\n      id: folder.id\n    };\n  }\n\n  /**\n   * Renders the scene folders UI using the Handlebars template\n   * @returns {Promise<void>}\n   */\n  static #templateData = null;\n  static #folderElement = null;\n  static #customList = null;\n\n  static renderSceneFolders = async() => {\n    if(SceneNavFolders.noFolderView()){ return; }\n    if(!SceneNavFolders.selectedFolder){ return; }\n\n    LogUtil.log(\"SCENE NAV renderSceneFolders\", []);\n\n    const folders = SceneNavFolders.getFolders(ui.scenes.folders);\n    \n\n    // Prepare base template data\n    const baseData = {\n      favoritesId: DEFAULT_FOLDER_ID,\n      favoritesName: SceneNavFolders.#defaultFolderName || DEFAULT_FOLDER_ID,\n      folderList: folders.map(f => SceneNavFolders.getFoldersData(f)),\n      viewedSceneId: game.scenes.current.id,\n      users: game.users.contents,\n      isGM: game.user.isGM,\n      searchValue: SceneNavFolders.searchValue,\n      showSearchResults: !!SceneNavFolders.searchValue\n    };\n\n    // Add folder-specific data\n    if(SceneNavFolders.selectedFolder === DEFAULT_FOLDER_ID) {\n      SceneNavFolders.#templateData = {\n        ...baseData,\n        currFolder: { name: SceneNavFolders.#defaultFolderName || DEFAULT_FOLDER_ID, id: DEFAULT_FOLDER_ID },\n        currIcon: 'fa-star',\n        folders: [],\n        scenes: ui.nav.scenes.filter(sc => sc.permission >= 2)\n      };\n    } else {\n      const foldersData = SceneNavFolders.selectedFolder.children;\n      LogUtil.log(\"foldersData\", [foldersData, SceneNavFolders.selectedFolder]);\n      SceneNavFolders.#templateData = {\n        ...baseData,\n        currFolder: SceneNavFolders.selectedFolder,\n        currIcon: 'fa-folder',\n        folders: foldersData,\n        scenes: SceneNavFolders.selectedFolder.contents\n      };\n    }\n\n    // Check if cached elements are still in the document\n    // if (!SceneNavFolders.#folderElement?.isConnected || !SceneNavFolders.#customList?.isConnected) {\n    LogUtil.log(\"Elements not in DOM, rendering template\", []);\n    \n    // Clear existing elements if they exist\n    SceneNavFolders.#folderElement?.remove();\n    SceneNavFolders.#customList?.remove();\n    \n    const renderedHtml = await renderTemplate(\n      `modules/${MODULE_ID}/templates/scene-folder-list.hbs`, \n      SceneNavFolders.#templateData\n    );\n    \n    const targetElement = document.querySelector('#scene-list');\n    targetElement.insertAdjacentHTML('beforebegin', renderedHtml);\n    \n    \n    SceneNavFolders.#folderElement = document.querySelector('#crlngn-scene-folders');\n    SceneNavFolders.#customList = document.querySelector('#crlngn-scene-list');\n    targetElement?.classList.add('hidden');\n    const nav = SceneNavFolders.#customList;//targetElement.previousElementSibling;\n\n    const sceneItems = nav.querySelectorAll(\"li.nav-item\");\n    const navPos = TopNavigation.navPos || 0;\n    const newMargin = parseInt(sceneItems[navPos]?.offsetLeft) * -1;\n    nav.style.marginLeft = newMargin + 'px';\n\n    // Set up initial listeners\n    SceneNavFolders.activateFolderListeners(SceneNavFolders.#folderElement);\n    SceneNavFolders.#addSceneListeners(SceneNavFolders.#customList);\n    // } else {\n    //   // Update existing elements\n    //   SceneNavFolders.#updateFolderView();\n    // }\n\n    TopNavigation.resetLocalVars();\n  }\n\n  /**\n   * Activates event listeners for the scene folders UI\n   * @param {HTMLElement} html - The HTML element containing the scene folders UI\n   */\n  static activateFolderListeners = (html) => {\n    if(SceneNavFolders.noFolderView()){ return; }\n\n    LogUtil.log(\"activateFolderListeners\", [html]);\n\n    // Add click or hover event to folder list header\n    const selectedLink = html.querySelector('a.selected');\n    if(TopNavigation.showFolderListOnClick){\n      selectedLink?.removeEventListener('mouseover', SceneNavFolders.#onOpenList);\n      html.removeEventListener('mouseleave', SceneNavFolders.#onOpenList);\n      selectedLink?.addEventListener('click', SceneNavFolders.#onOpenList);\n    }else{\n      selectedLink?.addEventListener('mouseover', SceneNavFolders.#onOpenList);\n      html.addEventListener('mouseleave', SceneNavFolders.#onOpenList);\n      selectedLink?.removeEventListener('click', SceneNavFolders.#onOpenList);\n    }\n    \n\n    // Add click event to all toggle spans\n    html.querySelectorAll('span.toggle').forEach(toggleSpan => {\n      toggleSpan.addEventListener('click', (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        // Find the parent li\n        const parentLi = event.currentTarget.closest('li');\n        // Find the subfolders list within this li\n        const subfoldersOl = parentLi.querySelector('ol.subfolders');\n        \n        // Toggle visibility of the subfolders\n        if (!subfoldersOl) { return }\n        const isHidden = !(subfoldersOl.classList.contains('open'));\n        if(isHidden){\n          subfoldersOl.classList.add('open');\n          event.currentTarget.textContent = '−';\n        }else{\n          subfoldersOl.classList.remove('open');\n          event.currentTarget.textContent = '+';\n        }\n      });\n    });\n\n    // add click behavior for all folders in the list\n    const folderItems = html.querySelectorAll(\".folder-list li.folder\");\n    folderItems.forEach(fi => {\n      fi.addEventListener(\"click\", SceneNavFolders.#onSelectFolder);\n    });\n\n    const searchInput = html.querySelector('.search-container .input-scene-search');\n    searchInput.addEventListener(\"keyup\", SceneNavFolders.#onSearchInput);\n    searchInput.addEventListener('keydown', evt => {\n      evt.stopPropagation();\n    });\n  }\n\n  /**\n   * Adds click event listeners to scene items in the scene folders UI\n   * @param {HTMLElement} html - The HTML element containing the scene folders UI\n   */\n  static #addSceneListeners = (html) => {\n    const sceneItems = html.querySelectorAll(\"li.nav-item\");\n    sceneItems.forEach(li => {\n      const isFolder = li.classList.contains(\"folder\");\n      li.addEventListener(\"click\", isFolder ? SceneNavFolders.#onSelectFolder : SceneNavFolders.#onSelectScene);\n      li.addEventListener(\"dblclick\", isFolder ? ()=>{} : SceneNavFolders.#onActivateScene);\n    });\n\n    // Only add drag-drop if user is GM\n    if (game.user.isGM) {\n      SceneNavFolders.#initializeDragDrop(html);\n    }\n  }\n\n  /**\n   * Initialize drag and drop functionality for scenes\n   * @param {HTMLElement} html - The scene list container\n   */\n  static #initializeDragDrop = (html) => {\n    // Initialize SortableJS on the scene list\n    const options = {\n      animation: 150,\n      draggable: \".nav-item\",\n      delay: 50,\n      delayOnTouchOnly: true,\n      onEnd: async (evt) => {\n        const scenes = html.querySelectorAll(\".nav-item\");\n        const updates = [];\n        \n        // Get all scenes in their new order\n        const orderedScenes = Array.from(scenes).map(el => game.scenes.get(el.dataset.sceneId));\n        \n        // Calculate base sort order\n        const siblings = Array.from(scenes);\n        const updateData = SortingHelpers.performIntegerSort(evt.item, {\n          target: evt.to,\n          siblings: siblings,\n          sortBefore: true\n        });\n\n        // Calculate navigation order for scenes\n        let navOrder = 0;\n        const density = CONST.SORT_INTEGER_DENSITY;\n\n        // First pass: Update sort for all scenes\n        for (let [id, sort] of Object.entries(updateData || {})) {\n          const scene = game.scenes.get(id);\n          if (!scene) continue;\n          \n          // Start with just the sort update\n          const update = {\n            _id: scene.id,\n            sort: sort\n          };\n\n          // If this scene is navigable, assign it a nav order\n          if (scene.navigation) {\n            update.navOrder = navOrder;\n            navOrder += density;\n          }\n\n          updates.push(update);\n        }\n\n        // Second pass: Update any remaining navigable scenes not in the drag operation\n        for (const scene of orderedScenes) {\n          if (!scene || !scene.navigation || updates.some(u => u._id === scene.id)) continue;\n          updates.push({\n            _id: scene.id,\n            navOrder: navOrder\n          });\n          navOrder += density;\n        }\n\n        // Apply updates\n        if (updates.length) {\n          await Scene.updateDocuments(updates);\n          ui.nav.render();\n        }\n      }\n    };\n\n    new Sortable(html, options);\n  }\n\n  /**\n   * Refreshes the folder view by updating folder data and re-rendering\n   */\n  static refreshFolderView = async() => {\n    if(SceneNavFolders.noFolderView()){ return; }\n    SceneNavFolders.folderListData = SceneNavFolders.getFolders(ui.scenes.folders);\n    await SceneNavFolders.renderSceneFolders();\n    TopNavigation.placeNavButtons();\n  }\n\n  /**\n   * Updates the search results container with filtered scenes and folders\n   * @param {string} searchValue - The search query to filter by\n   */\n  static updateSearchResults = (searchValue) => {\n    if(SceneNavFolders.noFolderView()){ return; }\n    const searchResultsContainer = document.querySelector('.search-container .search-results');\n    if (!searchResultsContainer) return;\n    \n    // Clear previous results\n    searchResultsContainer.innerHTML = '';\n    \n    if (!searchValue) {\n      searchResultsContainer.classList.add('hidden');\n      return;\n    }\n    \n    // Filter scenes and folders\n    const filteredScenes = game.scenes.filter(sc => {\n      return sc.name.toLowerCase().includes(searchValue.toLowerCase()) && sc.permission >= 2;\n    });\n    \n    const filteredFolders = game.scenes.folders.filter(f => {\n      return f.name.toLowerCase().includes(searchValue.toLowerCase());\n    });\n    \n    // Show the results container\n    searchResultsContainer.classList.remove('hidden');\n    \n    // Add folders to results\n    filteredFolders.forEach(folder => {\n      const li = document.createElement('li');\n      li.className = 'folder';\n      li.dataset.folderId = folder.id;\n      li.innerHTML = `<a><i class=\"fas fa-folder\"></i> ${folder.name}</a>`;\n      li.addEventListener('click', SceneNavFolders.#onSelectFolder);\n      searchResultsContainer.appendChild(li);\n    });\n    \n    // Add scenes to results\n    filteredScenes.forEach(scene => {\n      const li = document.createElement('li');\n      li.className = 'scene';\n      li.dataset.sceneId = scene.id;\n      li.innerHTML = `<a><i class=\"fas fa-map\"></i> ${scene.name}</a>`;\n      li.addEventListener('dblclick', SceneNavFolders.#onActivateScene);\n      li.addEventListener('click', SceneNavFolders.#onSelectScene);\n      searchResultsContainer.appendChild(li);\n    });\n    \n    // If no results found\n    if (filteredFolders.length === 0 && filteredScenes.length === 0) {\n      const li = document.createElement('li');\n      li.className = 'no-results';\n      li.textContent = 'No matching results found';\n      searchResultsContainer.appendChild(li);\n    }\n  }\n\n  /**\n   * Registers Foundry VTT hooks for folder and scene changes\n   */\n  static registerHooks() {\n    Hooks.on(HOOKS_CORE.CREATE_FOLDER, (folder) => {\n      if (folder.type === \"Scene\") {\n        SceneNavFolders.refreshFolderView();\n      }\n    });\n    \n    Hooks.on(HOOKS_CORE.UPDATE_FOLDER, (folder) => {\n      if (folder.type === \"Scene\") {\n        SceneNavFolders.refreshFolderView();\n      }\n    });\n    \n    Hooks.on(HOOKS_CORE.DELETE_FOLDER, (folder) => {\n      if (folder.type === \"Scene\") {\n        SceneNavFolders.refreshFolderView();\n      }\n    });\n    \n    // Also hook into scene changes\n    Hooks.on(HOOKS_CORE.CREATE_SCENE, () => {\n      SceneNavFolders.refreshFolderView();\n      // game.scenes.directory.render();\n    });\n    Hooks.on(HOOKS_CORE.UPDATE_SCENE, () => {\n      SceneNavFolders.refreshFolderView();\n      // game.scenes.directory.render();\n    });\n    Hooks.on(HOOKS_CORE.DELETE_SCENE, () => {\n      SceneNavFolders.refreshFolderView();\n      // game.scenes.directory.render();\n    });\n\n    // Hooks.on(HOOKS_CORE.GET_SCENE_DIRECTORY_ENTRY_CONTEXT, SceneNavFolders.#modifyDirectoryContextMenu);\n    Hooks.on(HOOKS_CORE.RENDER_DOCUMENT_DIRECTORY, (directory) => {\n      if(directory.entryType !== \"Scene\") return;\n      \n      const sceneNav = document.querySelector('#scenes .directory-list');\n      sceneNav.addEventListener('contextmenu', (event) => {\n        const navItem = event.target.closest('.directory-item');\n        if (!navItem) return;\n        \n        SceneNavFolders.contextMenuSceneId = navItem.dataset.documentId || null;\n        \n        if (SceneNavFolders.contextMenuSceneId) {\n          const scene = game.scenes.get(SceneNavFolders.contextMenuSceneId);\n          const langPath = scene.navigation ? \"removeFromFavorites\" : \"addToFavorites\";\n          const optionLabel = game.i18n.localize(\"CRLNGN_UI.ui.sceneNav.\" + langPath);\n\n          SceneNavFolders.#observeSceneContextMenu(optionLabel);\n          \n        }\n      });\n    });\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_NAV, () => {      \n      const sceneNav = document.querySelector('#navigation');\n      sceneNav.addEventListener('contextmenu', (event) => {\n        const navItem = event.target.closest('.nav-item');\n        if (!navItem) return;\n        \n        SceneNavFolders.contextMenuSceneId = event.currentTarget.dataset.sceneId || navItem.dataset.sceneId || null;\n        \n        if (SceneNavFolders.contextMenuSceneId) {\n          const scene = game.scenes.get(SceneNavFolders.contextMenuSceneId);\n          const langPath = scene.navigation ? \"removeFromFavorites\" : \"addToFavorites\";\n          const optionLabel = game.i18n.localize(\"CRLNGN_UI.ui.sceneNav.\" + langPath);\n          // LogUtil.log(\"contextmenu\", [scene, optionLabel]);\n\n          SceneNavFolders.#observeSceneContextMenu(optionLabel);\n        }\n      });\n    });\n  }\n  /**\n   * Observes the context menu and adds a label for including or removing a scene from favorites\n   * @param {string} optionLabel - The label for the context menu item\n   */\n  static #observeSceneContextMenu = (optionLabel) => {\n    const updateContextMenu = () => {\n      const contextMenu = document.querySelector('#context-menu');\n      if (!contextMenu) return false;\n\n      const menuItems = contextMenu.querySelectorAll('.context-item');\n      const toggleNavItem = Array.from(menuItems).find(item => \n        item.innerHTML.includes(game.i18n.localize(\"SCENES.ToggleNav\"))\n      );\n\n      if (toggleNavItem) {\n        LogUtil.log(\"updating toggle nav item\", [toggleNavItem]);\n        toggleNavItem.innerHTML = `<i class=\"fas fa-star fa-fw\"></i>${optionLabel}`;\n        return true;\n      }\n      return false;\n    };\n\n    // Try to update immediately first\n    if (updateContextMenu()) return;\n\n    // If immediate update fails, set up observer for menu creation\n    const contextMenuObserver = new MutationObserver((mutations, obs) => {\n      if (updateContextMenu()) {\n        obs.disconnect();\n      }\n    });\n\n    // Start observing document body for changes\n    contextMenuObserver.observe(document.body, {\n      childList: true,\n      subtree: true\n    });\n\n    // Safety cleanup\n    setTimeout(() => contextMenuObserver.disconnect(), 1000);\n  }\n\n  /**\n   * @private\n   * Handles opening/closing the folder list\n   * @param {Event} evt - The triggering event\n   */\n  static #onOpenList = (evt) => {\n    evt.stopPropagation();\n    evt.preventDefault();\n\n    const folderElement = document.querySelector('#crlngn-scene-folders');\n    const isMouseEvent = evt.type.startsWith('mouse');\n    const isHoverMode = !TopNavigation.showFolderListOnClick;\n\n    // For mouseover, only open if it's not already open\n    if (isMouseEvent && isHoverMode && evt.type === 'mouseover') {\n      if (!folderElement?.classList.contains('open')) {\n        folderElement?.classList.add('open');\n      }\n      return;\n    }\n\n    // For mouseleave in hover mode, only close if we're actually leaving the entire folder element\n    if (isMouseEvent && isHoverMode && evt.type === 'mouseleave') {\n      folderElement?.classList.remove('open');\n      return;\n    }\n\n    // For click mode, toggle the open state\n    if (!isMouseEvent) {\n      if (folderElement?.classList.contains('open')) {\n        folderElement?.classList.remove('open');\n      } else {\n        folderElement?.classList.add('open');\n        document.addEventListener('click', SceneNavFolders.#onOutsideClick);\n      }\n    }\n  }\n\n  /**\n   * @private\n   * Handles outside click events\n   * @param {Event} evt - The triggering event\n   */\n  static #onOutsideClick = (evt) => {\n    evt.preventDefault();\n\n    document.removeEventListener('click', SceneNavFolders.#onOutsideClick);\n    // evt.stopPropagation();\n    const target = evt.target;\n    const folderElement = document.querySelector('#crlngn-scene-folders');\n    LogUtil.log(\"#onOutsideClick\", [folderElement, target, folderElement.contains(target)]);\n    // const selectedLink = folderElement?.querySelector('a.selected');\n    if (folderElement?.classList.contains('open') && !folderElement.contains(target)) {\n      folderElement.classList.remove('open');\n    }\n  }\n\n  /**\n   * Handles scene selection\n   * @param {Event} evt - The triggering event\n   * @private\n   */\n  static #clickTimer = null;\n  static #onSelectScene = (evt) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n    document.removeEventListener('click', SceneNavFolders.#onOutsideClick);\n    const target = evt.currentTarget;\n    const data = target.dataset;\n    const scene = game.scenes.get(data.sceneId);\n    const isSearchResult = target.parentElement?.classList.contains('search-results');\n\n    LogUtil.log(\"scene click\", [scene, target.parentElement, isSearchResult]);\n\n    // Clear any existing timer\n    if (SceneNavFolders.#clickTimer) {\n      clearTimeout(SceneNavFolders.#clickTimer);\n      SceneNavFolders.#clickTimer = null;\n    }\n\n    // Set a new timer for the click action\n    SceneNavFolders.#clickTimer = setTimeout(() => {\n      if(isSearchResult){\n        scene.navigation = true;\n        SceneNavFolders.selectedFolder = SceneNavFolders.selectFolder(DEFAULT_FOLDER_ID);\n      }\n      scene.view();\n      SceneNavFolders.refreshFolderView();\n      SceneNavFolders.#clickTimer = null;\n      \n    }, 250); // 250ms delay to wait for potential double-click\n  }\n\n  static #onActivateScene = (evt) => {\n    evt.stopPropagation();\n    evt.preventDefault();\n    const target = evt.currentTarget;\n    const data = target.dataset;\n    const scene = game.scenes.get(data.sceneId);\n\n    // Clear the single-click timer if it exists\n    if (SceneNavFolders.#clickTimer) {\n      clearTimeout(SceneNavFolders.#clickTimer);\n      SceneNavFolders.#clickTimer = null;\n    }\n\n    LogUtil.log(\"#onActivateScene\", [scene]);\n    scene.activate();\n    SceneNavFolders.refreshFolderView();\n  }\n\n  /**\n   * @private\n   * Handles folder selection\n   * @param {Event} evt - The triggering event\n   */\n  static #onSelectFolder = (evt) => {\n    evt.stopPropagation();\n    evt.preventDefault();\n\n    document.removeEventListener('click', SceneNavFolders.#onOutsideClick);\n    const target = evt.currentTarget;\n    const data = target.dataset;\n    LogUtil.log(\"#onSelectFolder\", [data]);\n    const newFolder = SceneNavFolders.selectFolder(data.folderId || \"\");\n    if(newFolder !== SceneNavFolders.selectedFolder){\n      TopNavigation.navPos = 0;\n    }\n    SceneNavFolders.selectedFolder = newFolder;\n    SceneNavFolders.refreshFolderView();\n  }\n\n  /**\n   * @private\n   * Handles search input changes\n   * @param {Event} evt - The triggering event\n   */\n  static #onSearchInput = (evt) => {\n    evt.stopPropagation();\n    \n    const input = evt.currentTarget;\n    const value = input.value;\n    \n    SceneNavFolders.searchValue = value;\n    SceneNavFolders.updateSearchResults(value);\n  }\n\n  /**\n   * @private\n   * Handles scene selection\n   * @param {Event} evt - The triggering event\n   */\n  static #onItemClick = (evt) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n    let sceneId = evt.currentTarget?.dataset?.sceneId || \"\";\n    let folderId = evt.currentTarget?.dataset?.folderId || \"\";\n\n    if(sceneId){\n      game.scenes.get(sceneId).view();\n    }else if(folderId){\n      SceneNavFolders.selectedFolder = SceneNavFolders.selectFolder(folderId);\n      SceneNavFolders.refreshFolderView();\n    }\n  }\n\n  /**\n   * Determines if the folder view should be hidden based on user permissions and settings\n   * @returns {boolean} True if folder view should be hidden\n   */\n  static noFolderView = () => {\n    const isGM = game?.user?.isGM;\n    return (!isGM && !TopNavigation.navFoldersForPlayers) ||\n      (!TopNavigation.navFoldersEnabled) ||\n      (!TopNavigation.sceneNavEnabled)\n  }\n\n}","import { MODULE_ID } from \"../constants/General.mjs\";\nimport { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettingMenus } from \"../constants/SettingMenus.mjs\";\nimport { BORDER_COLOR_TYPES, getSettings, ICON_SIZES, THEMES } from \"../constants/Settings.mjs\";\nimport { CameraUtil } from \"./CameraUtil.mjs\";\nimport { ChatUtil } from \"./ChatUtil.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { ModuleCompatUtil } from \"./ModuleCompatUtil.mjs\";\nimport { SceneNavFolders } from \"./SceneFoldersUtil.mjs\";\nimport { TopNavigation } from \"./TopNavUtil.mjs\";\n\n/**\n * Core settings management utility for the Carolingian UI module\n * Handles registration, retrieval, and application of module settings\n */\nexport class SettingsUtil {\n  static #uiHidden = false;\n  static firstLoad = true;\n\n  /**\n   * Registers all module settings with Foundry VTT\n   * Initializes settings, registers menus, and sets up hooks for settings changes\n   */\n  static registerSettings(){\n    const SETTINGS = getSettings();\n    LogUtil.log(\"registerSettings - test\", [SETTINGS], true);\n    document.querySelector(\"body\").classList.add(MODULE_ID); \n    \n    /**\n     * Register each of the settings defined in the SETTINGS constant \n     */\n    \n    const settingsList = Object.entries(SETTINGS);\n    settingsList.forEach(async(entry) => {\n      const setting = entry[1]; \n      LogUtil.log(\"Registering... \",[entry], true);\n\n      const settingObj = { \n        name: setting.label,\n        hint: setting.hint,\n        default: setting.default,\n        type: setting.propType,\n        scope: setting.scope,\n        config: setting.config,\n        requiresReload: setting.requiresReload || false,\n        onChange: value => SettingsUtil.apply(setting.tag, value)\n      }\n\n      if(setting.choices){\n        settingObj.choices = setting.choices\n      }\n\n      // @ts-ignore - Valid module ID for settings registration\n      await game.settings.register(MODULE_ID, setting.tag, settingObj);\n\n      if(SettingsUtil.get(setting.tag)===undefined){\n        SettingsUtil.set(setting.tag, setting.default);\n      }\n\n      game.keybindings.register(MODULE_ID, \"hideInterface\", {\n        name: \"Toggle Hide/Show User Interface\",\n        hint: \"Hides or shows the UI. This will affect all elements inside the `#interface` html block\",\n        editable: [\n          {\n            key: \"0\",\n            modifiers: [\"Control\"]\n          }\n        ],\n        onDown: () => {  },\n        onUp: () => { SettingsUtil.hideInterface() },\n        restricted: false,             // Restrict this Keybinding to gamemaster only?\n      });\n\n      // LogUtil.log(\"registerSettings\",[setting.tag, SettingsUtil.get(setting.tag)]);\n    });\n\n    // Apply custom theme and CSS\n    SettingsUtil.applyThemeSettings();\n    SettingsUtil.applyCustomCSS();\n    SettingsUtil.applyModuleAdjustments();\n\n    /**\n     * Register subsetting menus\n     */\n    const settingMenus = Object.entries(getSettingMenus());\n    settingMenus.forEach(async(entry) => {\n      const settingMenu = entry[1]; \n      const settingMenuObj = {\n        name: settingMenu.tag,\n        label: settingMenu.label, \n        hint: settingMenu.hint,\n        icon: settingMenu.icon, \n        type: settingMenu.propType,\n        restricted: settingMenu.restricted\n      }\n      await game.settings.registerMenu(MODULE_ID, settingMenu.tag, settingMenuObj); \n    });\n\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_CONTROLS, SettingsUtil.applyLeftControlsSettings);\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, SettingsUtil.applyPlayersListSettings); \n    Hooks.on(HOOKS_CORE.RENDER_HOTBAR, () => {\n      if(SettingsUtil.firstLoad){\n        SettingsUtil.firstLoad = false;\n        SettingsUtil.applyHotBarCollapse();\n      }\n      SettingsUtil.applyHotBarSettings();\n    });\n    //apply debug Settings\n    SettingsUtil.applyDebugSettings();\n    // apply chat style settings\n    SettingsUtil.applyChatStyles();\n    // aply border colors\n    SettingsUtil.applyBorderColors();\n\n    // apply scene nav settings\n    const sceneNavFields = SETTINGS.sceneNavMenu.fields;\n    sceneNavFields.forEach(fieldName => {\n      SettingsUtil.apply(SETTINGS[fieldName].tag);\n    });\n\n    // apply custom font settings\n    const fontFields = SETTINGS.customFontsMenu.fields;\n    fontFields.forEach(fieldName => {\n      SettingsUtil.applyCustomFonts(SETTINGS[fieldName].tag);\n    });   \n\n    // apply left controls settings\n    const controlFields = SETTINGS.leftControlsMenu.fields;\n    controlFields.forEach(fieldName => {\n      SettingsUtil.applyLeftControlsSettings(SETTINGS[fieldName].tag);\n    }); \n  }\n\n  /**\n   * Retrieve the value of a setting for this module\n   * @param {String} settingName \n   * @param {String} moduleName \n   * @returns {*} // current value of the setting\n   */\n  /**\n   * Retrieves the value of a module setting\n   * @param {string} settingName - Name of the setting to retrieve\n   * @param {string} [moduleName=MODULE_ID] - ID of the module the setting belongs to\n   * @returns {*} Current value of the setting\n   */\n  static get(settingName, moduleName=MODULE_ID){\n    if(!settingName){ return null; }\n\n    let setting = false;\n\n    if(moduleName===MODULE_ID){\n      setting = game.settings.get(moduleName, settingName);\n    }else{\n      const client = game.settings.storage.get(\"client\");\n      let selectedSetting = client[`${moduleName}.${settingName}`];\n      //\n      if(selectedSetting===undefined){\n        const world = game.settings.storage.get(\"world\");\n        selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n      }\n      setting = selectedSetting?.value;\n      LogUtil.log(\"GET Setting\", [selectedSetting, setting]);\n    }\n\n    return setting;\n  }\n  /**\n   * Retrieve the value of a setting for this module\n   * @param {String} settingName \n   * @param {String} moduleName \n   * @returns {*} // current value of the setting\n   */\n  /**\n   * Updates the value of a module setting\n   * @param {string} settingName - Name of the setting to update\n   * @param {*} newValue - New value to set\n   * @param {string} [moduleName=MODULE_ID] - ID of the module the setting belongs to\n   * @returns {boolean} True if setting was updated successfully\n   */\n  static set(settingName, newValue, moduleName=MODULE_ID){ \n    if(!settingName){ return false; }\n\n    let selectedSetting = game.settings.storage.get(\"client\")[`${moduleName}.${settingName}`];\n\n    if(!selectedSetting){\n      const world = game.settings.storage.get(\"world\");\n      selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n    } \n    LogUtil.log(\"Setting\",[settingName, selectedSetting]);\n\n    try{\n      game.settings.set(moduleName, settingName, newValue);\n      // selectedSetting.update({value: newValue});\n    }catch(e){\n      LogUtil.log(\"Unable to change setting\",[settingName, selectedSetting]);\n    }\n\n    return true;\n  }\n\n  /**\n   * Apply current settings\n   */\n  /**\n   * Applies a specific setting based on its tag\n   * @param {string} settingTag - The tag identifying the setting to apply\n   * @param {*} [value] - The value to apply, if not provided uses stored setting\n   */\n  static apply(settingTag, value=undefined){\n    const SETTINGS = getSettings();\n\n    if(value===undefined){\n      value = SettingsUtil.get(settingTag);\n    }\n    LogUtil.log(\"SettingsUtil.apply\",[settingTag, value, SettingsUtil.get(settingTag)]); \n    switch(settingTag){\n      case SETTINGS.enableMacroLayout.tag:\n        SettingsUtil.applyHotBarSettings();\n        break;\n      case SETTINGS.collapseMacroBar.tag:\n        SettingsUtil.applyHotBarCollapse();\n        break;\n      case SETTINGS.autoHidePlayerList.tag:\n        SettingsUtil.applyPlayersListSettings();\n        break;\n      case SETTINGS.uiFontBody.tag:\n      case SETTINGS.uiFontTitles.tag:\n      case SETTINGS.journalFontBody.tag:\n      case SETTINGS.journalFontTitles.tag:\n        SettingsUtil.applyCustomFonts(settingTag, value);\n        break;\n      case SETTINGS.controlsBottomBuffer.tag:\n      case SETTINGS.controlsIconSize.tag:\n      case SETTINGS.controlsAutoHide.tag:\n      case SETTINGS.hideFoundryLogo.tag:\n        SettingsUtil.applyLeftControlsSettings(settingTag, value);\n        break;\n      case SETTINGS.cameraDockMenu.tag: \n        SettingsUtil.applyCameraPosX();\n        SettingsUtil.applyCameraPosY();\n        SettingsUtil.applyCameraWidth();\n        SettingsUtil.applyCameraHeight();\n        break;\n      case SETTINGS.chatBorderColor.tag:\n        ChatUtil.chatBorderColor = SettingsUtil.get(SETTINGS.chatBorderColor.tag);\n        LogUtil.log(\"SettingsUtil.apply\",[settingTag]); \n        SettingsUtil.applyBorderColors();\n        break;\n      case SETTINGS.enableChatStyles.tag:\n        ChatUtil.enableChatStyles = SettingsUtil.get(SETTINGS.enableChatStyles.tag);\n        LogUtil.log(\"SettingsUtil.apply\",[settingTag]);\n        SettingsUtil.applyChatStyles();\n        break;\n      case SETTINGS.enforceDarkMode.tag:\n        SettingsUtil.resetFoundryThemeSettings();\n        break;\n      case SETTINGS.debugMode.tag:\n        SettingsUtil.applyDebugSettings();\n        break;\n      // case SETTINGS.sceneNavMenu.tag:\n      //   TopNavigation.navSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n      //   break;\n      case SETTINGS.sceneNavEnabled.tag:\n        TopNavigation.sceneNavEnabled = value;\n        break;\n      case SETTINGS.navFoldersEnabled.tag:\n        TopNavigation.navFoldersEnabled = value;\n        break;\n      case SETTINGS.navStartCollapsed.tag:\n        TopNavigation.navStartCollapsed = value;\n        break;\n      case SETTINGS.showFolderListOnClick.tag:\n        TopNavigation.showFolderListOnClick = value;\n        SceneNavFolders.refreshFolderView();\n        break;\n      case SETTINGS.showNavOnHover.tag:\n        TopNavigation.showNavOnHover = value;\n        break;\n      case SETTINGS.sceneNavCollapsed.tag:\n        TopNavigation.isCollapsed = SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag);\n        break;\n      case SETTINGS.sceneNavPos.tag:\n        SettingsUtil.applySceneNavPos();\n        break;\n      case SETTINGS.colorTheme.tag:\n        SettingsUtil.applyThemeSettings();\n        break;\n      case SETTINGS.customStyles.tag:\n        SettingsUtil.applyCustomCSS();\n        break;\n      case SETTINGS.adjustOtherModules.tag:\n        SettingsUtil.applyModuleAdjustments();\n        break;\n      default:\n        // do nothing\n    }\n    \n  }\n\n  /**\n   * Applies border color settings to chat messages\n   * Can be based on player color or roll type\n   */\n  static applyBorderColors(){\n    const SETTINGS = getSettings();\n    const borderColorSettings = SettingsUtil.get(SETTINGS.chatBorderColor.tag);\n    const body = document.querySelector(\"body\");\n\n    if(borderColorSettings===BORDER_COLOR_TYPES.playerColor.name){ \n     body.classList.add(\"player-chat-borders\");\n     body.classList.remove(\"roll-chat-borders\"); \n    }else if(borderColorSettings===BORDER_COLOR_TYPES.rollType.name){\n     body.classList.add(\"roll-chat-borders\"); \n     body.classList.remove(\"player-chat-borders\");\n    }else{\n     body.classList.remove(\"player-chat-borders\");\n     body.classList.remove(\"roll-chat-borders\"); \n    }\n  }\n\n  /**\n   * Applies chat message styling settings\n   */\n  static applyChatStyles(){\n    const SETTINGS = getSettings();\n    const chatMsgSettings = SettingsUtil.get(SETTINGS.enableChatStyles.tag);\n    const body = document.querySelector(\"body\");\n\n    LogUtil.log(\"applyChatStyles\", [chatMsgSettings, SETTINGS]);\n\n    if(chatMsgSettings){ \n      body.classList.add(\"crlngn-chat\"); \n    }else{\n      body.classList.remove(\"crlngn-chat\"); \n    }\n  }\n\n  /**\n   * Applies settings for the macro hotbar\n   */\n  static applyHotBarSettings(){\n    const SETTINGS = getSettings();\n    const macroSizeOption = SettingsUtil.get(SETTINGS.enableMacroLayout.tag);\n    const hotbar = document.querySelector(\"#hotbar\");\n\n    if(!macroSizeOption && hotbar){\n      hotbar.classList.add(\"foundry-default\");\n    }else if(hotbar){\n      hotbar.classList.remove(\"foundry-default\");\n    }\n  }\n  /**\n   * Applies collapse state to the macro hotbar\n   * Controls visibility and expansion state of the macro bar\n   */\n  static applyHotBarCollapse(){\n    const SETTINGS = getSettings();\n    const macroCollapseOption = SettingsUtil.get(SETTINGS.collapseMacroBar.tag);\n\n    if(macroCollapseOption){\n      ui.hotbar.collapse();\n    }\n  }\n\n  /**\n   * Applies settings to left controls bar\n   * @param {string} tag - Setting tag to apply\n   * @param {*} value - Value to apply for the setting\n   */\n  static applyLeftControlsSettings(tag, value){\n    const SETTINGS = getSettings();\n    const navEnabled = SettingsUtil.get(SETTINGS.sceneNavEnabled.tag);\n    const controls = document.querySelector(\"#ui-left\");\n    const logo = document.querySelector(\"#ui-left #logo\");\n    const body = document.querySelector('body.crlngn-ui');\n    const bodyStyleElem = document.querySelector('#crlngn-ui-vars');\n\n    LogUtil.log(\"applyLeftControlsSettings\", [tag]);\n\n    switch(tag){\n      case SETTINGS.controlsAutoHide.tag:\n        if(SettingsUtil.get(SETTINGS.controlsAutoHide.tag)){\n          controls.classList.add(\"auto-hide\"); \n        }else{\n          controls.classList.remove(\"auto-hide\"); \n        }\n        break;\n      case SETTINGS.hideFoundryLogo.tag:\n        const bodyStyles = window.getComputedStyle(body);\n        const navHeight = bodyStyles.getPropertyValue('--top-nav-height') || '0px';\n        const topPadding = parseFloat(navHeight) || 0;\n        const hideFoundryLogo = SettingsUtil.get(SETTINGS.hideFoundryLogo.tag);\n        LogUtil.log(\"applyLeftControlsSettings\", [tag, topPadding, navHeight]);\n\n        if(hideFoundryLogo===undefined || hideFoundryLogo===true){\n          logo.classList.remove(\"visible\");\n          GeneralUtil.addCSSVars('--ui-top-padding', `${topPadding}px`);\n          document.querySelector(\"body\").classList.remove('logo-visible');\n        } else {\n          logo.classList.add(\"visible\");\n          if(navEnabled){\n            GeneralUtil.addCSSVars('--ui-top-padding',`${72 + topPadding}px`);\n            document.querySelector(\"body\").classList.add('logo-visible');\n          }else{\n            GeneralUtil.addCSSVars('--ui-top-padding','72px');\n          }\n        }\n        break;\n      case SETTINGS.controlsBottomBuffer.tag:\n        SettingsUtil.applyControlsBuffer();\n        break;\n      case SETTINGS.controlsIconSize.tag:\n        SettingsUtil.applyControlIconSize();\n        break;\n      default:\n        //\n    }\n  }\n\n  /**\n   * Applies size settings for control icons\n   * Updates the size of icons in the left controls panel\n   */\n  static applyControlIconSize(){\n    const SETTINGS = getSettings();\n    const iconSize = SettingsUtil.get(SETTINGS.controlsIconSize.tag);\n    const body = document.querySelector(\"body\");\n    const size = iconSize == ICON_SIZES.small.name ? ICON_SIZES.small.size : ICON_SIZES.regular.size;\n\n    LogUtil.log(\"applyControlIconSize\", [size]);\n    GeneralUtil.addCSSVars('--left-control-item-size', size);\n    SettingsUtil.applyLeftControlsSettings(SETTINGS.hideFoundryLogo.tag);\n  }\n\n  /**\n   * Applies bottom buffer spacing to left controls\n   * Adjusts the spacing at the bottom of the controls panel\n   */\n  static applyControlsBuffer(){\n    const SETTINGS = getSettings();\n    const leftControls = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n    // const root = document.querySelector(\"body.crlngn-ui\");\n    const buffer = isNaN(leftControls.bottomBuffer) ? SETTINGS.leftControlsMenu.default.bottomBuffer : leftControls.bottomBuffer;\n    GeneralUtil.addCSSVars('--controls-bottom-buffer', `${buffer || 0}px`);\n  }\n\n  /**\n   * Applies settings for the players list\n   */\n  static applyPlayersListSettings(){\n    const SETTINGS = getSettings();\n    LogUtil.log(\"applyPlayersListSettings\",[document.querySelector(\"#players\"), SettingsUtil.get(SETTINGS.autoHidePlayerList.tag)]); \n    if(SettingsUtil.get(SETTINGS.autoHidePlayerList.tag)){\n      document.querySelector(\"#players\")?.classList.add(\"auto-hide\");\n    }else{\n      document.querySelector(\"#players\")?.classList.remove(\"auto-hide\");\n    }\n    ModuleCompatUtil.checkPlayersList();\n  }\n\n  /**\n   * Applies scene navigation position settings\n   * @param {number} [value] - Position value to apply, if not provided uses stored setting\n   */\n  static applySceneNavPos(value){\n    const SETTINGS = getSettings();\n    TopNavigation.navPos = value || SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n  }\n\n  /**\n   * Applies horizontal position of camera dock\n   * @param {number} [pos] - X position to apply\n   */\n  static applyCameraPosX(pos){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const xPos = pos || cameraSettings.dockPosX; \n    CameraUtil.resetPositionAndSize({ x: xPos });\n  }\n  /**\n   * Applies vertical position of camera dock\n   * @param {number} [pos] - Y position to apply\n   */\n  static applyCameraPosY(pos){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const yPos = pos || cameraSettings.dockPosY;\n    CameraUtil.resetPositionAndSize({ y: yPos });\n  }\n  /**\n   * Applies width of camera dock\n   * @param {number} [value] - Width value to apply\n   */\n  static applyCameraWidth(value){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const width = value || cameraSettings.dockWidth;\n    CameraUtil.resetPositionAndSize({ w: width });\n  }\n  /**\n   * Applies height of camera dock\n   * @param {number} [value] - Height value to apply\n   */\n  static applyCameraHeight(value){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const height = value || cameraSettings.dockHeight;\n    CameraUtil.resetPositionAndSize({ h: height });\n  }\n\n  /**\n   * Applies custom font settings\n   * @param {string} tag - Font setting tag to apply\n   * @param {string} [value] - Font value to apply\n   */\n  static applyCustomFonts(tag, value){\n    const SETTINGS = getSettings();\n    const fields = SETTINGS.customFontsMenu.fields;\n    const customFonts = {};\n\n    LogUtil.log(\"applyCustomFonts\", [tag, value]);\n    fields.forEach(fieldName => {\n      customFonts[fieldName] = SettingsUtil.get(SETTINGS[fieldName].tag);\n    });\n\n    const body = document.querySelector(\"body.crlngn-ui\");\n    switch(tag){\n      case SETTINGS.uiFontBody.tag:\n        GeneralUtil.addCSSVars('--crlngn-font-family', value || customFonts.uiFontBody || SETTINGS.uiFontBody.default.uiFont || '');\n        break;\n      case SETTINGS.uiFontTitles.tag:\n        GeneralUtil.addCSSVars('--crlngn-font-titles', value || customFonts.uiFontTitles || SETTINGS.uiFontTitles.default.uiTitles || '');\n        break;\n      case SETTINGS.journalFontBody.tag:\n        GeneralUtil.addCSSVars('--crlngn-font-journal-body', value || customFonts.journalFontBody || customFonts.journalFontBody || '');\n        break;\n      case SETTINGS.journalFontTitles.tag:\n        GeneralUtil.addCSSVars('--crlngn-font-journal-title', value || customFonts.journalFontTitles || customFonts.journalFontTitles || '');\n        break;\n      default:\n        //\n    }\n  }\n\n  /**\n   * Resets Foundry's theme settings to defaults\n   * Used when enforcing dark mode or other theme changes\n   */\n  static resetFoundryThemeSettings(){\n    const SETTINGS = getSettings();\n    const isMonksSettingsOn = GeneralUtil.isModuleOn('monks-player-settings');\n    const isForceSettingsOn = GeneralUtil.isModuleOn('force-client-settings');\n    const forceDarkModeOn = SettingsUtil.get(SETTINGS.enforceDarkMode.tag);\n    if(forceDarkModeOn && isMonksSettingsOn){\n      if(game.user.isGM) {\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.monksPlayerSettingsConflict\"), {permanent: true});\n        SettingsUtil.set(SETTINGS.enforceDarkMode.tag, false);\n      }\n      return;\n    }\n    if(forceDarkModeOn && isForceSettingsOn){\n      if(game.user.isGM) {\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.forceClientSettingsConflict\"), {permanent: true});\n        SettingsUtil.set(SETTINGS.enforceDarkMode.tag, false);\n      }\n      return;\n    }\n\n    const foundryColorScheme = game.settings.get('core','colorScheme');\n\n    LogUtil.log(\"resetFoundryThemeSettings\", [foundryColorScheme, forceDarkModeOn])\n\n    if(foundryColorScheme===false && forceDarkModeOn){\n      game.settings.set('core','colorScheme','dark');\n    }\n  }\n\n  /**\n   * Applies debug mode settings\n   * @param {boolean} [value] - Whether to enable debug mode\n   */\n  static applyDebugSettings(value){\n    const SETTINGS = getSettings();\n    LogUtil.debugOn = value || SettingsUtil.get(SETTINGS.debugMode.tag);\n  }\n\n  /**\n   * Applies the selected theme to the UI\n   * @param {string} [value] - Theme name to apply, if not provided uses stored setting\n   */\n  static applyThemeSettings = (value) => {\n    const SETTINGS = getSettings();\n    const themeName = value || SettingsUtil.get(SETTINGS.colorTheme.tag) || \"\";\n    const body = document.querySelector(\"body\");\n\n    LogUtil.log(\"applyThemeSettings\", [value, themeName, SettingsUtil.get(SETTINGS.colorTheme.tag)]);\n    \n    THEMES.forEach((theme)=>{\n      if(theme.className){\n        body.classList.remove(theme.className);\n      }\n    });\n\n    if(themeName){\n      body.classList.add(themeName);\n    }\n  }\n\n  /**\n   * Applies custom CSS styles to the UI\n   * @param {string} [value] - CSS content to apply, if not provided uses stored setting\n   */\n  static applyCustomCSS = (value) => {\n    const SETTINGS = getSettings();\n    const cssContent = value || SettingsUtil.get(SETTINGS.customStyles.tag) || \"\";\n\n    GeneralUtil.addCustomCSS(cssContent);\n  }\n\n  /**\n   * Applies style adjustments to other modules\n   * @param {boolean} [value] - Whether to enforce styles, if not provided uses stored setting\n   */\n  static applyModuleAdjustments = (value) => {\n    const SETTINGS = getSettings();\n    const enforceStyles = value || SettingsUtil.get(SETTINGS.adjustOtherModules.tag) || false;\n    const body = document.querySelector(\"body\");\n\n    if(enforceStyles){\n      body.classList.add('crlngn-enforce-styles');\n    }else{\n      body.classList.remove('crlngn-enforce-styles');\n    }\n  }\n\n  /**\n   * Toggles visibility of the main UI interface\n   * Affects all elements inside the #interface block, camera views, and taskbar\n   */\n  static hideInterface = () => {\n    LogUtil.log('hideInterface');\n    const ui = document.querySelector(\"#interface\");\n    const cameraViews = document.querySelector(\"#camera-views\");\n    const taskbar = document.querySelector(\".taskbar\");\n    \n    if(SettingsUtil.#uiHidden){\n      if(ui) ui.style.removeProperty('visibility');\n      if(ui) cameraViews.style.removeProperty('visibility');\n      if(ui) taskbar.style.removeProperty('visibility');\n      SettingsUtil.#uiHidden = false;\n    }else{\n      if(ui) ui.style.setProperty('visibility', 'hidden');\n      if(cameraViews) cameraViews.style.setProperty('visibility', 'hidden');\n      if(taskbar) taskbar.style.setProperty('visibility', 'hidden');\n      SettingsUtil.#uiHidden = true;\n    }\n    \n  }\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\n\n/**\n * Utility class for managing the players list functionality and appearance\n */\nexport class PlayersListUtil {\n\n  /**\n   * Initializes the players list functionality by setting up event hooks\n   * @static\n   */\n  static init(){\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, PlayersListUtil.onRender); \n  }\n\n  /**\n   * Handles the rendering of the players list\n   * Sets up click listeners for expanding/collapsing the list and updates CSS variables\n   * @static\n   * @private\n   */\n  static onRender(){\n    const playersList = document.querySelector(`aside#players`);\n    const playersTitle = document.querySelector(`aside#players h3:first-child`);\n\n    if(!playersList || !(playersList instanceof HTMLElement) || !playersTitle){return;}\n\n    const playersHeight = playersList.offsetHeight;\n    GeneralUtil.addCSSVars('--players-list-height', playersHeight+'px');\n\n    playersTitle.addEventListener('click', ()=>{\n      if(playersList.classList.contains('expanded')){\n        playersList.classList.remove('expanded');\n      }else{\n        playersList.classList.add('expanded');\n      }\n    });\n  }\n\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\n\n/**\n * Manages the left controls panel UI and its responsive behavior\n */\nexport class LeftControls {\n  /** @type {HTMLElement} @private @static */\n  static #leftControls;\n  /** @type {HTMLElement} @private @static */\n  static #uiLeft;\n  /** @type {ResizeObserver} @private @static */\n  static #resizeObserver;\n\n  /**\n   * Initializes the left controls functionality and sets up event hooks\n   * @static\n   */\n  static init(){\n    LogUtil.log(\"LeftControls - init\", []);\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_CONTROLS, LeftControls.initSceneControls);\n\n    LeftControls.initSceneControls()\n  } \n\n  /**\n   * Resets and updates the local DOM element references\n   * @static\n   * @private\n   */\n  static resetLocalVars(){\n    LeftControls.#leftControls = document.querySelector(\"#ui-left #controls\"); \n    LeftControls.#uiLeft = document.querySelector(\"#ui-left\"); \n  }\n\n  /**\n   * Initializes the scene controls by resetting variables and setting up width observation\n   * @static\n   */\n  static initSceneControls(){\n    LogUtil.log(\"initSceneControls\", [])\n    LeftControls.resetLocalVars();\n    LeftControls.observeControlsWidth();   \n  }\n\n  /**\n   * Sets up a ResizeObserver to monitor changes in the controls width\n   * Implements throttling to limit update frequency\n   * @static\n   * @private\n   */\n  static observeControlsWidth(){\n    LogUtil.log(\"observeControlsWidth\", []);\n    if(!LeftControls.#leftControls){ return; }\n  \n    let timeout;\n    const throttle = (callback, limit) => {\n      if (!timeout) {\n        timeout = setTimeout(() => {\n          callback();\n          timeout = null;\n        }, limit);\n      }\n    };\n  \n    LeftControls.#resizeObserver = new ResizeObserver(entries => {\n      throttle(() => LeftControls.updateCSSVars(), 250);\n    });\n\n    LeftControls.#resizeObserver.observe(LeftControls.#leftControls, {\n      box: 'border-box'\n    });\n    LeftControls.updateCSSVars();\n  }\n\n  /**\n   * Updates CSS variables based on current control panel dimensions\n   * @static\n   * @private\n   */\n  static updateCSSVars() {\n    if(!LeftControls.#leftControls){ return; }\n\n    let leftOffset = Number(LeftControls.#uiLeft.offsetWidth); \n    let controlsWidth = Number(LeftControls.#leftControls.offsetWidth); \n    let controlsMarginLeft = -leftOffset + controlsWidth + 24;\n    LogUtil.log(\"updateCSSVars\", [controlsWidth, leftOffset]);\n\n    if(!isNaN(controlsWidth) && !isNaN(leftOffset)){\n      GeneralUtil.addCSSVars('--ui-controls-margin-left', controlsMarginLeft + 'px');\n    }\n  }\n}\n","import { HOOKS_CORE } from \"../constants/Hooks.mjs\"; \nimport { LogUtil } from \"./LogUtil.mjs\"; \nimport { SettingsUtil } from \"./SettingsUtil.mjs\"; \nimport { TopNavigation } from \"./TopNavUtil.mjs\"; \nimport { ChatUtil } from \"./ChatUtil.mjs\";\nimport { CameraUtil } from \"./CameraUtil.mjs\";\nimport { PlayersListUtil } from \"./PlayersListUtil.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { LeftControls } from \"./LeftControlsUtil.mjs\";\nimport { MODULE_ID } from \"../constants/General.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { ModuleCompatUtil } from \"./ModuleCompatUtil.mjs\";\nimport { SceneNavFolders } from \"./SceneFoldersUtil.mjs\";\n\n/**\n * Main class handling core module initialization and setup\n * Manages module lifecycle, hooks, and core functionality\n */\nexport class Main {\n\n  /**\n   * Initialize the module and set up core hooks\n   * @static\n   */\n  static init(){\n    Hooks.once(HOOKS_CORE.INIT, () => { \n      document.querySelector(\"#ui-middle\")?.classList.add(MODULE_ID);\n\n      LogUtil.log(\"Initiating module...\", [], true); \n\n      Hooks.on(HOOKS_CORE.RENDER_CHAT_MESSAGE, Main.#onRenderChatMessage); \n      SettingsUtil.registerSettings();\n      TopNavigation.init(); \n      CameraUtil.init(); \n      PlayersListUtil.init(); \n      LeftControls.init();\n      ChatUtil.init();\n      SceneNavFolders.registerHooks();\n    });\n\n    Hooks.once(HOOKS_CORE.READY, () => {\n      LogUtil.log(\"Core Ready\", []);\n      const SETTINGS = getSettings();\n      var isDebugOn = SettingsUtil.get(SETTINGS.debugMode.tag);\n      if(isDebugOn){CONFIG.debug.hooks = true};\n\n      ModuleCompatUtil.init();\n      TopNavigation.checkSceneNavCompat();\n\n      const chatStylesEnabled = SettingsUtil.get(SETTINGS.enableChatStyles.tag);\n      if(chatStylesEnabled){ \n        Main.addCSSLocalization();\n      }\n      SettingsUtil.resetFoundryThemeSettings();\n      // SettingsUtil.applyThemeSettings();\n      \n    })\n  }\n\n  // Custom labels for DnD5e buttons, added via CSS\n  /**\n   * Add CSS variables for DnD5e button localization\n   * @static\n   */\n  static addCSSLocalization(){\n    const locBtnPath = 'CRLNGN_UI.dnd5e.chatCard.buttons';\n    \n    GeneralUtil.addCSSVars('--crlngn-i18n-attack', game.i18n.localize(`${locBtnPath}.attack`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-damage', game.i18n.localize(`${locBtnPath}.damage`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-summons', game.i18n.localize(`${locBtnPath}.summons`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-healing', game.i18n.localize(`${locBtnPath}.healing`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-template', game.i18n.localize(`${locBtnPath}.template`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-consume', game.i18n.localize(`${locBtnPath}.consume`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-refund', game.i18n.localize(`${locBtnPath}.refund`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-macro', game.i18n.localize(`${locBtnPath}.macro`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-save-dc', game.i18n.localize(`${locBtnPath}.savedc`));\n    GeneralUtil.addCSSVars('--crlngn-i18n-save', game.i18n.localize(`${locBtnPath}.save`));\n  }\n\n  /**\n   * Handle chat message rendering\n   * @private\n   * @static\n   * @param {ChatMessage} chatMessage - The chat message being rendered\n   * @param {jQuery} html - The HTML element of the chat message\n   */\n  static #onRenderChatMessage = (chatMessage, html) => { \n    LogUtil.log(HOOKS_CORE.RENDER_CHAT_MESSAGE,[chatMessage, html]);\n  \n    ChatUtil.enrichCard(chatMessage, html);\n  }\n\n}\n","import \"./styles/vars.css\";\nimport \"./styles/main.css\";\nimport \"./styles/ui-middle.css\";\nimport \"./styles/ui-top.css\";\nimport \"./styles/ui-right.css\";\nimport \"./styles/ui-left.css\";\nimport \"./styles/ui-bottom.css\";\nimport \"./styles/camera.css\";\nimport \"./styles/chat.css\";\nimport \"./styles/players-list.css\";\nimport \"./styles/other-modules.css\"; \n\nimport { Main } from \"./components/Main.mjs\";\n\nMain.init();"],"names":["HOOKS_CORE","MODULE_ID","DEBUG_TAG","_LogUtil","ref","data","bypassSettings","debugSetting","strRef","options","_a","__publicField","LogUtil","SETTING_INPUT","SETTING_SCOPE","ICON_SIZES","BORDER_COLOR_TYPES","THEMES","getSettings","ApplicationV2","HandlebarsApplicationMixin","_CameraDockSettings_static","onSubmit_fn","onReset_fn","_CameraDockSettings","__privateMethod","SETTINGS","setting","SettingsUtil","partId","context","event","form","formData","controlSettings","isFloating","rawData","settings","a","b","inputs","defaults","inputField","__privateAdd","CameraDockSettings","_ChatMessagesSettings_static","_ChatMessagesSettings","menuValues","fieldNames","fields","fieldValues","fieldDefaults","fieldName","value","currBorderSettings","ChatMessagesSettings","GeneralUtil","moduleName","module","parent","selector","element","offsetTop","elementHeight","offsetParent","foundryFonts","customFontsObj","customFonts","fontFamily","cssImportedFonts","f","varName","varValue","bodyStyle","body","cssText","ruleStart","ruleEnd","declarations","decl","varsMap","parts","name","newRuleContent","newCss","content","customStyle","sheet","href","isFoundryCore","isOurModule","rules","rule","e","importUrlRegex","match","url","familyMatch","family","resolvedUrl","response","fontFaceRules","fontFamilyMatch","fontName","cleanName","_element","_CustomFontsSettings_static","closeAllDropdowns_fn","_CustomFontsSettings","__privateSet","__privateGet","input","wrapper","dropdown","onFocus","isActive","currentIndex","opt","option","CustomFontsSettings","_LeftControlsSettings_static","_LeftControlsSettings","LeftControlsSettings","_SceneNavSettings_static","_SceneNavSettings","navEnabledBefore","foldersEnabledBefore","navEnabledAfter","foldersEnabledAfter","SceneNavSettings","_ThemeAndStyleSettings_static","_ThemeAndStyleSettings","selectedTheme","theme","dropOptions","that","span","i","ThemeAndStyleSettings","getSettingMenus","_offsetX","_offsetY","_startX","_startY","_startWidth","_startHeight","_startBottom","_CameraUtil_static","onDragRelease_fn","onDragMove_fn","onResize_fn","onStopResize_fn","_CameraUtil","cameraSettings","_b","_c","controlsElem","cameraGrid","camControls","existingButtons","controlBar","btnToggle","offsetBottom","resizeHandle","x","y","w","h","savedPosX","savedPosY","savedWidth","savedHeight","left","bottom","newWidth","deltaY","newHeight","newBottom","_d","_e","_f","CameraUtil","_ChatUtil","chatMessage","html","_g","_h","rollType","chatItem","saveButtons","button","visibleDCSpan","hiddenDCSpan","ChatUtil","_checkPlayersTimeout","_ModuleCompatUtil","isTaskbarOn","taskbarFlag","taskbarReduceSidebar","ftMoveStyle","uiLeftPlayers","isPlayersDocked","isMacroDocked","timeoutDelay","hotbar","ModuleCompatUtil","_navElem","_scenesList","_navTimeout","_navExtras","_navToggle","_uiMiddle","_timeout","_collapseTimeout","_navBtnsTimeout","_navFirstLoad","_onNavLast","_onNavNext","_TopNavigation","collapsed","isMonksSceneNavOn","isRipperSceneNavOn","uiMiddle","folderListWidth","isNavOverflowing","btnLast","arrowLeft","btnNext","arrowRight","pos","scenes","position","newMargin","SceneNavFolders","scenePage","nav","toggleWidth","firstScene","itemWidth","currPos","itemsPerPage","newPos","TopNavigation","DEFAULT_FOLDER_ID","_defaultFolderName","_templateData","_folderElement","_customList","_addSceneListeners","_initializeDragDrop","_observeSceneContextMenu","_onOpenList","_onOutsideClick","_clickTimer","_onSelectScene","_onActivateScene","_onSelectFolder","_onSearchInput","_onItemClick","_SceneNavFolders","id","fd","folder","directory","navItem","langPath","optionLabel","fromList","folders","folderList","templatePath","fc","baseData","sc","foldersData","renderedHtml","targetElement","sceneItems","navPos","selectedLink","toggleSpan","subfoldersOl","fi","searchInput","evt","li","isFolder","updates","orderedScenes","el","siblings","updateData","navOrder","density","sort","scene","update","u","searchValue","searchResultsContainer","filteredScenes","filteredFolders","updateContextMenu","contextMenu","menuItems","toggleNavItem","item","contextMenuObserver","mutations","obs","folderElement","isMouseEvent","isHoverMode","target","isSearchResult","newFolder","sceneId","folderId","_uiHidden","_SettingsUtil","entry","settingObj","settingMenu","settingMenuObj","settingName","selectedSetting","newValue","settingTag","borderColorSettings","chatMsgSettings","macroSizeOption","tag","navEnabled","controls","logo","navHeight","topPadding","hideFoundryLogo","iconSize","size","leftControls","buffer","xPos","yPos","width","height","isMonksSettingsOn","isForceSettingsOn","forceDarkModeOn","foundryColorScheme","themeName","cssContent","enforceStyles","ui","cameraViews","taskbar","PlayersListUtil","playersList","playersTitle","playersHeight","_leftControls","_uiLeft","_resizeObserver","_LeftControls","timeout","throttle","callback","limit","entries","leftOffset","controlsWidth","controlsMarginLeft","LeftControls","_onRenderChatMessage","_Main","isDebugOn","locBtnPath","Main"],"mappings":"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"}