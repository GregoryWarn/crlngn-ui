{"version":3,"file":"crlngn-ui.js","sources":["../../src/constants/Hooks.mjs","../../src/constants/General.mjs","../../src/components/LogUtil.mjs","../../src/constants/Settings.mjs","../../src/components/settings-dialogs/CameraDockSettings.mjs","../../src/components/settings-dialogs/ChatMessagesSettings.mjs","../../src/components/GeneralUtil.mjs","../../src/components/settings-dialogs/CustomFontSettings.mjs","../../src/components/settings-dialogs/LeftControlsSettings.mjs","../../src/components/settings-dialogs/SceneNavSettings.mjs","../../src/constants/SettingMenus.mjs","../../src/components/CameraUtil.mjs","../../src/components/ChatUtil.mjs","../../src/components/SettingsUtil.mjs","../../src/components/TopNavUtil.mjs","../../src/components/PlayersListUtil.mjs","../../src/components/LeftControlsUtil.mjs","../../src/components/Main.mjs","../../src/module.mjs"],"sourcesContent":["/**\n * Foundry Core hooks\n * https://foundryvtt.com/api/classes/client.Hooks.html\n * https://foundryvtt.com/api/modules/hookEvents.html\n * */ \nexport const HOOKS_CORE = {\n  INIT: \"init\", \n  READY: \"ready\", \n\n  /* Chat Messages */\n  RENDER_CHAT_MESSAGE: \"renderChatMessage\" ,\n\n  /* Left Side Controls */\n  GET_SCENE_CONTROLS: \"getSceneControlButtons\",\n  RENDER_SCENE_CONTROLS: \"renderSceneControls\",\n  RENDER_PLAYERS_LIST: \"renderPlayerList\",\n\n  /* Scene Navigation*/\n  RENDER_SCENE_NAV: \"renderSceneNavigation\",\n  COLLAPSE_SCENE_NAV: \"collapseSceneNavigation\",\n  EXPAND_SCENE_NAV: \"expandSceneNavigation\",\n\n  /* Right Side Panel */\n  COLLAPSE_SIDE_BAR: \"collapseSidebar\",\n\n  /* Macros */\n  RENDER_HOTBAR: \"renderHotbar\",\n\n  /* Camera Views */\n  RENDER_CAMERA_VIEWS: \"renderCameraViews\"\n}","export const MODULE_ID = \"crlngn-ui\";\nexport const MODULE_TITLE = \"Carolingian UI\";\nexport const MODULE_SHORT = \"crlngn-ui\";\nexport const DEBUG_TAG = [\n  `%cCarolingian UI`,\n  `color:rgb(54, 0, 119); font-weight: bold;`,\n  `|`,\n];\n\nexport const ROLL_TYPES = {\n  abilityCheck: \"ability\",\n  abilitySave: \"save\",\n  attack: \"attack\",\n  check: \"check\",\n  concentration: \"concentration\",\n  damage: \"damage\",\n  deathSave: \"death\",\n  formula: \"formula\",\n  healing: \"heal\",\n  custom: \"roll\",\n  skillCheck: \"skill\",\n  toolCheck: \"tool\"\n}\n\nexport const CHAR_ABILITIES = [\n  { abbrev: \"str\", name: \"strength\" },\n  { abbrev: \"dex\", name: \"dexterity\" },\n  { abbrev: \"con\", name: \"constitution\" },\n  { abbrev: \"int\", name: \"intelligence\" },\n  { abbrev: \"wis\", name: \"wisdom\" },\n  { abbrev: \"cha\", name: \"charisma\" }\n]\n\nexport const CLASS_PREFIX = 'crlngn';","import { DEBUG_TAG } from \"../constants/General.mjs\";\n\nexport class LogUtil {\n  static debugOn = false;\n  /**\n   * Outputs information on console, adding module name and reference\n   * @param {string} ref - Reference information to log after module name\n   * @param {any[]} data - data to log on console\n   */\n  static log(ref=\"\", data=[], bypassSettings=false){\n    try{\n      const debugSetting = LogUtil.debugOn;\n      const isDebugModeOn = bypassSettings || debugSetting;\n      if(!isDebugModeOn){ return };\n\n      console.log(...DEBUG_TAG, ref, ...data);\n    }catch(e){\n      console.log(...DEBUG_TAG, ref, ...data);\n    }\n  }\n\n  /**\n   * Outputs information on console, adding module name and reference\n   * @param {string} ref - Reference information to log after module name\n   * @param {any[]} data - data to log on console\n   */\n  static warn(ref=\"\", data=[]){\n    console.warn(...DEBUG_TAG, ref, ...data);\n  }\n\n  /**\n   * Logs an error on the console and/or ui notification\n   * @param {string} strRef - Reference string for the error. \n   * @param {object} options - \n   */\n  static logError(strRef, options){ // = { ui:false, console:true, permanent:false }) {\n      if(options.ui){\n          // console.log(ui.notifications);\n          ui.notifications?.error(strRef, { localize: true, permanent: options.permanent });\n      }\n      if(options.console) console.error(...DEBUG_TAG, strRef);\n  }\n}\n\n","export const SETTING_INPUT = {\n  select: \"select\", \n  checkbox: \"checkbox\",\n  text: \"text\",\n  number: \"number\"\n}\nexport const SETTING_SCOPE = {\n  client: \"client\",\n  world: \"world\"\n}\n\nexport const ICON_SIZES = {\n  small: { name: 'small', size: '36px'},\n  regular: { name: 'regular', size: '42px'},\n}\n\nexport const BORDER_COLOR_TYPES = {\n  playerColor: { name: 'playerColor'},\n  rollType: { name: 'rollType'},\n  none: {\n    name: 'none'\n  }\n}\n\nexport function getSettings() { \n  return {\n    customFontsMenu: {\n      tag: \"custom-font-families\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.label\"),\n      title: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.hint\"),\n      description: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.description\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: {\n        uiFont: {\n          tag: \"ui-font\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiFont.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiFont.hint\"),\n          inputType: SETTING_INPUT.text\n        },\n        uiTitles: {\n          tag: \"ui-titles\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiTitles.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.uiTitles.hint\"),\n          inputType: SETTING_INPUT.text\n        },\n        journalBody: {\n          tag: \"journal-body\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalBody.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalBody.hint\"),\n          inputType: SETTING_INPUT.text\n        }, \n        journalTitles: {\n          tag: \"journal-title\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalTitles.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.fields.journalTitles.hint\"),\n          inputType: SETTING_INPUT.text\n        }\n      },\n      default: {\n        uiFont: `\"Work Sans\", Arial, sans-serif`,\n        uiTitles: `\"Roboto Slab\", Arial, sans-serif`,\n        journalBody: `\"Work Sans\", Arial, sans-serif`, \n        journalTitles: `\"Roboto Condensed\", Arial, sans-serif`\n      },\n      scope: SETTING_SCOPE.world,\n      config: false, \n      requiresReload: false \n    },\n\n    chatMessagesMenu: {\n      tag: \"chat-messages-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: {\n        enableChatStyles:{\n          tag: \"enable-chat-styles\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enableChatStyles.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enableChatStyles.hint\"), \n          propType: Boolean, \n          inputType: SETTING_INPUT.checkbox,\n        }, \n        borderColor: {\n          tag: \"border-color\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.hint\"),\n          inputType: SETTING_INPUT.select, \n          options: {\n            playerColor: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.playerColor\"), \n            rollType: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.rollType\"), \n            none: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.borderColor.options.none\")\n          }\n        },\n        enforceDarkMode: {\n          restricted: true,\n          tag: \"enforce-dark-mode\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enforceDarkMode.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enforceDarkMode.hint\"), \n          propType: Boolean, \n          inputType: SETTING_INPUT.checkbox\n        }\n      },\n      default: { \n        enableChatStyles: true,\n        borderColor: BORDER_COLOR_TYPES.playerColor.name\n      },\n      scope: SETTING_SCOPE.client,\n      config: false,\n      requiresReload: false\n    },\n\n    leftControlsMenu: {\n      tag: \"left-controls-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: {\n        bottomBuffer:{\n          tag: \"control-bottom-buffer\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.bottomBuffer.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.bottomBuffer.hint\"),\n          inputType: SETTING_INPUT.number\n        }, \n        iconSize: {\n          tag: \"control-icon-size\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.hint\"),\n          inputType: SETTING_INPUT.select, \n          options: {\n            small: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.options.small\"), \n            regular: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.iconSize.options.regular\")\n          }\n        },\n        autoHideSecondary: { \n          tag: \"auto-hide-secondary-controls\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.autoHideSecondary.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.autoHideSecondary.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        },\n        hideFoundryLogo: { \n          tag: \"hide-foundry-logo\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.hideFoundryLogo.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.fields.hideFoundryLogo.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        }\n      },\n      default: { \n        bottomBuffer: 200,\n        iconSize: ICON_SIZES.small.name,\n        autoHideSecondary: false,\n        hideFoundryLogo: true\n      },\n      scope: SETTING_SCOPE.client,\n      config: false,\n      requiresReload: false\n    },\n\n    cameraDockMenu: {\n      tag: \"camera-dock-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: {\n        enableFloatingDock: { \n          tag: \"enable-floating-camera-dock\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.enableFloatingDock.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.enableFloatingDock.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        },\n        dockPosX: {\n          tag: \"camera-dock-x\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosX.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosX.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockPosY: {\n          tag: \"camera-dock-y\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosY.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockPosY.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockWidth: {\n          tag: \"camera-dock-width\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockWidth.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockWidth.hint\"),\n          inputType: SETTING_INPUT.number\n        },\n        dockHeight: {\n          tag: \"camera-dock-height\",\n          label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockHeight.label\"),\n          hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.fields.dockHeight.hint\"),\n          inputType: SETTING_INPUT.number\n        }\n      },\n      default: {\n        enableFloatingDock: true,\n        dockPosX: 0,\n        dockPosY: 120,\n        dockWidth: 140,\n        dockHeight: 140\n      },\n      scope: SETTING_SCOPE.client,\n      config: false, \n      requiresReload: false \n    },\n\n    sceneNavMenu: {\n      tag: \"scene-nav-menu\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.label\"),\n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.hint\"),\n      propType: Object,\n      inputType: SETTING_INPUT.button,\n      fields: {\n        sceneNavEnabled: { \n          tag: \"scene-nav-enabled\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.sceneNavEnabled.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.sceneNavEnabled.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        },\n        showNavOnHover: {\n          tag: \"show-nav-on-hover\", \n          label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showNavOnHover.label\"), \n          hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.fields.showNavOnHover.hint\"), \n          inputType: SETTING_INPUT.checkbox\n        }\n      },\n      default: {\n        sceneNavEnabled: true,\n        showNavOnHover: false\n      },\n      scope: SETTING_SCOPE.client,\n      config: false, \n      requiresReload: true \n    },\n\n    sceneNavCollapsed: { \n      tag: \"scene-nav-collapsed\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavCollapsed.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavCollapsed.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },  \n\n    sceneNavPos: { \n      tag: \"scene-nav-pos\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavPos.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavPos.hint\"), \n      propType: Number, \n      inputType: SETTING_INPUT.number, \n      default: 0, \n      scope: SETTING_SCOPE.client, \n      config: false \n    },\n\n\n\n    /*\n    enableChatStyles: { \n      tag: \"enable-chat-styles\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.enableChatStyles.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.enableChatStyles.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: true \n    },\n    */\n\n    enableMacroLayout: { \n      tag: \"enable-macro-layout\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.enableMacroLayout.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.enableMacroLayout.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    collapseMacroBar: { \n      tag: \"collapse-macro-bar\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.collapseMacroBar.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.collapseMacroBar.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    autoHidePlayerList: { \n      tag: \"auto-hide-player-list\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.autoHidePlayersList.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.autoHidePlayersList.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: true, \n      scope: SETTING_SCOPE.client, \n      config: true, \n      requiresReload: false \n    },\n\n    debugMode: { \n      tag: \"debug-mode\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.debugMode.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.debugMode.hint\"), \n      propType: Boolean,\n      inputType: SETTING_INPUT.checkbox,\n      default: false,\n      scope: SETTING_SCOPE.client,\n      config: true\n    },\n\n    /* non-config settings */\n    enforceDarkMode: { \n      tag: \"enforce-dark-mode\", \n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enforceDarkMode.label\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.fields.enforceDarkMode.hint\"), \n      propType: Boolean, \n      inputType: SETTING_INPUT.checkbox, \n      default: true, \n      scope: SETTING_SCOPE.world, \n      config: false \n    },  \n\n  }\n\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n// import * as lang from '../../lang/en.json' assert { type: 'json' };\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class CameraDockSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    return {\n      id: SETTINGS.cameraDockMenu.tag,\n      actions: {\n        redefine: CameraDockSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: CameraDockSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-camera\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/camera-dock-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    let controlSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    let isFloating = controlSettings.enableFloatingDock;\n    event.preventDefault();\n    event.stopPropagation();\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    await SettingsUtil.set(SETTINGS.cameraDockMenu.tag, settings);\n    controlSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    LogUtil.log(\"Saving settings:\", [SETTINGS.cameraDockMenu.tag, form, formData.object, settings, controlSettings]); // Debugging\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n\n    if(controlSettings.enableFloatingDock != isFloating){\n      location.reload();\n    }\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.cameraDockMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.cameraDockMenu.default]);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const setting = {\n      ...SettingsUtil.get(SETTINGS.cameraDockMenu.tag),\n      default: {\n        ...SETTINGS.cameraDockMenu.default\n      },\n      fields: { ...SETTINGS.cameraDockMenu.fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.cameraDockMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.cameraDockMenu.save\" }\n      ]\n    }\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    LogUtil.log(\"_onRender\", [context, options]);\n  }\n\n\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n// import * as lang from '../../lang/en.json' assert { type: 'json' };\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class ChatMessagesSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n\n    return {\n      id: SETTINGS.chatMessagesMenu.tag,\n      actions: {\n        redefine: ChatMessagesSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: ChatMessagesSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/chat-messages-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n    LogUtil.log(\"Saving settings:\", [ settings ]);\n\n    if(settings.bottomBuffer===undefined || settings.bottomBuffer===''){\n      settings.bottomBuffer = SETTINGS.chatMessagesMenu.default.bottomBuffer;\n    }\n    const currSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n    const currBorderColor = currSettings.borderColor;\n    if(settings.enforceDarkMode === undefined){\n      delete settings.enforceDarkMode;\n    }\n\n    const menuSettings = [];\n    Object.entries(settings).forEach(s => {\n      LogUtil.log(\"menuSettings\",[s]);\n      if(SETTINGS.chatMessagesMenu.default[s[0]]){\n        menuSettings.push(s[1]);\n      }\n    })\n    LogUtil.log(\"menuSettings\",[menuSettings]);\n\n    await SettingsUtil.set(SETTINGS.chatMessagesMenu.tag, settings);\n    await SettingsUtil.set(SETTINGS.enforceDarkMode.tag, settings.enforceDarkMode);\n    const controlSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n\n    LogUtil.log(\"Saving settings:\", [currSettings, settings, controlSettings]); // Debugging\n    if(controlSettings.borderColor !== currBorderColor){\n      location.reload();\n    }\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = {\n      ...SETTINGS.chatMessagesMenu.default,\n      enforceDarkMode: SETTINGS.enforceDarkMode.default\n    };\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [defaults]);\n    // await SettingsUtil.set(SETTINGS.chatMessagesMenu.tag, SETTINGS.chatMessagesMenu.default);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const setting = {\n      ...SettingsUtil.get(SETTINGS.chatMessagesMenu.tag),\n      enforceDarkMode: SettingsUtil.get(SETTINGS.enforceDarkMode.tag),\n      default: {\n        ...SETTINGS.chatMessagesMenu.default,\n        enforceDarkMode: SETTINGS.enforceDarkMode.default || null\n      },\n      isGM: game.user.isGM,\n      fields: { ...SETTINGS.chatMessagesMenu.fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.chatMessagesMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.chatMessagesMenu.save\" }\n      ]\n    }\n    // game.settings.get(\"foo\", \"config\");\n    \n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    const SETTINGS = getSettings();\n    // const html = this.element;\n    // html.querySelector(\"button[type=reset]\").addEventListener(\"click\", ChatMessagesSettings.#onReset);\n\n    const controlSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n\n    LogUtil.log(\"_onRender\", [context, options, controlSettings]);\n  }\n\n\n}\n","import { LogUtil } from \"./LogUtil.mjs\";\n\nexport class GeneralUtil {\n  /**\n   * Checks if module is currently installed and active\n   * @param {string} moduleName \n   * @returns \n   */\n  static isModuleOn(moduleName){\n    const module = game.modules?.get(moduleName);\n    // LogUtil.log(\"isModuleOn\", [module?.active]);\n    return module?.active ? true : false;\n  }\n\n  static html(parent, selector) {\n    return parent.querySelector(selector);\n  }\n\n  static getFullWidth(element) {\n    const style = window.getComputedStyle(element);\n    if (style.width === '0px') {\n      return 0;\n    }\n    return element.offsetWidth;\n  }\n\n  static getOffsetBottom(element) {\n    const offsetTop = element.offsetTop;\n    const elementHeight = element.offsetHeight;\n    const offsetParent = element.offsetParent;\n    const parentHeight = offsetParent ? offsetParent.clientHeight : window.innerHeight;\n  \n    return parentHeight - (offsetTop + elementHeight);\n  }\n\n\n  // Function to get a list with all the fonts available \n  // (Foundry + CSS imported) - excludes Font Awesome\n  static getAllFonts() {\n    // Get Foundry built-in fonts\n    const foundryFonts = new Set(Object.keys(CONFIG.fontDefinitions));\n    LogUtil.log('Foundry built-in fonts:', [Array.from(foundryFonts)]);\n    \n    // Get custom fonts from settings\n    const customFontsObj = game.settings.get(\"core\", \"fonts\") || {};\n    const customFonts = Object.entries(customFontsObj).map(([fontFamily]) => fontFamily);\n    LogUtil.log('Custom fonts from settings:', [customFonts]);\n  \n    // Get CSS imported fonts\n    const cssImportedFonts = new Set();\n    \n    for (const sheet of document.styleSheets) {\n      try {\n        // Handle stylesheet text content for @import rules\n        if (sheet.ownerNode) {\n          let cssText = '';\n          \n          // Get text content from style tags\n          if (sheet.ownerNode.tagName === 'STYLE') {\n            cssText = sheet.ownerNode.textContent;\n          }\n          // Get text content from link tags\n          else if (sheet.ownerNode.tagName === 'LINK') {\n            try {\n              if (sheet.href?.startsWith(window.location.origin)) {\n                const rules = sheet.cssRules || sheet.rules;\n                cssText = Array.from(rules).map(rule => rule.cssText).join('\\n');\n              }\n            } catch (e) {\n              console.warn('Could not read stylesheet rules:', e);\n            }\n          }\n  \n          // Log the found CSS text for debugging\n          LogUtil.log('Processing stylesheet text:', [cssText.slice(0, 200) + '...']);\n  \n          // Extract URLs from @import statements\n          const importUrlRegex = /@import\\s+url\\(['\"]([^'\"]+)['\"]\\)/g;\n          let match;\n          \n          while ((match = importUrlRegex.exec(cssText)) !== null) {\n            const url = match[1]; // This is the actual URL\n            LogUtil.log('Found import URL:', url);\n  \n            if (url.includes('fonts.googleapis.com')) {\n              // Extract font family names from Google Fonts URL\n              const familyMatch = url.match(/family=([^&]+)/);\n              if (familyMatch) {\n                const families = decodeURIComponent(familyMatch[1])\n                  .split('|') // Split multiple families\n                  .map(family => {\n                    // Remove weight/style variations\n                    return family.split(':')[0].replace(/\\+/g, ' ');\n                  });\n                \n                families.forEach(family => {\n                  cssImportedFonts.add(family);\n                  LogUtil.log('Added Google Font family:', family);\n                });\n              }\n            } else {\n              // For non-Google Fonts, try to fetch and parse the CSS\n              try {\n                fetch(url)\n                  .then(response => response.text())\n                  .then(css => {\n                    // Parse font-face rules\n                    const fontFaceRules = css.match(/@font-face\\s*{[^}]+}/g) || [];\n                    fontFaceRules.forEach(rule => {\n                      const fontFamilyMatch = rule.match(/font-family:\\s*['\"]?([^'\";]+)['\"]?/);\n                      if (fontFamilyMatch) {\n                        const fontFamily = fontFamilyMatch[1].trim();\n                        cssImportedFonts.add(fontFamily);\n                        LogUtil.log('Added font family from @font-face:', fontFamily);\n                      }\n                    });\n                  })\n                  .catch(error => console.warn('Error loading imported CSS:', error));\n              } catch (e) {\n                console.warn('Error processing imported CSS:', e);\n              }\n            }\n          }\n        }\n  \n        // Check for @font-face rules in the current stylesheet\n        if (!sheet.href || sheet.href.startsWith(window.location.origin)) {\n          try {\n            const rules = sheet.cssRules || sheet.rules;\n            for (const rule of rules) {\n              if (rule instanceof CSSFontFaceRule) {\n                const fontFamily = rule.style.getPropertyValue('font-family')\n                  .replace(/['\"`]/g, '')\n                  .trim();\n                cssImportedFonts.add(fontFamily);\n                LogUtil.log('Found font-face rule for:', fontFamily);\n              }\n            }\n          } catch (e) {\n            console.warn('Could not read stylesheet rules:', e);\n          }\n        }\n      } catch (e) {\n        console.warn('Error processing stylesheet:', e);\n      }\n    }\n  \n    // Log what we found for debugging\n    LogUtil.log('Found fonts:', [{\n      foundry: Array.from(foundryFonts),\n      custom: customFonts,\n      cssImported: Array.from(cssImportedFonts)\n    }]);\n  \n    // Combine all fonts, filter, clean, sort\n    const allFonts = Array.from(new Set([\n      ...foundryFonts,\n      ...customFonts,\n      ...cssImportedFonts\n    ]))\n    .filter(f => !f.includes(\"FontAwesome\") && !f.includes(\"Font Awesome\") )\n    .map(f => f.replace(/['\"`]/g, '').trim())\n    .sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));\n  \n    return allFonts;\n  }\n\n  // Helper function to format font names\n  static wrapFontName = (fontName) => {\n    const cleanName = fontName.replace(/['\"`]/g, '');\n    return cleanName.includes(' ') ? `\"${cleanName}\"` : cleanName;\n  };\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { GeneralUtil } from \"../GeneralUtil.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { Main } from \"../Main.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class CustomFontsSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static #element;\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n\n    return {\n      id: SETTINGS.customFontsMenu.tag,\n      actions: {\n        redefine: CustomFontsSettings.#onReset,\n      },\n      form: {\n        handler: CustomFontsSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-text\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n        // Add datalists to your content classes\n        contentClasses: [\"standard-form\", \"datalists\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/custom-fonts-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\");\n  }\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n    LogUtil.log(\"Saving settings:\", [settings]); // Debugging\n\n    SettingsUtil.set(SETTINGS.customFontsMenu.tag, settings);\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const current = SettingsUtil.get(SETTINGS.customFontsMenu.tag);\n    const setting = {\n      uiFont: current.uiFont || SETTINGS.customFontsMenu.default.uiFont,\n      uiTitles: current.uiTitles || SETTINGS.customFontsMenu.default.uiTitles,\n      journalBody: current.journalBody || current.journalBodyFont || SETTINGS.customFontsMenu.default.journalBody,\n      journalTitles: current.journalTitles || current.journalTitleFont || SETTINGS.customFontsMenu.default.journalTitles,\n      default: {\n        ...SETTINGS.customFontsMenu.default\n      },\n      fontList: GeneralUtil.getAllFonts(),\n      fields: { \n        ...SETTINGS.customFontsMenu.fields\n      },\n      buttons: [\n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.customFontsMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.customFontsMenu.save\" }\n      ]\n    }\n    // game.settings.get(\"foo\", \"config\");\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    // LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    CustomFontsSettings.#element = this.element;\n    \n    // Handle input focus and blur\n    const inputs = CustomFontsSettings.#element.querySelectorAll('input[type=\"text\"]');\n    inputs.forEach(input => {\n      const wrapper = input.closest('.dropdown-wrapper');\n      const dropdown = wrapper?.querySelector('.dropdown-options');\n      \n      if (!wrapper || !dropdown) return;\n  \n      // Show dropdown on input focus\n      const onFocus = () => {\n        CustomFontsSettings.#closeAllDropdowns();\n        dropdown.classList.add('active');\n      };\n      input.addEventListener('focus', onFocus);\n      input.addEventListener('click', onFocus);\n\n      // Add keyboard navigation\n      input.addEventListener('keydown', (e) => {\n        const isActive = dropdown.classList.contains('active');\n        const options = Array.from(dropdown.querySelectorAll('.dropdown-option'));\n        let currentIndex = options.findIndex(opt => opt.classList.contains('highlighted'));\n        \n        // Handle arrow down/up\n        if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n          e.preventDefault(); // Prevent cursor movement in input\n          \n          if (!isActive) {\n            dropdown.classList.add('active');\n          }\n          \n          // Remove current highlight\n          options.forEach(opt => opt.classList.remove('highlighted'));\n          \n          // Calculate new index\n          if (currentIndex === -1) {\n            currentIndex = e.key === 'ArrowDown' ? 0 : options.length - 1;\n          } else {\n            currentIndex = e.key === 'ArrowDown' \n              ? (currentIndex + 1) % options.length \n              : (currentIndex - 1 + options.length) % options.length;\n          }\n          \n          // Add highlight to new option and scroll into view\n          if (options[currentIndex]) {\n            options[currentIndex].classList.add('highlighted');\n            options[currentIndex].scrollIntoView({ block: 'nearest' });\n          }\n        }\n        \n        // Handle Enter key\n        else if (e.key === 'Enter') {\n          e.preventDefault();\n          \n          if (isActive && currentIndex !== -1 && options[currentIndex]) {\n            // Simulate click on the highlighted option\n            options[currentIndex].click();\n          }\n        }\n        \n        // Handle Escape key\n        else if (e.key === 'Escape') {\n          dropdown.classList.remove('active');\n        }\n      });\n\n      // Handle clicking outside\n      document.addEventListener('click', (e) => {\n        if (!wrapper.contains(e.target)) {\n          dropdown.classList.remove('active');\n        }\n      });\n    });\n  \n    // Handle option selection\n    const dropOptions = CustomFontsSettings.#element.querySelectorAll('.dropdown-option');\n    dropOptions.forEach(option => {\n      // Add mouse hover effect that syncs with keyboard highlighting\n      option.addEventListener('mouseenter', () => {\n        // Remove highlight from all options\n        const allOptions = option.closest('.dropdown-options').querySelectorAll('.dropdown-option');\n        allOptions.forEach(opt => opt.classList.remove('highlighted'));\n        \n        // Add highlight to current option\n        option.classList.add('highlighted');\n      });\n      \n      option.addEventListener('click', (e) => {\n        const input = option.closest('.dropdown-wrapper').querySelector('input');\n        // Get the value and handle potential quote escaping\n        let value = option.dataset.value;\n        LogUtil.log(\"Option clicked:\", [value, option.dataset]); // Debug log\n        \n        // If the value contains spaces but doesn't have quotes, add them\n        if (value.includes(' ') && !value.startsWith('\"')) {\n          value = `\"${value}\"`;\n        }\n        // If the value is already properly quoted, use it as is\n        else if (value.startsWith('&quot;')) {\n          value = value.replace(/&quot;/g, '\"');\n        }\n        \n        input.value = value;\n        option.closest('.dropdown-options').classList.remove('active');\n        \n        // Return focus to input after selection\n        input.focus();\n      });\n    });\n  }\n  \n  static #closeAllDropdowns() {\n    CustomFontsSettings.#element.querySelectorAll('.dropdown-options').forEach(dropdown => {\n      dropdown.classList.remove('active');\n    });\n  }\n  \n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input[type=text]\");\n    const defaults = SETTINGS.customFontsMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n    })\n    \n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.customFontsMenu.default]);\n  }\n\n  \n\n}","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n// import * as lang from '../../lang/en.json' assert { type: 'json' };\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class LeftControlsSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    return {\n      id: SETTINGS.leftControlsMenu.tag,\n      actions: {\n        redefine: LeftControlsSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: LeftControlsSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/left-controls-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings();\n    event.preventDefault();\n    event.stopPropagation();\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    if(settings.bottomBuffer===undefined || settings.bottomBuffer===''){\n      settings.bottomBuffer = SETTINGS.leftControlsMenu.default.bottomBuffer;\n    }\n    const currSettings = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n    if(currSettings.hideFoundryLogo === undefined){\n      settings.hideFoundryLogo = SETTINGS.leftControlsMenu.default.hideFoundryLogo;\n    }\n    await SettingsUtil.set(SETTINGS.leftControlsMenu.tag, settings);\n    const controlSettings = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n\n    LogUtil.log(\"Saving settings:\", [currSettings, settings, controlSettings]); // Debugging\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.leftControlsMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.leftControlsMenu.default]);\n    // await SettingsUtil.set(SETTINGS.leftControlsMenu.tag, SETTINGS.leftControlsMenu.default);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const setting = {\n      ...SettingsUtil.get(SETTINGS.leftControlsMenu.tag),\n      default: {\n        ...SETTINGS.leftControlsMenu.default\n      },\n      fields: { ...SETTINGS.leftControlsMenu.fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.leftControlsMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.leftControlsMenu.save\" }\n      ]\n    }\n    // game.settings.get(\"foo\", \"config\");\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    const SETTINGS = getSettings();\n    // const html = this.element;\n    // html.querySelector(\"button[type=reset]\").addEventListener(\"click\", LeftControlsSettings.#onReset);\n\n    const controlSettings = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n\n    LogUtil.log(\"_onRender\", [context, options, controlSettings]);\n  }\n\n\n}\n","import { getSettings } from \"../../constants/Settings.mjs\";\nimport { LogUtil } from \"../LogUtil.mjs\";\nimport { SettingsUtil } from \"../SettingsUtil.mjs\";\n// import * as lang from '../../lang/en.json' assert { type: 'json' };\n\n/**\n * Classes for Settings Submenus \n */\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class SceneNavSettings extends HandlebarsApplicationMixin(ApplicationV2) {\n  static get DEFAULT_OPTIONS() {\n    const SETTINGS = getSettings();\n    return {\n      id: SETTINGS.sceneNavMenu.tag,\n      actions: {\n        redefine: SceneNavSettings.#onReset,\n      },\n      // classes: [\"standard-form\"],\n      form: {\n        handler: SceneNavSettings.#onSubmit,\n        closeOnSubmit: true,\n      },\n      position: {\n        width: 480,\n        height: \"auto\",\n      },\n      tag: \"form\",\n      window: {\n        icon: \"fas fa-cog\",\n        title: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"),\n        contentClasses: [\"standard-form\", \"crlngn\"],\n        resizable: false\n      }\n    }\n  }\n\n  // Define template parts\n  static PARTS = {\n    content: {\n      template: \"modules/crlngn-ui/templates/scene-nav-settings.hbs\",\n    },\n    footer: {\n      template: \"templates/generic/form-footer.hbs\"\n      // \"templates/generic/custom-fonts-settings-footer.hbs\",\n    },\n  };\n  \n  get title() {\n    return game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\");\n    // return `My Module: ${game.i18n.localize(this.options.window.title)}`;\n  }\n\n\n  /** \n   * Handles form submission and updates FoundryVTT settings.\n   * Uses `foundry.utils.expandObject()` to parse form data.\n   */\n  static async #onSubmit(event, form, formData) {\n    const SETTINGS = getSettings(); \n    let menuSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag); \n    let navEnabled = menuSettings.sceneNavEnabled; \n    event.preventDefault();\n    event.stopPropagation();\n\n    // Convert FormData into an object with proper keys\n    const settings = foundry.utils.expandObject(formData.object);\n\n    await SettingsUtil.set(SETTINGS.sceneNavMenu.tag, settings);\n    menuSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n\n    LogUtil.log(\"Saving settings...\", [SETTINGS.sceneNavMenu.tag, form, formData.object, settings, menuSettings]); // Debugging\n\n    ui.notifications.info(game.i18n.localize('CRLNGN_UI.ui.notifications.settingsUpdated'));\n\n    if(menuSettings.sceneNavEnabled != navEnabled){\n      location.reload();\n    }\n  }\n\n  static async #onReset(a, b){\n    const SETTINGS = getSettings();\n    const html = this.element;\n    const inputs = html.querySelectorAll(\"input, select\");\n    const defaults = SETTINGS.sceneNavMenu.default;\n\n    inputs.forEach(inputField => {\n      inputField.value = defaults[inputField.name];\n      if(inputField.type==='checkbox'){\n        inputField.checked = defaults[inputField.name];\n      }\n    })\n\n    LogUtil.log(\"#onReset\", [a, b, SETTINGS.sceneNavMenu.default]);\n  }\n\n  /**\n   * Prepare context to be sent to handlebars template\n   * @param {*} options \n   * @returns \n   */\n  _prepareContext(options) {\n    const SETTINGS = getSettings();\n    const setting = {\n      ...SettingsUtil.get(SETTINGS.sceneNavMenu.tag),\n      default: {\n        ...SETTINGS.sceneNavMenu.default\n      },\n      fields: { ...SETTINGS.sceneNavMenu.fields },\n      buttons: [ \n        { type: \"button\", icon: \"\", label: \"CRLNGN_UI.settings.sceneNavMenu.reset\", action: 'redefine' },\n        { type: \"submit\", icon: \"\", label: \"CRLNGN_UI.settings.sceneNavMenu.save\" }\n      ]\n    }\n    // game.settings.get(\"foo\", \"config\");\n\n    LogUtil.log(\"_prepareContext\", [setting, options]);\n    return setting;\n  }\n\n  /**\n   * Prepare context that is specific to only a single rendered part.\n   *\n   * It is recommended to augment or mutate the shared context so that downstream methods like _onRender have\n   * visibility into the data that was used for rendering. It is acceptable to return a different context object\n   * rather than mutating the shared context at the expense of this transparency.\n   *\n   * @param {string} partId                         The part being rendered\n   * @param {ApplicationRenderContext} context      Shared context provided by _prepareContext\n   * @returns {Promise<ApplicationRenderContext>}   Context data for a specific part\n   * @protected\n   */\n  async _preparePartContext(partId, context) {\n    context.partId = `${partId}-${this.id}`;\n    LogUtil.log(\"_preparePartContext\",[partId, context]);\n    return context;\n  }\n\n  _onRender(context, options) {\n    LogUtil.log(\"_onRender\", [context, options]);\n  }\n\n\n}\n","// import * as lang from '../lang/en.json';\nimport { CameraDockSettings } from '../components/settings-dialogs/CameraDockSettings.mjs';\nimport { ChatMessagesSettings } from '../components/settings-dialogs/ChatMessagesSettings.mjs';\nimport { CustomFontsSettings } from '../components/settings-dialogs/CustomFontSettings.mjs';\nimport { LeftControlsSettings } from '../components/settings-dialogs/LeftControlsSettings.mjs';\nimport { SceneNavSettings } from '../components/settings-dialogs/SceneNavSettings.mjs';\n// import * as lang from '../lang/en.json' assert { type: \"json\" };\n\nexport function getSettingMenus() {\n  return {\n    customFonts: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.customFontsMenu.hint\"),\n      icon: \"fas fa-text\",  \n      propType: CustomFontsSettings,\n      restricted: true \n    },\n    chatMessagesMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.chatMessagesMenu.hint\"),\n      icon: \"fas fa-cog\",\n      propType: ChatMessagesSettings,\n      restricted: false \n    },\n    leftControls: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.leftControlsMenu.hint\"),\n      icon: \"fas fa-cog\",\n      propType: LeftControlsSettings,\n      restricted: false \n    },\n    cameraDockMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.cameraDockMenu.hint\"),\n      icon: \"fas fa-camera\",  \n      propType: CameraDockSettings,\n      restricted: false \n    },\n    sceneNavMenu: {\n      tag: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.label\"),\n      name: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"),\n      label: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.title\"), \n      hint: game.i18n.localize(\"CRLNGN_UI.settings.sceneNavMenu.hint\"),\n      icon: \"fas fa-cog\",  \n      propType: SceneNavSettings,\n      restricted: false \n    }\n  };\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class CameraUtil {\n  static #offsetX = 0;\n  static #offsetY = 0;\n  static isDragging = false;\n  static cameraContainer;\n  //resizing\n  static isResizing = false;\n  static #startX = 0;\n  static #startY = 0;\n  static #startWidth = 0;\n  static #startHeight = 0;\n  static #startBottom = 0;\n\n  static init(){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    if(cameraSettings.enableFloatingDock){ \n      Hooks.on(HOOKS_CORE.RENDER_CAMERA_VIEWS, CameraUtil.onRenderFloating);\n      LogUtil.log(\"CameraUtil\", [cameraSettings]);\n      CameraUtil.onRenderFloating();\n    }else{ \n      Hooks.on(HOOKS_CORE.RENDER_CAMERA_VIEWS, CameraUtil.onRenderPlain);\n      CameraUtil.onRenderPlain();\n    } \n  }\n\n  static onRenderPlain(){\n    document.querySelector('#camera-views')?.classList.add('visible');\n  }\n\n  static onRenderFloating(){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    document.querySelector('#camera-views')?.classList.add('crlngn-ui');\n    CameraUtil.cameraContainer = document.querySelector('#camera-views .camera-container');\n\n    const controlsElem = document.querySelector('#camera-views .user-controls');\n    const cameraGrid = document.querySelector('#camera-views .camera-grid');\n\n    LogUtil.log(\"CameraUtil.onRender\", [ cameraSettings.dockPosX, cameraSettings.dockPosY ]);\n\n    if(CameraUtil.cameraContainer && cameraGrid && controlsElem){\n      CameraUtil.cameraContainer?.insertBefore(controlsElem, cameraGrid);\n      document.querySelector('#camera-views .camera-container')?.classList.add('visible');\n    }\n    CameraUtil.makeDraggable();\n    CameraUtil.makeResizeable();\n    CameraUtil.resetPositionAndSize();\n    CameraUtil.placeControlsToggle();\n  }\n\n  static placeControlsToggle(){ \n    const camControls = document.querySelector('#camera-views .user-controls');\n    const existingButtons = camControls?.querySelectorAll(\".crlngn-video-toggle\");\n    LogUtil.log(\"placeControlsToggle\", [camControls, existingButtons]);\n\n    if(existingButtons?.length > 0){\n      return; \n    }\n\n    const controlBar = document.querySelector('#camera-views .user-controls .control-bar');\n    const btnToggle = document.createElement(\"button\"); \n    btnToggle.classList.add(\"crlngn-video-toggle\"); \n    btnToggle.innerHTML = '<i class=\"fa fa-play-circle\" aria-hidden=\"true\"></i>';\n\n    camControls?.insertBefore(btnToggle, controlBar);\n  }\n\n  static makeDraggable(){\n    CameraUtil.cameraContainer?.addEventListener(\"mousedown\", (e) => {\n      const body = document.querySelector(\"body.crlngn-ui\");\n      LogUtil.log(\"mousedown\", [ e.target ]);\n      if(e.target.parentNode?.classList.contains('volume-bar')){\n        return;\n      }\n      body?.addEventListener(\"mousemove\", CameraUtil.#onDragMove);\n      body?.addEventListener(\"mouseup\", CameraUtil.#onDragRelease); \n\n      const offsetBottom = GeneralUtil.getOffsetBottom(CameraUtil.cameraContainer);\n      CameraUtil.isDragging = true;\n      CameraUtil.#offsetX = e.clientX - CameraUtil.cameraContainer?.offsetLeft;\n      CameraUtil.#offsetY = (window.innerHeight - e.clientY) - offsetBottom;\n      // CameraUtil.cameraContainer.style.zIndex = \"101\"; \n\n      e.stopPropagation();\n    }); \n\n  }\n\n  static makeResizeable(){\n    if(CameraUtil.cameraContainer){\n      const body = document.querySelector(\"body.crlngn-ui\");\n      const resizeHandle = document.createElement(\"div\");\n      resizeHandle.classList.add(\"resize-handle\");\n      CameraUtil.cameraContainer.append(resizeHandle);\n\n      resizeHandle.addEventListener(\"mousedown\", (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        CameraUtil.isResizing = true;\n    \n        CameraUtil.#startX = e.clientX;\n        CameraUtil.#startY = e.clientY;\n        CameraUtil.#startBottom = parseInt(getComputedStyle(CameraUtil.cameraContainer).bottom) || 0;\n        CameraUtil.#startWidth = CameraUtil.cameraContainer.offsetWidth;\n        CameraUtil.#startHeight = CameraUtil.cameraContainer.offsetHeight;\n    \n        body?.addEventListener(\"mousemove\", CameraUtil.#onResize);\n        body?.addEventListener(\"mouseup\", CameraUtil.#onStopResize);\n      });\n    }\n  }\n\n  static resetPositionAndSize({x, y, w, h} = { x: null, y: null, w: null, h: null }){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n\n    if(!cameraSettings.enableFloatingDock || !CameraUtil.cameraContainer){ return }\n    if(!x && !y && !w && !h){\n      const savedPosX = cameraSettings.dockPosX || 0;\n      const savedPosY = cameraSettings.dockPosY || 0;\n      const savedWidth = cameraSettings.dockWidth || 0;\n      const savedHeight = cameraSettings.dockHeight || 0;\n\n      CameraUtil.cameraContainer.style.left = `${savedPosX}px`;\n      CameraUtil.cameraContainer.style.bottom = `${savedPosY}px`;\n      CameraUtil.cameraContainer.style.width = `${savedWidth}px`;\n      CameraUtil.cameraContainer.style.height = `${savedHeight}px`;\n    }else{\n      if(x){\n        CameraUtil.cameraContainer.style.left = `${x}px`;\n      }\n      if(y){\n        CameraUtil.cameraContainer.style.bottom = `${y}px`;\n      }\n      if(w){\n        CameraUtil.cameraContainer.style.width = `${w}px`;\n      }\n      if(h){\n        CameraUtil.cameraContainer.style.height = `${h}px`;\n      }\n    }\n    \n  }\n\n  // when user releases element\n  static #onDragRelease(e){\n    const SETTINGS = getSettings();\n    const cameraSettings = {...SettingsUtil.get(SETTINGS.cameraDockMenu.tag)};\n\n    if(CameraUtil.isDragging){ \n      const body = document.querySelector(\"body.crlngn-ui\"); \n      cameraSettings.dockPosX = parseInt(CameraUtil.cameraContainer?.style.left) || 0; \n      cameraSettings.dockPosY = parseInt(CameraUtil.cameraContainer?.style.bottom) || 0; \n\n      if(cameraSettings.dockPosY <= 0){ cameraSettings.dockPosY = 0 }\n      SettingsUtil.set(SETTINGS.cameraDockMenu.tag, cameraSettings);\n      \n      body?.removeEventListener(\"mousemove\", CameraUtil.#onDragMove); \n      body?.removeEventListener(\"mouseup\", CameraUtil.#onDragRelease); \n  \n      CameraUtil.isDragging = false; \n      e.stopPropagation(); \n    }\n    \n  } \n\n  // when user drags element\n  static #onDragMove(e){ \n    if (!CameraUtil.isDragging) return; \n    LogUtil.log(\"mousemove\", [ e.target.parentNode ]); \n    \n    if(CameraUtil.cameraContainer){\n      let left = e.clientX - CameraUtil.#offsetX;\n      let bottom = (window.innerHeight - e.clientY) -  CameraUtil.#offsetY;\n\n      if(left + CameraUtil.cameraContainer.offsetWidth > window.innerWidth){  \n        left = window.innerWidth - CameraUtil.cameraContainer.offsetWidt;\n      }\n      CameraUtil.cameraContainer.style.left = `${left}px`;\n\n      if(bottom + CameraUtil.cameraContainer.offsetHeight > window.innerHeight){  \n        bottom = window.innerHeight - CameraUtil.cameraContainer.offsetHeight;\n      } \n      CameraUtil.cameraContainer.style.bottom = `${bottom}px`;\n    }\n    // e.stopPropagation(); \n  } \n\n  // when user drags the resize handle\n  static #onResize(e) {\n    if (!CameraUtil.isResizing) return;\n    const newWidth = CameraUtil.#startWidth + (e.clientX - CameraUtil.#startX);\n    const deltaY = e.clientY - CameraUtil.#startY; // How much the mouse moved\n    const newHeight = CameraUtil.#startHeight + deltaY;\n    const newBottom = CameraUtil.#startBottom - deltaY;\n\n    CameraUtil.cameraContainer.style.width = `${newWidth}px`;\n    CameraUtil.cameraContainer.style.height = `${newHeight}px`;\n    CameraUtil.cameraContainer.style.bottom = `${newBottom}px`;\n  }\n\n  // when user releases the resize handle\n  static #onStopResize() {\n    const SETTINGS = getSettings();\n    const cameraSettings = {...SettingsUtil.get(SETTINGS.cameraDockMenu.tag)};\n\n    const body = document.querySelector(\"body.crlngn-ui\");\n    CameraUtil.isResizing = false;\n    body?.removeEventListener(\"mousemove\", CameraUtil.#onResize);\n    body?.removeEventListener(\"mouseup\", CameraUtil.#onStopResize);\n\n    LogUtil.log(\"onStopResize\", [CameraUtil.cameraContainer?.style.width, CameraUtil.cameraContainer?.style.height, CameraUtil.cameraContainer?.style.bottom]);\n\n    cameraSettings.dockWidth = parseInt(CameraUtil.cameraContainer?.style.width || 0);\n    cameraSettings.dockHeight = parseInt(CameraUtil.cameraContainer?.style.height || 0);\n    cameraSettings.dockPosY = parseInt(CameraUtil.cameraContainer?.style.bottom || 0);\n\n    SettingsUtil.set(SETTINGS.cameraDockMenu.tag, cameraSettings);\n  }\n\n}","import { BORDER_COLOR_TYPES, getSettings } from \"../constants/Settings.mjs\";\nimport \"../styles/chat.css\"\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class ChatUtil {\n  static chatMsgSettings;\n\n  static init(){\n    const SETTINGS = getSettings();\n    ChatUtil.chatMsgSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n  }\n\n  static enrichCard(chatMessage, html){\n    // const SETTINGS = getSettings();\n    const chatSettings = ChatUtil.chatMsgSettings;\n\n    if(chatSettings?.enableChatStyles){ \n      const rollType = chatMessage.flags?.dnd5e?.activity?.type || chatMessage.flags?.dnd5e?.roll?.type || \"custom\";\n      let elem = html.get ? html.get(0) : html;\n\n      // elem.classList.add('crlngn');\n      elem.classList.add(rollType);\n      LogUtil.log(\"enrichCard\", [chatSettings.borderColor, BORDER_COLOR_TYPES.playerColor.name, chatMessage.author?.id]); \n\n      if(chatSettings.borderColor===BORDER_COLOR_TYPES.playerColor.name && chatMessage.author?.id){ \n        elem.style.setProperty('border-color', `var(--user-color-${chatMessage.author.id})`);\n      }\n  \n    }   \n\n  }\n\n}","import { MODULE_ID, MODULE_SHORT } from \"../constants/General.mjs\";\nimport { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettingMenus } from \"../constants/SettingMenus.mjs\";\nimport { BORDER_COLOR_TYPES, getSettings, ICON_SIZES } from \"../constants/Settings.mjs\";\nimport { CameraUtil } from \"./CameraUtil.mjs\";\nimport { ChatUtil } from \"./ChatUtil.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { Main } from \"./Main.mjs\";\n\nexport class SettingsUtil {\n  static firstLoad = true;\n  /**\n   * Registers settings for this module\n   */\n  static registerSettings(){\n    const SETTINGS = getSettings();\n    document.querySelector(\"body\").classList.add(MODULE_ID); \n    /**\n     * Register each of the settings defined in the SETTINGS constant \n     */\n    \n    const settingsList = Object.entries(SETTINGS);\n    settingsList.forEach(async(entry) => {\n      const setting = entry[1]; \n      LogUtil.log(\"Registering... \",[entry]);\n\n      const settingObj = { \n        name: setting.label,\n        hint: setting.hint,\n        default: setting.default,\n        type: setting.propType,\n        scope: setting.scope,\n        config: setting.config,\n        requiresReload: setting.requiresReload || false,\n        onChange: value => SettingsUtil.apply(setting.tag, value)\n      }\n\n      if(setting.choices){\n        settingObj.choices = setting.choices\n      }\n\n      await game.settings.register(MODULE_ID, setting.tag, settingObj);\n\n      if(SettingsUtil.get(setting.tag)===undefined){\n        SettingsUtil.set(setting.tag, setting.default);\n      }\n\n      LogUtil.log(\"registerSettings\",[setting.tag, SettingsUtil.get(setting.tag)]);\n    });\n\n    /**\n     * Register subsetting menus\n     */\n    const settingMenus = Object.entries(getSettingMenus());\n    settingMenus.forEach(async(entry) => {\n      const settingMenu = entry[1]; \n      const settingMenuObj = {\n        name: settingMenu.tag,\n        label: settingMenu.label, \n        hint: settingMenu.hint,\n        icon: settingMenu.icon, \n        type: settingMenu.propType,\n        restricted: settingMenu.restricted\n      }\n      await game.settings.registerMenu(MODULE_ID, settingMenu.tag, settingMenuObj); \n    });\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_CONTROLS, SettingsUtil.applyLeftControlsSettings);\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, SettingsUtil.applyPlayersListSettings); \n    Hooks.on(HOOKS_CORE.RENDER_HOTBAR, () => {\n      if(SettingsUtil.firstLoad){\n        SettingsUtil.firstLoad = false;\n        SettingsUtil.applyHotBarCollapse();\n      }\n      SettingsUtil.applyHotBarSettings();\n    });\n    SettingsUtil.applySceneNavPos();\n    \n    // apply chat style settings\n    SettingsUtil.applyChatStyles();\n    // aply border colors\n    SettingsUtil.applyBorderColors();\n\n    // apply custom font settings\n    SettingsUtil.applyCustomFonts();\n\n    // apply left controls settings\n    SettingsUtil.applyLeftControlsSettings(); \n    SettingsUtil.applyControlIconSize();\n    SettingsUtil.applyControlsBuffer();\n\n    //apply dark mode settings\n    // SettingsUtil.resetFoundryThemeSettings();\n\n    //apply debug Settings\n    SettingsUtil.applyDebugSettings();\n\n  }\n\n  /**\n   * Retrieve the value of a setting for this module\n   * @param {String} settingName \n   * @param {String} moduleName \n   * @returns {*} // current value of the setting\n   */\n  static get(settingName, moduleName=MODULE_ID){\n    if(!settingName){ return null; }\n\n    let setting = false;\n\n    if(moduleName===MODULE_ID){\n      setting = game.settings.get(moduleName, settingName);\n    }else{\n      const client = game.settings.storage.get(\"client\");\n      let selectedSetting = client[`${moduleName}.${settingName}`];\n      //\n      if(selectedSetting===undefined){\n        const world = game.settings.storage.get(\"world\");\n        selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n      }\n      setting = selectedSetting?.value;\n      LogUtil.log(\"GET Setting\", [selectedSetting, setting]);\n    }\n\n    return setting;\n  }\n  /**\n   * Retrieve the value of a setting for this module\n   * @param {String} settingName \n   * @param {String} moduleName \n   * @returns {*} // current value of the setting\n   */\n  static set(settingName, newValue, moduleName=MODULE_ID){ \n    if(!settingName){ return false; }\n\n    let selectedSetting = game.settings.storage.get(\"client\")[`${moduleName}.${settingName}`];\n\n    if(!selectedSetting){\n      const world = game.settings.storage.get(\"world\");\n      selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n    } \n    LogUtil.log(\"Setting\",[settingName, selectedSetting]);\n\n    try{\n      game.settings.set(moduleName, settingName, newValue);\n      // selectedSetting.update({value: newValue});\n    }catch(e){\n      LogUtil.log(\"Unable to change setting\",[settingName, selectedSetting]);\n    }\n\n    return true;\n  }\n\n  /**\n   * Apply current settings\n   */\n  static apply(settingTag, value=undefined){\n    const SETTINGS = getSettings();\n\n    if(value===undefined){\n      value = SettingsUtil.get(settingTag);\n    }\n    LogUtil.log(\"SettingsUtil.apply\",[settingTag, value, SettingsUtil.get(settingTag)]); \n    switch(settingTag){\n      case SETTINGS.enableMacroLayout.tag: \n        SettingsUtil.applyHotBarSettings(); break; \n      case SETTINGS.collapseMacroBar.tag:\n        SettingsUtil.applyHotBarCollapse(); break; \n      case SETTINGS.autoHidePlayerList.tag: \n        SettingsUtil.applyPlayersListSettings(); break;\n      case SETTINGS.customFontsMenu.tag:\n        SettingsUtil.applyCustomFonts(value); break;\n      case SETTINGS.leftControlsMenu.tag:\n        SettingsUtil.applyLeftControlsSettings(); \n        SettingsUtil.applyControlIconSize();\n        SettingsUtil.applyControlsBuffer();\n        break;\n      case SETTINGS.cameraDockMenu.tag: \n        SettingsUtil.applyCameraPosX();\n        SettingsUtil.applyCameraPosY();\n        SettingsUtil.applyCameraWidth();\n        SettingsUtil.applyCameraHeight();\n        break;\n      case SETTINGS.chatMessagesMenu.tag:\n        ChatUtil.chatMsgSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n        SettingsUtil.applyBorderColors();\n        SettingsUtil.applyChatStyles();\n        break;\n      case SETTINGS.enforceDarkMode.tag:\n        SettingsUtil.resetFoundryThemeSettings();\n        break;\n      case SETTINGS.debugMode.tag:\n        SettingsUtil.applyDebugSettings();\n        break;\n      default:\n        // do nothing\n    }\n    \n  }\n\n  static applyBorderColors(){\n    const SETTINGS = getSettings();\n    const chatMsgSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n    if(chatMsgSettings.borderColor===BORDER_COLOR_TYPES.playerColor.name){ \n      document.querySelector(\"body\").classList.add(\"player-chat-borders\");\n      document.querySelector(\"body\").classList.remove(\"roll-chat-borders\"); \n      // document.querySelector(\"body\").classList.remove(\"crlngn-disabled-borders\"); \n    }else if(chatMsgSettings.borderColor===BORDER_COLOR_TYPES.rollType.name){\n      document.querySelector(\"body\").classList.add(\"roll-chat-borders\"); \n      document.querySelector(\"body\").classList.remove(\"player-chat-borders\");\n      // document.querySelector(\"body\").classList.remove(\"crlngn-disabled-borders\"); \n    }else{\n      document.querySelector(\"body\").classList.remove(\"player-chat-borders\");\n      document.querySelector(\"body\").classList.remove(\"roll-chat-borders\"); \n      // document.querySelector(\"body\").classList.add(\"crlngn-disabled-borders\"); \n    }\n  }\n\n  static applyChatStyles(){\n    const SETTINGS = getSettings();\n    const chatMsgSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n    if(chatMsgSettings.enableChatStyles){ \n      document.querySelector(\"body\").classList.add(\"crlngn-chat\"); \n    }\n  }\n\n  static applyHotBarSettings(){\n    const SETTINGS = getSettings();\n    const macroSizeOption = SettingsUtil.get(SETTINGS.enableMacroLayout.tag);\n    const hotbar = document.querySelector(\"#hotbar\");\n\n    if(!macroSizeOption && hotbar){\n      hotbar.classList.add(\"foundry-default\");\n    }else if(hotbar){\n      hotbar.classList.remove(\"foundry-default\");\n    }\n  }\n  static applyHotBarCollapse(){\n    const SETTINGS = getSettings();\n    const macroCollapseOption = SettingsUtil.get(SETTINGS.collapseMacroBar.tag);\n\n    if(macroCollapseOption){\n      ui.hotbar.collapse();\n    }\n  }\n\n  /**\n   * Makes changes to left control auto-hide according to selected settings\n   */\n  static applyLeftControlsSettings(){\n    const SETTINGS = getSettings();\n    const leftControls = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n    const controls = document.querySelector(\"#ui-left\");\n    const logo = document.querySelector(\"#ui-left #logo\");\n\n    if(leftControls.autoHideSecondary){ \n      controls.classList.add(\"auto-hide\"); \n    }else{\n      controls.classList.remove(\"auto-hide\"); \n    }\n\n    if(leftControls.hideFoundryLogo===undefined || leftControls.hideFoundryLogo===true){ \n      logo.classList.remove(\"visible\"); \n    }else{\n      logo.classList.add(\"visible\"); \n    }\n  }\n  /**\n   * Makes changes to size of icons in left controls according to selected settings\n   */\n  static applyControlIconSize(){\n    const SETTINGS = getSettings();\n    const leftControls = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n    const root = document.querySelector(\"body.crlngn-ui\");\n    const size = leftControls.iconSize == ICON_SIZES.small.name ? ICON_SIZES.small.size : ICON_SIZES.regular.size;\n\n    root.style.setProperty('--left-control-item-size', size);\n  }\n\n  /**\n   * Apply bottom buffer to left controls \n   */\n  static applyControlsBuffer(){\n    const SETTINGS = getSettings();\n    const leftControls = SettingsUtil.get(SETTINGS.leftControlsMenu.tag);\n    const root = document.querySelector(\"body.crlngn-ui\");\n    const buffer = isNaN(leftControls.bottomBuffer) ? SETTINGS.leftControlsMenu.default.bottomBuffer : leftControls.bottomBuffer;\n    root.style.setProperty('--controls-bottom-buffer', `${buffer || 0}px`);\n  }\n\n  static applyPlayersListSettings(){\n    const SETTINGS = getSettings();\n    LogUtil.log(\"applyPlayersListSettings\",[document.querySelector(\"#players\"), SettingsUtil.get(SETTINGS.autoHidePlayerList.tag)]); \n    if(SettingsUtil.get(SETTINGS.autoHidePlayerList.tag)){\n      document.querySelector(\"#players\")?.classList.add(\"auto-hide\");\n    }else{\n      document.querySelector(\"#players\")?.classList.remove(\"auto-hide\");\n    }\n  }\n\n  static applySceneNavPos(){\n    const SETTINGS = getSettings();\n    SettingsUtil.set(SETTINGS.sceneNavPos.tag, 0);\n  }\n\n  /**\n   * Apply Camera dock settings\n   */\n  static applyCameraPosX(pos){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const xPos = pos || cameraSettings.dockPosX; \n    CameraUtil.resetPositionAndSize({ x: xPos });\n  }\n  static applyCameraPosY(pos){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const yPos = pos || cameraSettings.dockPosY;\n    CameraUtil.resetPositionAndSize({ y: yPos });\n  }\n  static applyCameraWidth(value){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const width = value || cameraSettings.dockWidth;\n    CameraUtil.resetPositionAndSize({ w: width });\n  }\n  static applyCameraHeight(value){\n    const SETTINGS = getSettings();\n    const cameraSettings = SettingsUtil.get(SETTINGS.cameraDockMenu.tag);\n    const height = value || cameraSettings.dockHeight;\n    CameraUtil.resetPositionAndSize({ h: height });\n  }\n  /*******/\n\n\n  static applyCustomFonts(){\n    const SETTINGS = getSettings();\n    const customFonts = SettingsUtil.get(SETTINGS.customFontsMenu.tag);\n    LogUtil.log(\"applyCustomFonts\", [customFonts]);\n\n    if(customFonts){\n      const root = document.querySelector(\"body.crlngn-ui\");\n      root.style.setProperty('--crlngn-font-family', customFonts.uiFont || SETTINGS.customFontsMenu.default.uiFont || '');\n      root.style.setProperty('--crlngn-font-titles', customFonts.uiTitles || SETTINGS.customFontsMenu.default.uiTitles || '');\n      root.style.setProperty('--crlngn-font-journal-body', customFonts.journalBody || customFonts.journalBodyFont || SETTINGS.customFontsMenu.default.journalBody || '');\n      root.style.setProperty('--crlngn-font-journal-title', customFonts.journalTitles || customFonts.journalTitleFont || SETTINGS.customFontsMenu.default.journalTitles || '');\n    }\n  }\n\n  static resetFoundryThemeSettings(){\n    const SETTINGS = getSettings();\n    const isMonksSettingsOn = GeneralUtil.isModuleOn('monks-player-settings');\n    const isForceSettingsOn = GeneralUtil.isModuleOn('force-client-settings');\n    const forceDarkModeOn = SettingsUtil.get(SETTINGS.enforceDarkMode.tag);\n    if(forceDarkModeOn && isMonksSettingsOn){\n      if(game.user.isGM) {\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.monksPlayerSettingsConflict\"), {permanent: true});\n        SettingsUtil.set(SETTINGS.enforceDarkMode.tag, false);\n      }\n      return;\n    }\n    if(forceDarkModeOn && isForceSettingsOn){\n      if(game.user.isGM) {\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.forceClientSettingsConflict\"), {permanent: true});\n        SettingsUtil.set(SETTINGS.enforceDarkMode.tag, false);\n      }\n      return;\n    }\n\n    const foundryColorScheme = game.settings.get('core','colorScheme');\n\n    LogUtil.log(\"resetFoundryThemeSettings\", [foundryColorScheme, forceDarkModeOn])\n\n    if(!foundryColorScheme && forceDarkModeOn){\n      game.settings.set('core','colorScheme','dark');\n    }\n  }\n\n  static applyDebugSettings(value){\n    const SETTINGS = getSettings();\n    LogUtil.debugOn = value || SettingsUtil.get(SETTINGS.debugMode.tag);\n  }\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { Main } from \"./Main.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class TopNavigation {\n  static #navElem;\n  static #scenesList;\n  static #navTimeout;\n  static #navExtras;\n  static #navToggle;\n  static #settings;\n  static SETTINGS;\n\n  static init(){\n    const SETTINGS = getSettings();\n    TopNavigation.#settings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n\n    // if user disabled Scene Navigation Styles,\n    // skip everything\n    const uiMiddle = document.querySelector(\"#ui-middle\");\n    let navSettings = TopNavigation.#settings;\n    if(navSettings.sceneNavEnabled && uiMiddle){\n      uiMiddle.classList.add(\"crlngn-ui\");\n    }else if(uiMiddle){\n      uiMiddle.classList.remove(\"crlngn-ui\");\n      return;\n    }\n\n    TopNavigation.resetLocalVars();\n\n    // If Monk's Scene Navigation is enabled, disable Carolingian UI Top Navigation\n    const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n    if(isMonksScenenNavOn && navSettings.sceneNavEnabled){\n      if(game.user.isGM){\n        ui.notifications.warn(game.i18n.localize(\"CRLNGN_UI.ui.notifications.monksScenesNotSupported\"), {permanent: true});\n      }\n      uiMiddle.classList.remove(\"crlngn-ui\");\n      SettingsUtil.set(SETTINGS.sceneNavMenu.tag, {\n        ...navSettings,\n        sceneNavEnabled: false\n      });\n    }\n    \n    LogUtil.log(\"TopNavigation - init\", [ isMonksScenenNavOn ]);\n\n    if(!isMonksScenenNavOn){\n      TopNavigation.resetLocalVars();\n      TopNavigation.addListeners(); \n\n      LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, []); \n      \n      TopNavigation.setNavPosition(0);\n      TopNavigation.placeNavButtons(); \n\n      // if(SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)){ \n      //   ui.nav.collapse();\n      // }else{\n      //   ui.nav.expand();\n      // }\n    }\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_NAV, () => { \n      const SETTINGS = getSettings();\n      const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, [ isMonksScenenNavOn ]);\n      \n      if(!isMonksScenenNavOn){\n        TopNavigation.resetLocalVars();\n        LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, []); \n        \n        TopNavigation.placeNavButtons();\n        TopNavigation.setNavPosition();\n        TopNavigation.addListeners();\n        // TopNavigation.observeNavOffset();\n      }\n      \n      // if(SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)){ \n      //   ui.nav.collapse();\n      // }else{\n      //   ui.nav.expand();\n      // }\n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SIDE_BAR, (value) => { \n      const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      LogUtil.log(HOOKS_CORE.COLLAPSE_SIDE_BAR, [\"isMonksScenenNavOn\",isMonksScenenNavOn]);\n      if(!isMonksScenenNavOn){\n        TopNavigation.placeNavButtons(); \n      }\n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SCENE_NAV, (nav, value) => {\n      const SETTINGS = getSettings();\n      // SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, value); \n      LogUtil.log(\"NAV toggle\", [nav, value]); \n    }); \n\n    Hooks.on(HOOKS_CORE.EXPAND_SCENE_NAV, (nav, value) => {\n      const SETTINGS = getSettings();\n      // SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, false); \n      LogUtil.log(\"NAV expand\", [nav, false]); \n    }); \n\n    // SettingsUtil.apply(SETTINGS.sceneNavCollapsed.tag); \n    window.addEventListener('resize', ()=>{\n      const isMonksScenenNavOn = GeneralUtil.isModuleOn(\"monks-scene-navigation\");\n      if(!isMonksScenenNavOn){\n        TopNavigation.placeNavButtons();\n      }\n    });\n\n\n\n    LogUtil.log(\"TopNavigation - init\", [navSettings.sceneNavEnabled])\n    \n    // if(navSettings.sceneNavEnabled){ \n    //   // TopNavigation.observeNavOffset(); \n    // } \n    \n  } \n\n  static resetLocalVars(){\n    TopNavigation.#navElem = document.querySelector(\"#navigation\"); \n    TopNavigation.#scenesList = document.querySelector(\"#scene-list\"); \n    TopNavigation.#navExtras = document.querySelector(\"#navigation .nav-item.is-root\"); \n    TopNavigation.#navToggle = document.querySelector(\"#nav-toggle\"); \n    // TopNavigation.#leftControls = document.querySelector(\"#ui-left #controls\"); \n  }\n\n  static addListeners(){\n    const SETTINGS = getSettings();\n    TopNavigation.#navElem?.addEventListener(\"mouseenter\", ()=>{\n      const sceneNavSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n      if( !SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag) ||\n          !sceneNavSettings?.showNavOnHover ){ \n            return;\n      }\n      clearTimeout(this.#navTimeout);\n\n      const list = document.querySelector(\"#scene-list\");\n      if(list) {list.style.display = \"flex\";}\n      const navigation = document.querySelector(\"#navigation\");\n      navigation.classList.remove(\"collapsed\");\n    });\n\n    this.#navElem?.addEventListener(\"mouseleave\", (e)=>{\n      const sceneNavSettings = SettingsUtil.get(SETTINGS.sceneNavMenu.tag);\n      if( !SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag) ||\n          !sceneNavSettings?.showNavOnHover ){ \n          return;\n      }\n      if (!e) var e = window.event;\n      e.cancelBubble = true;\n      if (e.stopPropagation) e.stopPropagation();\n\n      this.#navTimeout = setTimeout(()=>{\n        clearTimeout(this.#navTimeout);\n        this.#navTimeout = null;\n        const list = document.querySelector(\"#scene-list\");\n        if(list) {list.style.display = \"none\";}\n        const navigation = document.querySelector(\"#navigation\");\n        navigation.classList.add(\"collapsed\");\n      }, 700);\n    });\n  }\n\n  static placeNavButtons(){ \n    TopNavigation.resetLocalVars();\n\n    const existingButtons = this.#navElem?.querySelectorAll(\"button.crlngn-nav\");\n    const isNavOverflowing = this.#scenesList?.scrollWidth >= this.#navElem?.offsetWidth;\n    LogUtil.log(\"placeNavButtons\", [ isNavOverflowing, existingButtons, this.#scenesList?.scrollWidth, this.#navElem?.offsetWidth]);\n    \n    if(!isNavOverflowing || existingButtons.length > 0){\n      return;\n    }\n\n    const btnLast = document.createElement(\"button\"); \n    btnLast.classList.add(\"crlngn-nav\"); \n    btnLast.classList.add(\"ui-nav-left\"); \n    const arrowLeft = document.createElement(\"i\"); \n    arrowLeft.classList.add(\"fa\"); \n    arrowLeft.classList.add(\"fa-chevron-left\"); \n    btnLast.addEventListener(\"click\", this.#onNavLast);\n    btnLast.append(arrowLeft); \n\n    const btnNext = document.createElement(\"button\"); \n    btnNext.classList.add(\"crlngn-nav\"); \n    btnNext.classList.add(\"ui-nav-right\"); \n    const arrowRight = document.createElement(\"i\"); \n    arrowRight.classList.add(\"fa\"); \n    arrowRight.classList.add(\"fa-chevron-right\"); \n    btnNext.append(arrowRight); \n    btnNext.addEventListener(\"click\", this.#onNavNext);\n\n    this.#navElem?.appendChild(btnLast);\n    this.#navElem?.appendChild(btnNext);\n  }\n\n\n  static #onNavLast = (e) => {\n    const SETTINGS = getSettings();\n    const toggleWidth = this.#navToggle?.offsetWidth;\n    const extrasWidth = GeneralUtil.isModuleOn(\"compact-scene-navigation\") ? this.#navExtras?.offsetWidth : 0;\n    const firstScene = this.#scenesList?.querySelector(\"li.nav-item:not(.is-root)\");\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item\") || [];\n    const itemWidth = firstScene.offsetWidth;\n    const currPos = SettingsUtil.get(SETTINGS.sceneNavPos.tag) || 0;\n    const itemsPerPage = Math.floor((this.#navElem?.offsetWidth - (currPos === 0 ? extrasWidth : 0) - (toggleWidth*2))/itemWidth);\n\n    LogUtil.log(\"onNavLast\", [\"currPos\", currPos, itemsPerPage]);\n\n    let newPos = currPos - itemsPerPage;\n    newPos = newPos < 0 ? 0 : newPos;\n\n    LogUtil.log(\"onNavLast\", [\"sceneCount\", scenes.length, currPos, newPos]);\n    TopNavigation.setNavPosition(newPos); \n  }\n\n  static #onNavNext = (e) => {\n    const SETTINGS = getSettings();\n    const toggleWidth = this.#navToggle?.offsetWidth;\n    const extrasWidth = GeneralUtil.isModuleOn(\"compact-scene-navigation\") ? this.#navExtras?.offsetWidth : 0;\n    const firstScene = this.#scenesList?.querySelector(\"li.nav-item:not(.is-root)\");\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item:not(.is-root)\") || [];\n    const itemWidth = firstScene.offsetWidth;\n    const currPos = SettingsUtil.get(SETTINGS.sceneNavPos.tag) || 0;\n    const itemsPerPage = Math.floor((this.#navElem?.offsetWidth - (currPos === 0 ? extrasWidth : 0) - (toggleWidth*2))/itemWidth);\n\n    LogUtil.log(\"onNavLast\", [\"currPos\", currPos, itemsPerPage]);\n\n    let newPos = currPos + itemsPerPage;\n    newPos = newPos > scenes.length ? scenes.length : newPos;\n\n    TopNavigation.setNavPosition(newPos); \n  }\n\n  static setNavPosition(pos) { \n    const SETTINGS = getSettings();\n    if(!this.#scenesList){ return; }\n    const position = pos !== undefined ? pos : SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item\") || [];\n\n    const newMargin = scenes[position]?.offsetLeft * -1;\n    this.#scenesList.style.marginLeft = newMargin + 'px';\n\n    SettingsUtil.set(SETTINGS.sceneNavPos.tag, position);\n\n    LogUtil.log(\"setNavPosition\", [pos, position, scenes[position], newMargin]);\n  }\n\n  /*\n  static observeNavOffset(){\n    LogUtil.log(\"observeNavOffset A\", []);\n    if(!TopNavigation.#navElem || !TopNavigation.#leftControls){ return; }\n    const monksScenenNav = GeneralUtil.isModuleOn('monks-scene-navigation'); \n    // document.querySelector(\"#ui-top .monks-scene-navigation\"); \n\n    function updateCSSVars() {\n      const TopNavigation.#settings = getSettings();\n\n      TopNavigation.#navElem = document.querySelector(\"#navigation\"); \n      if(!TopNavigation.#navElem){ return; }\n\n      const isNavCollapsed = SettingsUtil.get(TopNavigation.#settings.sceneNavCollapsed.tag); \n      // const navHeight = isNavCollapsed ? 0 : TopNavigation.#navElem.offsetHeight;\n\n      // let topOffset = monksScenenNav ? 0 : navHeight + TopNavigation.#navElem.offsetTop;\n      let topOffset = monksScenenNav ? 0 : TopNavigation.#navElem.offsetTop;\n\n      const root = document.querySelector(\"body.crlngn-ui\");\n      root?.style.setProperty('--crlngn-top-offset', topOffset + 'px');\n  \n      LogUtil.log(\"TopNavigation updateCSSVars\", [isNavCollapsed, topOffset, TopNavigation.#navElem.offsetTop, TopNavigation.#navElem.offsetHeight]);\n    }\n\n    // Create a MutationObserver to watch for changes\n    TopNavigation.#observer = new MutationObserver(()=>{\n      throttle(() => TopNavigation.updateCSSVars(), 250);\n    });\n\n    if(!monksScenenNav){\n      TopNavigation.#observer.observe(TopNavigation.#navElem.parentNode, {\n        // attributes: true,\n        // childList: true,\n        // subtree: true,\n        // characterData: true\n        attributes: true,           // attribute changes\n        attributeFilter: ['style'], // Only style attribute changes \n        childList: true,            // child changes\n        subtree: false,             // descendants\n        characterData: false        // text changes\n      });\n    }\n\n    updateCSSVars();\n  }\n  */\n\n  \n}\n\n","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\n\nexport class PlayersListUtil {\n\n  static init(){\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, PlayersListUtil.onRender); \n  }\n\n  static onRender(){\n    const playersList = document.querySelector(`aside#players`);\n    const playersTitle = document.querySelector(`aside#players h3[aria-label=\"Players\"]`);\n\n    const playersHeight = playersList.offsetHeight;\n    const root = document.querySelector(\"body.crlngn-ui\");\n    root.style.setProperty('--players-list-height', playersHeight+'px');\n\n    playersTitle.addEventListener('click', ()=>{\n      if(playersList.classList.contains('expanded')){\n        playersList.classList.remove('expanded');\n      }else{\n        playersList.classList.add('expanded');\n      }\n    })\n\n  }\n\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\n\nexport class LeftControls {\n  static #navElem;\n  static #leftControls;\n  static #uiMiddle;\n  static #uiLeft;\n  static #resizeObserver;\n  static #lastWidth;\n\n  static init(){\n    LogUtil.log(\"LeftControls - init\", []);\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_CONTROLS, LeftControls.initSceneControls);\n\n    LeftControls.initSceneControls()\n  } \n\n  static resetLocalVars(){\n    LeftControls.#navElem = document.querySelector(\"#ui-top #navigation\"); \n    LeftControls.#leftControls = document.querySelector(\"#ui-left #controls\"); \n    LeftControls.#uiMiddle = document.querySelector(\"#ui-middle\"); \n    LeftControls.#uiLeft = document.querySelector(\"#ui-left\"); \n  }\n\n  static initSceneControls(){\n    LogUtil.log(\"initSceneControls\", [])\n    LeftControls.resetLocalVars();\n    LeftControls.observeControlsWidth();   \n  }\n\n  static observeControlsWidth(){\n    LogUtil.log(\"observeControlsWidth\", []);\n    if(!LeftControls.#leftControls){ return; }\n  \n    let timeout;\n    const throttle = (callback, limit) => {\n      if (!timeout) {\n        timeout = setTimeout(() => {\n          callback();\n          timeout = null;\n        }, limit);\n      }\n    };\n  \n    LeftControls.#resizeObserver = new ResizeObserver(entries => {\n      // for (const entry of entries) {\n        // LogUtil.log('ResizeObserver', [{\n        //   contentRectWidth: entry.contentRect.width,\n        //   borderBoxSize: entry.borderBoxSize?.[0]?.inlineSize,\n        //   offsetWidth: entry.target.offsetWidth,\n        //   clientWidth: entry.target.clientWidth,\n        //   boundingWidth: entry.target.getBoundingClientRect().width\n        // }]);\n        /*LeftControls.updateCSSVars();*/\n        throttle(() => LeftControls.updateCSSVars(), 250);\n      //}\n    }, {\n      box: 'border-box'\n    });\n\n    LeftControls.#resizeObserver.observe(LeftControls.#leftControls);\n  \n    LeftControls.updateCSSVars();\n  }\n\n  static updateCSSVars() {\n    // LogUtil.log(\"updateCSSVars\", [LeftControls.#leftControls]);\n    if(!LeftControls.#leftControls){ return; }\n\n    let leftOffset = Number(LeftControls.#uiLeft.offsetWidth); \n    let controlsWidth = Number(LeftControls.#leftControls.offsetWidth); \n    let controlsMarginLeft = -leftOffset + controlsWidth + 24;\n    LogUtil.log(\"updateCSSVars\", [controlsWidth, leftOffset]);\n\n    if(!isNaN(controlsWidth) && !isNaN(leftOffset)){\n      const root = document.querySelector(\"body.crlngn-ui\");\n      root?.style.setProperty('--ui-controls-margin-left', controlsMarginLeft + 'px');\n    }\n    LeftControls.#lastWidth = controlsWidth;\n  }\n\n  \n}\n\n","import { HOOKS_CORE } from \"../constants/Hooks.mjs\"; \nimport { LogUtil } from \"./LogUtil.mjs\"; \nimport { SettingsUtil } from \"./SettingsUtil.mjs\"; \nimport { TopNavigation } from \"./TopNavUtil.mjs\"; \nimport { ChatUtil } from \"./ChatUtil.mjs\";\nimport { CameraUtil } from \"./CameraUtil.mjs\";\nimport { PlayersListUtil } from \"./PlayersListUtil.mjs\";\nimport { getSettings } from \"../constants/Settings.mjs\";\nimport { LeftControls } from \"./LeftControlsUtil.mjs\";\nimport { MODULE_ID } from \"../constants/General.mjs\";\n\nexport class Main {\n  static SETTINGS;\n\n  static init(){\n    Hooks.once(HOOKS_CORE.INIT, () => { \n      document.querySelector(\"#ui-middle\")?.classList.add(MODULE_ID);\n      LogUtil.log(\"Initiating module\", [], true); \n\n      SettingsUtil.registerSettings();\n      Hooks.on(HOOKS_CORE.RENDER_CHAT_MESSAGE, Main.#onRenderChatMessage); \n    });\n\n    Hooks.once(HOOKS_CORE.READY, () => {\n      const SETTINGS = getSettings();\n      var isDebugOn = SettingsUtil.get('debug-mode');\n      if(isDebugOn){CONFIG.debug.hooks = true};\n\n      // Get the array of available font families\n      const availableFonts = CONFIG.fontFamilies || [];\n\n      // If you need the complete font settings including URLs\n      const fontSettings = SettingsUtil.get(\"fonts\", \"core\");\n\n      LogUtil.log(\"Core Ready\", [CONFIG, availableFonts, fontSettings]);\n\n      TopNavigation.init(); \n      CameraUtil.init(); \n      PlayersListUtil.init(); \n      LeftControls.init();\n      ChatUtil.init();\n\n      const chatMsgSettings = SettingsUtil.get(SETTINGS.chatMessagesMenu.tag);\n      if(chatMsgSettings.enableChatStyles){ \n        Main.addCSSLocalization();\n      }\n      SettingsUtil.resetFoundryThemeSettings();\n      \n    })\n  }\n\n  static addCSSLocalization(){\n    const body = document.querySelector('body');\n    const locBtnPath = 'CRLNGN_UI.dnd5e.chatCard.buttons';\n    body.style.setProperty('--crlngn-i18n-attack', game.i18n.localize(`${locBtnPath}.attack`));\n    body.style.setProperty('--crlngn-i18n-damage', game.i18n.localize(`${locBtnPath}.damage`));\n    body.style.setProperty('--crlngn-i18n-summons', game.i18n.localize(`${locBtnPath}.summons`));\n    body.style.setProperty('--crlngn-i18n-healing', game.i18n.localize(`${locBtnPath}.healing`));\n    body.style.setProperty('--crlngn-i18n-template', game.i18n.localize(`${locBtnPath}.template`));\n    body.style.setProperty('--crlngn-i18n-consume', game.i18n.localize(`${locBtnPath}.consume`));\n    body.style.setProperty('--crlngn-i18n-refund', game.i18n.localize(`${locBtnPath}.refund`));\n    body.style.setProperty('--crlngn-i18n-macro', game.i18n.localize(`${locBtnPath}.macro`));\n    body.style.setProperty('--crlngn-i18n-save-dc', game.i18n.localize(`${locBtnPath}.savedc`));\n  }\n\n  static #onRenderChatMessage = (chatMessage, html) => { \n    LogUtil.log(HOOKS_CORE.RENDER_CHAT_MESSAGE,[chatMessage, html]);\n  \n    ChatUtil.enrichCard(chatMessage, html);\n  }\n\n}\n","import \"./styles/vars.css\";\nimport \"./styles/main.css\";\nimport \"./styles/ui-middle.css\";\nimport \"./styles/ui-top.css\";\nimport \"./styles/ui-right.css\";\nimport \"./styles/ui-bottom.css\";\nimport \"./styles/ui-left.css\";\nimport \"./styles/camera.css\";\nimport \"./styles/chat.css\";\nimport \"./styles/players-list.css\";\nimport \"./styles/other-modules.css\"; \n\nimport { Main } from \"./components/Main.mjs\";\n\nMain.init();"],"names":["HOOKS_CORE","MODULE_ID","DEBUG_TAG","_LogUtil","ref","data","bypassSettings","debugSetting","strRef","options","_a","__publicField","LogUtil","SETTING_INPUT","SETTING_SCOPE","ICON_SIZES","BORDER_COLOR_TYPES","getSettings","ApplicationV2","HandlebarsApplicationMixin","_CameraDockSettings_static","onSubmit_fn","onReset_fn","_CameraDockSettings","__privateMethod","SETTINGS","setting","SettingsUtil","partId","context","event","form","formData","controlSettings","isFloating","settings","a","b","inputs","defaults","inputField","__privateAdd","CameraDockSettings","_ChatMessagesSettings_static","_ChatMessagesSettings","currSettings","currBorderColor","menuSettings","s","ChatMessagesSettings","GeneralUtil","moduleName","module","parent","selector","element","offsetTop","elementHeight","offsetParent","foundryFonts","customFontsObj","customFonts","fontFamily","cssImportedFonts","sheet","cssText","rules","rule","e","importUrlRegex","match","url","familyMatch","family","response","css","fontFamilyMatch","error","f","fontName","cleanName","_element","_CustomFontsSettings_static","closeAllDropdowns_fn","_CustomFontsSettings","current","__privateSet","__privateGet","input","wrapper","dropdown","onFocus","isActive","currentIndex","opt","option","value","CustomFontsSettings","_LeftControlsSettings_static","_LeftControlsSettings","LeftControlsSettings","_SceneNavSettings_static","_SceneNavSettings","navEnabled","SceneNavSettings","getSettingMenus","_offsetX","_offsetY","_startX","_startY","_startWidth","_startHeight","_startBottom","_CameraUtil_static","onDragRelease_fn","onDragMove_fn","onResize_fn","onStopResize_fn","_CameraUtil","cameraSettings","_b","_c","controlsElem","cameraGrid","camControls","existingButtons","controlBar","btnToggle","body","offsetBottom","resizeHandle","x","y","w","h","savedPosX","savedPosY","savedWidth","savedHeight","left","bottom","newWidth","deltaY","newHeight","newBottom","_d","_e","_f","CameraUtil","_ChatUtil","chatMessage","html","_g","_h","chatSettings","rollType","elem","ChatUtil","_SettingsUtil","entry","settingObj","settingMenu","settingMenuObj","settingName","selectedSetting","newValue","settingTag","chatMsgSettings","macroSizeOption","hotbar","leftControls","controls","logo","root","size","buffer","pos","xPos","yPos","width","height","isMonksSettingsOn","isForceSettingsOn","forceDarkModeOn","foundryColorScheme","_navElem","_scenesList","_navTimeout","_navExtras","_navToggle","_settings","_onNavLast","_onNavNext","_TopNavigation","uiMiddle","navSettings","isMonksScenenNavOn","nav","sceneNavSettings","list","isNavOverflowing","btnLast","arrowLeft","btnNext","arrowRight","position","scenes","newMargin","toggleWidth","extrasWidth","firstScene","itemWidth","currPos","itemsPerPage","newPos","TopNavigation","PlayersListUtil","playersList","playersTitle","playersHeight","_leftControls","_uiMiddle","_uiLeft","_resizeObserver","_lastWidth","_LeftControls","timeout","throttle","callback","limit","entries","leftOffset","controlsWidth","controlsMarginLeft","LeftControls","_onRenderChatMessage","_Main","isDebugOn","availableFonts","fontSettings","locBtnPath","Main"],"mappings":"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"}