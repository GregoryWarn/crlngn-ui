var O=l=>{throw TypeError(l)};var I=(l,t,e)=>t.has(l)||O("Cannot "+e);var c=(l,t,e)=>(I(l,t,"read from private field"),e?e.call(l):t.get(l)),p=(l,t,e)=>t.has(l)?O("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(l):t.set(l,e),L=(l,t,e,s)=>(I(l,t,"write to private field"),s?s.call(l,e):t.set(l,e),e);const y={CHAT_MESSAGE:"chatMessage",INIT:"init",READY:"ready",PRE_CREATE_CHAT_MESSAGE:"preCreateChatMessage",CREATE_CHAT_MESSAGE:"createChatMessage",RENDER_CHAT_MESSAGE:"renderChatMessage",CREATE_MEASURED_TEMPLATE:"createMeasuredTemplate",REFRESH_MEASURED_TEMPLATE:"refreshMeasuredTemplate",GET_SCENE_CONTROLS:"getSceneControlButtons",RENDER_SCENE_NAV:"renderSceneNavigation",COLLAPSE_SCENE_NAV:"collapseSceneNavigation",EXPAND_SCENE_NAV:"expandSceneNavigation"},N="crlngn-ui",W="crlngn-ui",P=["%cCarolingian UI","color:rgb(54, 0, 119); font-weight: bold;","|"],C={select:"select",checkbox:"checkbox",text:"text"},v={client:"client",world:"world"},g={enableChatStyles:{tag:"enable-chat-styles",label:"Enable styles for chat messages",hint:"(DnD5e only) Adds style modifications to chat cards. When dark mode is selected on Foundry, makes chat cards dark as well.",propType:Boolean,inputType:C.checkbox,default:!0,scope:v.client,config:!0},customFont:{tag:"custom-font",label:"Enable custom fonts",hint:`If you have a custom font loaded on Foundry core, you can type the name here and it will be use throughout the interface. If the custom font doesn't load you haven't typed the right name. Default value: "Work Sans", Arial, sans-serif`,propType:String,inputType:C.text,default:'"Work Sans", Arial, sans-serif',scope:v.client,config:!0,requiresReload:!0},debugMode:{tag:"debug-mode",label:"Debug Mode",hint:"Enable or disable debug messages on browser console",propType:Boolean,inputType:C.checkbox,default:!1,scope:v.client,config:!0},sceneNavCollapsed:{tag:"scene-nav-collapsed",label:"Scene Navigation Collapsed",hint:"Current state of the scene navigation toggle. Is it collapsed?",propType:Boolean,inputType:C.checkbox,default:!0,scope:v.client,config:!1},sceneNavPos:{tag:"scene-nav-pos",label:"Scene Navigation Position",hint:"Stores current position of navigation for reset when it's re-rendered",propType:Number,inputType:C.number,default:0,scope:v.client,config:!1}};class o{static registerSettings(){document.querySelector("body").classList.add(W),Object.entries(g).forEach(async e=>{const s=e[1];r.log("Registering... ",[e]),await game.settings.register(N,s.tag,{name:s.label,hint:s.hint,default:s.default,type:s.propType,scope:s.scope,config:s.config,requiresReload:s.requiresReload||!1,onChange:a=>o.apply(s.tag,a)}),o.get(s.tag)===void 0&&o.set(s.tag,s.default),o.get(g.enableChatStyles.tag)&&document.querySelector("body").classList.add("crlngn-chat");const n=o.get(g.customFont.tag);n&&document.querySelector("body.crlngn-ui").style.setProperty("--crlngn-font-family",n),r.log("registerSettings",[s.tag,o.get(s.tag)])})}static get(t,e=N){if(!t)return null;let s=!1;if(e===N)s=game.settings.get(e,t);else{let a=game.settings.storage.get("client")[`${e}.${t}`];a===void 0&&(a=game.settings.storage.get("world").getSetting(`${e}.${t}`)),s=a==null?void 0:a.value,r.log("GET Setting",[a,s])}return s}static set(t,e,s=N){if(!t)return!1;let n=game.settings.storage.get("client")[`${s}.${t}`];n||(n=game.settings.storage.get("world").getSetting(`${s}.${t}`)),r.log("Setting",[t,n]);try{game.settings.set(s,t,e)}catch{r.log("Unable to change setting",[t,n])}return!0}static apply(t,e=void 0){e===void 0&&(e=o.get(t)),r.log("SettingsUtil.apply",[t,e,o.get(t)])}static applySettings(){Object.entries(g).forEach(e=>{const s=e[1];let n=o.get(s.tag);o.apply(s.tag,n)})}}class r{static log(t="",e=[],s=!1){try{const n=o.get(g.debugMode.tag);if(!(s||n))return;console.log(...P,t,...e)}catch{console.log(...P,t,...e)}}static warn(t="",e=[]){console.warn(...P,t,...e)}static logError(t,e){var s;e.ui&&((s=ui.notifications)==null||s.error(t,{localize:!0,permanent:e.permanent})),e.console&&console.error(...P,t)}}var h,d,E,A,k;const i=class i{static init(){Hooks.on(y.RENDER_SCENE_NAV,(t,e,s)=>{i.addListeners(),r.log(y.RENDER_SCENE_NAV,[ui.nav,o.get(g.sceneNavCollapsed.tag)]),i.setNavPosition(),i.placeNavButtons(),o.get(g.sceneNavCollapsed.tag)?ui.nav.collapse():ui.nav.expand()}),Hooks.on(y.COLLAPSE_SCENE_NAV,(t,e)=>{o.set(g.sceneNavCollapsed.tag,e),r.log("NAV toggle",[t,e])}),Hooks.on(y.EXPAND_SCENE_NAV,(t,e)=>{o.set(g.sceneNavCollapsed.tag,!1),r.log("NAV expand",[t,!1])}),o.apply(g.sceneNavCollapsed.tag)}static addListeners(){L(this,h,document.querySelector("#navigation")),L(this,d,document.querySelector("#scene-list")),c(this,h).addEventListener("mouseenter",()=>{clearTimeout(c(this,E)),ui.nav.expand()}),c(this,h).addEventListener("mouseleave",e=>{if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),L(this,E,setTimeout(()=>{clearTimeout(c(this,E)),L(this,E,null),ui.nav.collapse()},700))})}static placeNavButtons(){const t=document.createElement("button");t.classList.add("crlngn"),t.classList.add("ui-nav-left");const e=document.createElement("i");e.classList.add("fa"),e.classList.add("fa-chevron-left"),t.addEventListener("click",c(this,A)),t.append(e);const s=document.createElement("button");s.classList.add("crlngn"),s.classList.add("ui-nav-right");const n=document.createElement("i");n.classList.add("fa"),n.classList.add("fa-chevron-right"),s.append(n),s.addEventListener("click",c(this,k)),c(this,h).appendChild(t),c(this,h).appendChild(s)}static setNavPosition(t){var n;const e=t||o.get(g.sceneNavPos.tag),s=(n=c(this,d))==null?void 0:n.querySelector("li:first-child");s.style.marginLeft=e+"px"}};h=new WeakMap,d=new WeakMap,E=new WeakMap,A=new WeakMap,k=new WeakMap,p(i,h),p(i,d),p(i,E),p(i,A,t=>{var S,b;const e=(S=c(i,d))==null?void 0:S.querySelector("li:first-child"),s=e.offsetWidth,n=Math.floor(((b=c(i,d))==null?void 0:b.offsetWidth)/s),a=parseInt(e.style.marginLeft||0);let u=0;if(a<0){const m=Number(a+s*n);u=m<0?m:0}o.set(g.sceneNavPos.tag,u),i.setNavPosition(u),r.log("onNavLast",[n,s,a,u])}),p(i,k,t=>{var S,b,m,R,T,x;const e=(S=c(i,d))==null?void 0:S.querySelector("li:first-child"),s=e.offsetWidth,n=Math.floor(((b=c(i,d))==null?void 0:b.offsetWidth)/s),a=parseInt(e.style.marginLeft||0);let u=0;if(r.log("onNavNext",[e.style.marginLeft,a]),((m=c(i,d))==null?void 0:m.scrollWidth)+a>((R=c(i,d))==null?void 0:R.offsetWidth)){const D=Number(a-s*n),M=-(((T=c(i,d))==null?void 0:T.offsetWidth)-s);u=D>M?D:M}o.set(g.sceneNavPos.tag,u),i.setNavPosition(u),r.log("onNavNext",[n,s,a,u,(x=c(i,d))==null?void 0:x.offsetWidth])});let w=i;class f{static init(){Hooks.once(y.INIT,()=>{r.log("Initiating module",[],!0),o.registerSettings()}),Hooks.once(y.READY,()=>{w.init();var t=o.get("debug-mode");t&&(CONFIG.debug.hooks=!0),r.log("Core Ready",[])})}static setupKeyListeners(){window.addEventListener("keydown",t=>{const e=t.key;f.keysPressed.indexOf(e)<0&&f.keysPressed.push(e),r.log("Keydown",[f.keysPressed])}),window.addEventListener("keyup",t=>{const e=t.key,s=f.keysPressed.indexOf(e);s>=0&&f.keysPressed.splice(s,1),r.log("Keyup",[f.keysPressed])})}}f.init();
//# sourceMappingURL=module.js.map
