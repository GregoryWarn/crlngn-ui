var O=l=>{throw TypeError(l)};var I=(l,t,e)=>t.has(l)||O("Cannot "+e);var c=(l,t,e)=>(I(l,t,"read from private field"),e?e.call(l):t.get(l)),p=(l,t,e)=>t.has(l)?O("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(l):t.set(l,e),C=(l,t,e,s)=>(I(l,t,"write to private field"),s?s.call(l,e):t.set(l,e),e);const y={CHAT_MESSAGE:"chatMessage",INIT:"init",READY:"ready",PRE_CREATE_CHAT_MESSAGE:"preCreateChatMessage",CREATE_CHAT_MESSAGE:"createChatMessage",RENDER_CHAT_MESSAGE:"renderChatMessage",CREATE_MEASURED_TEMPLATE:"createMeasuredTemplate",REFRESH_MEASURED_TEMPLATE:"refreshMeasuredTemplate",GET_SCENE_CONTROLS:"getSceneControlButtons",RENDER_SCENE_NAV:"renderSceneNavigation",COLLAPSE_SCENE_NAV:"collapseSceneNavigation",EXPAND_SCENE_NAV:"expandSceneNavigation"},m="crlngn-ui",G="crlngn-ui",v=["%cCarolingian UI","color:rgb(54, 0, 119); font-weight: bold;","|"],N={select:"select",checkbox:"checkbox"},P={client:"client",world:"world"},g={enableChatStyles:{tag:"enable-chat-styles",label:"Enable styles for chat messages (DnD5e only)",hint:"Adds style modifications to chat cards. When dark mode is selected on Foundry, makes chat cards dark as well.",propType:Boolean,inputType:N.checkbox,default:!0,scope:P.client,config:!0},debugMode:{tag:"debug-mode",label:"Debug Mode",hint:"Enable or disable debug messages on browser console",propType:Boolean,inputType:N.checkbox,default:!1,scope:P.client,config:!0},sceneNavCollapsed:{tag:"scene-nav-collapsed",label:"Scene Navigation Collapsed",hint:"Current state of the scene navigation toggle. Is it collapsed?",propType:Boolean,inputType:N.checkbox,default:!0,scope:P.client,config:!1},sceneNavPos:{tag:"scene-nav-pos",label:"Scene Navigation Position",hint:"Stores current position of navigation for reset when it's re-rendered",propType:Number,inputType:N.number,default:0,scope:P.client,config:!1}};class o{static registerSettings(){document.querySelector("body").classList.add(G),Object.entries(g).forEach(async e=>{const s=e[1];r.log("Registering... ",[e]),await game.settings.register(m,s.tag,{name:s.label,hint:s.hint,default:s.default,type:s.propType,scope:s.scope,config:s.config,onChange:n=>o.apply(s.tag,n)}),o.get(s.tag)===void 0&&o.set(s.tag,s.default),o.get(g.enableChatStyles.tag)&&document.querySelector("body").classList.add("crlngn-chat"),r.log("registerSettings",[s.tag,o.get(s.tag)])})}static get(t,e=m){if(!t)return null;let s=!1;if(e===m)s=game.settings.get(e,t);else{let i=game.settings.storage.get("client")[`${e}.${t}`];i===void 0&&(i=game.settings.storage.get("world").getSetting(`${e}.${t}`)),s=i==null?void 0:i.value,r.log("GET Setting",[i,s])}return s}static set(t,e,s=m){if(!t)return!1;let n=game.settings.storage.get("client")[`${s}.${t}`];n||(n=game.settings.storage.get("world").getSetting(`${s}.${t}`)),r.log("Setting",[t,n]);try{game.settings.set(s,t,e)}catch{r.log("Unable to change setting",[t,n])}return!0}static apply(t,e=void 0){e===void 0&&(e=o.get(t)),r.log("SettingsUtil.apply",[t,e,o.get(t)])}static applySettings(){Object.entries(g).forEach(e=>{const s=e[1];let n=o.get(s.tag);o.apply(s.tag,n)})}}class r{static log(t="",e=[],s=!1){try{const n=o.get(g.debugMode.tag);if(!(s||n))return;console.log(...v,t,...e)}catch{console.log(...v,t,...e)}}static warn(t="",e=[]){console.warn(...v,t,...e)}static logError(t,e){var s;e.ui&&((s=ui.notifications)==null||s.error(t,{localize:!0,permanent:e.permanent})),e.console&&console.error(...v,t)}}var E,d,h,A,w;const a=class a{static init(){Hooks.on(y.RENDER_SCENE_NAV,(t,e,s)=>{a.addListeners(),r.log(y.RENDER_SCENE_NAV,[ui.nav,o.get(g.sceneNavCollapsed.tag)]),a.setNavPosition(),a.placeNavButtons(),o.get(g.sceneNavCollapsed.tag)?ui.nav.collapse():ui.nav.expand()}),Hooks.on(y.COLLAPSE_SCENE_NAV,(t,e)=>{o.set(g.sceneNavCollapsed.tag,e),r.log("NAV toggle",[t,e])}),Hooks.on(y.EXPAND_SCENE_NAV,(t,e)=>{o.set(g.sceneNavCollapsed.tag,!1),r.log("NAV expand",[t,!1])}),o.apply(g.sceneNavCollapsed.tag)}static addListeners(){C(this,E,document.querySelector("#navigation")),C(this,d,document.querySelector("#scene-list")),c(this,E).addEventListener("mouseenter",()=>{clearTimeout(c(this,h)),ui.nav.expand()}),c(this,E).addEventListener("mouseleave",e=>{if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),C(this,h,setTimeout(()=>{clearTimeout(c(this,h)),C(this,h,null),ui.nav.collapse()},500))})}static placeNavButtons(){const t=document.createElement("button");t.classList.add("crlngn"),t.classList.add("ui-nav-left");const e=document.createElement("i");e.classList.add("fa"),e.classList.add("fa-chevron-left"),t.addEventListener("click",c(this,A)),t.append(e);const s=document.createElement("button");s.classList.add("crlngn"),s.classList.add("ui-nav-right");const n=document.createElement("i");n.classList.add("fa"),n.classList.add("fa-chevron-right"),s.append(n),s.addEventListener("click",c(this,w)),c(this,E).appendChild(t),c(this,E).appendChild(s)}static setNavPosition(t){var n;const e=t||o.get(g.sceneNavPos.tag),s=(n=c(this,d))==null?void 0:n.querySelector("li:first-child");s.style.marginLeft=e+"px"}};E=new WeakMap,d=new WeakMap,h=new WeakMap,A=new WeakMap,w=new WeakMap,p(a,E),p(a,d),p(a,h),p(a,A,t=>{var S,b;const e=(S=c(a,d))==null?void 0:S.querySelector("li:first-child"),s=e.offsetWidth,n=Math.floor(((b=c(a,d))==null?void 0:b.offsetWidth)/s),i=parseInt(e.style.marginLeft||0);let u=0;if(i<0){const L=Number(i+s*n);u=L<0?L:0}o.set(g.sceneNavPos.tag,u),a.setNavPosition(u),r.log("onNavLast",[n,s,i,u])}),p(a,w,t=>{var S,b,L,R,T,M;const e=(S=c(a,d))==null?void 0:S.querySelector("li:first-child"),s=e.offsetWidth,n=Math.floor(((b=c(a,d))==null?void 0:b.offsetWidth)/s),i=parseInt(e.style.marginLeft||0);let u=0;if(r.log("onNavNext",[e.style.marginLeft,i]),((L=c(a,d))==null?void 0:L.scrollWidth)+i>((R=c(a,d))==null?void 0:R.offsetWidth)){const D=Number(i-s*n),x=-(((T=c(a,d))==null?void 0:T.offsetWidth)-s);u=D>x?D:x}o.set(g.sceneNavPos.tag,u),a.setNavPosition(u),r.log("onNavNext",[n,s,i,u,(M=c(a,d))==null?void 0:M.offsetWidth])});let k=a;class f{static init(){Hooks.once(y.INIT,()=>{r.log("Initiating module",[],!0),o.registerSettings()}),Hooks.once(y.READY,()=>{k.init();var t=o.get("debug-mode");t&&(CONFIG.debug.hooks=!0),r.log("Core Ready",[])})}static setupKeyListeners(){window.addEventListener("keydown",t=>{const e=t.key;f.keysPressed.indexOf(e)<0&&f.keysPressed.push(e),r.log("Keydown",[f.keysPressed])}),window.addEventListener("keyup",t=>{const e=t.key,s=f.keysPressed.indexOf(e);s>=0&&f.keysPressed.splice(s,1),r.log("Keyup",[f.keysPressed])})}}f.init();
//# sourceMappingURL=module.js.map
