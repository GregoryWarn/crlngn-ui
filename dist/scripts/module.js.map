{"version":3,"file":"module.js","sources":["../../src/constants/Hooks.mjs","../../src/constants/General.mjs","../../src/constants/Settings.mjs","../../src/components/SettingsUtil.mjs","../../src/components/LogUtil.mjs","../../src/components/GeneralUtil.mjs","../../src/components/TopNavUtil.mjs","../../src/components/ChatUtil.mjs","../../src/components/CameraUtil.mjs","../../src/components/PlayersListUtil.mjs","../../src/components/Main.mjs","../../src/module.mjs"],"sourcesContent":["/**\n * Foundry Core hooks\n * https://foundryvtt.com/api/classes/client.Hooks.html\n * https://foundryvtt.com/api/modules/hookEvents.html\n * */ \nexport const HOOKS_CORE = {\n  INIT: \"init\", \n  READY: \"ready\", \n\n  /* Chat Messages */\n  RENDER_CHAT_MESSAGE: \"renderChatMessage\" ,\n\n  /* Left Side Controls */\n  GET_SCENE_CONTROLS: \"getSceneControlButtons\",\n  RENDER_SCENE_CONTROLS: \"renderSceneControls\",\n  RENDER_PLAYERS_LIST: \"renderPlayerList\",\n\n  /* Scene Navigation*/\n  RENDER_SCENE_NAV: \"renderSceneNavigation\",\n  COLLAPSE_SCENE_NAV: \"collapseSceneNavigation\",\n  EXPAND_SCENE_NAV: \"expandSceneNavigation\",\n\n  /* Right Side Panel */\n  COLLAPSE_SIDE_BAR: \"collapseSidebar\",\n\n  /* Macros */\n  RENDER_HOTBAR: \"renderHotbar\",\n\n  /* Camera Views */\n  RENDER_CAMERA_VIEWS: \"renderCameraViews\"\n}","export const MODULE_ID = \"crlngn-ui\";\nexport const MODULE_TITLE = \"Carolingian UI\";\nexport const MODULE_SHORT = \"crlngn-ui\";\nexport const DEBUG_TAG = [\n  `%cCarolingian UI`,\n  `color:rgb(54, 0, 119); font-weight: bold;`,\n  `|`,\n];\n\nexport const ROLL_TYPES = {\n  abilityCheck: \"ability\",\n  abilitySave: \"save\",\n  attack: \"attack\",\n  check: \"check\",\n  concentration: \"concentration\",\n  damage: \"damage\",\n  deathSave: \"death\",\n  formula: \"formula\",\n  healing: \"heal\",\n  custom: \"roll\",\n  skillCheck: \"skill\",\n  toolCheck: \"tool\"\n}\n\nexport const CHAR_ABILITIES = [\n  { abbrev: \"str\", name: \"strength\" },\n  { abbrev: \"dex\", name: \"dexterity\" },\n  { abbrev: \"con\", name: \"constitution\" },\n  { abbrev: \"int\", name: \"intelligence\" },\n  { abbrev: \"wis\", name: \"wisdom\" },\n  { abbrev: \"cha\", name: \"charisma\" }\n]\n\nexport const CLASS_PREFIX = 'crlngn';","export const SETTING_INPUT = {\n  select: \"select\", \n  checkbox: \"checkbox\",\n  text: \"text\",\n  number: \"number\"\n}\nexport const SETTING_SCOPE = {\n  client: \"client\",\n  world: \"world\"\n}\n\nexport const SETTINGS = { \n\n  enableChatStyles: { \n    tag: \"enable-chat-styles\", \n    label: \"Enable styles for chat messages\", \n    hint: \"Adds style modifications to chat cards. When dark mode is selected on Foundry, makes chat cards dark as well. MOSTLY FOR DND5E - only partial support for other systems.\", \n    propType: Boolean, \n    inputType: SETTING_INPUT.checkbox, \n    default: true, \n    scope: SETTING_SCOPE.client, \n    config: true, \n    requiresReload: true \n  }, \n\n  customFont: { \n    tag: \"custom-font\", \n    label: \"Custom fonts\", \n    hint: \"You can type the name of custom fonts loaded on Foundry core and they will be used throughout the interface. Names with spaces must be written with double quotes (\\\"Font Name\\\"). If the font doesn't load you haven't typed the name correctly, or the font was not found. Default value: \"+`\"Work Sans\", Arial, sans-serif`, \n    propType: String, \n    inputType: SETTING_INPUT.text, \n    default: `\"Work Sans\", \"Roboto\", Arial, sans-serif`, \n    scope: SETTING_SCOPE.client, \n    config: true, \n    requiresReload: true \n  }, \n\n  debugMode: { \n    tag: \"debug-mode\", \n    label: \"Debug Mode\",\n    hint: \"Enable or disable debug messages on browser console\",\n    propType: Boolean,\n    inputType: SETTING_INPUT.checkbox,\n    default: false,\n    scope: SETTING_SCOPE.client,\n    config: true\n  },\n\n  sceneNavCollapsed: { \n    tag: \"scene-nav-collapsed\", \n    label: \"Scene Navigation Collapsed\", \n    hint: \"Current state of the scene navigation toggle. Is it collapsed?\", \n    propType: Boolean, \n    inputType: SETTING_INPUT.checkbox, \n    default: true, \n    scope: SETTING_SCOPE.client, \n    config: false \n  },\n\n  sceneNavDisabled: { \n    tag: \"scene-nav-disabled\", \n    label: \"Disable Scene Nav Styles\", \n    hint: \"If you are having layout issues with a non-compatible module, you can disable my custom styles for Scene Navigation.\", \n    propType: Boolean, \n    inputType: SETTING_INPUT.checkbox, \n    default: false, \n    scope: SETTING_SCOPE.client, \n    config: true, \n    requiresReload: true \n  },\n\n  sceneNavPos: { \n    tag: \"scene-nav-pos\", \n    label: \"Scene Navigation Position\", \n    hint: \"Stores current position of navigation for reset when it's re-rendered\", \n    propType: Number, \n    inputType: SETTING_INPUT.number, \n    default: 0, \n    scope: SETTING_SCOPE.client, \n    config: false \n  },\n\n  enableMacroLayout: { \n    tag: \"enable-macro-layout\", \n    label: \"Enable macro resize\", \n    hint: \"The module reduces the size of macro slots on the hotbar, and enlarges the numbers. Disable this setting to use default Foundry layout.\", \n    propType: Boolean,\n    inputType: SETTING_INPUT.checkbox,\n    default: true, \n    scope: SETTING_SCOPE.client, \n    config: true, \n    requiresReload: false \n  },\n\n  showSceneNavOnHover: { \n    tag: \"show-scene-nav-on-hover\", \n    label: \"Show scene list on hover\", \n    hint: \"If the scene navigation is collapsed, you can show it by hovering the mouse over the top of screen.\", \n    propType: Boolean,\n    inputType: SETTING_INPUT.checkbox,\n    default: true, \n    scope: SETTING_SCOPE.client, \n    config: true, \n    requiresReload: false \n  },\n\n  autoHideLeftControls: { \n    tag: \"auto-hide-secondary-controls\", \n    label: \"Auto hide secondary controls\", \n    hint: \"Enable to keep the secondary bar on the left controls hidden unless you hover on the region or click on an item\", \n    propType: Boolean,\n    inputType: SETTING_INPUT.checkbox,\n    default: true, \n    scope: SETTING_SCOPE.client, \n    config: true, \n    requiresReload: false \n  },\n\n  autoHidePlayerList: { \n    tag: \"auto-hide-player-list\", \n    label: \"Auto hide player list\", \n    hint: \"Enable to keep the bottom left players list minimized, except when hovered\", \n    propType: Boolean,\n    inputType: SETTING_INPUT.checkbox,\n    default: true, \n    scope: SETTING_SCOPE.client, \n    config: true, \n    requiresReload: false \n  },\n\n  enableCameraStyles: {\n    tag: \"enable-camera-styles\", \n    label: \"Enable camera styles\", \n    hint: \"Apply UI styling for video players when Video sharing is enabled on Foundry\", \n    propType: Boolean,\n    inputType: SETTING_INPUT.checkbox,\n    default: true, \n    scope: SETTING_SCOPE.world, \n    config: true, \n    requiresReload: true \n  },\n\n  cameraDockPosX: { \n    tag: \"camera-dock-pos-x\", \n    label: \"Horizontal position of camera dock\", \n    hint: \"Position of camera dock on X axis when not minimized, from left. In absolute pixels. \", \n    propType: Number, \n    inputType: SETTING_INPUT.number, \n    default: 0, \n    scope: SETTING_SCOPE.client, \n    config: false \n  },\n\n  cameraDockPosY: { \n    tag: \"camera-dock-pos-y\", \n    label: \"Vertical position of camera dock\", \n    hint: \"Position of camera dock on Y axis when not minimized, from bottom. In absolute pixels. \", \n    propType: Number, \n    inputType: SETTING_INPUT.number, \n    default: 100, \n    scope: SETTING_SCOPE.client, \n    config: false \n  },\n}","import { MODULE_ID, MODULE_SHORT } from \"../constants/General.mjs\";\nimport { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { SETTINGS } from \"../constants/Settings.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\n\nexport class SettingsUtil {\n    /**\n     * Registers settings for this module\n     */\n    static registerSettings(){\n      document.querySelector(\"body\").classList.add(MODULE_SHORT); \n      \n      /**\n       * Register each of the settings defined in the SETTINGS constant \n       */\n      const settingsList = Object.entries(SETTINGS);\n      settingsList.forEach(async(entry) => {\n        const setting = entry[1]; \n        LogUtil.log(\"Registering... \",[entry]);\n\n        const settingObj = { \n          name: setting.label,\n          hint: setting.hint,\n          default: setting.default,\n          type: setting.propType,\n          scope: setting.scope,\n          config: setting.config,\n          requiresReload: setting.requiresReload || false,\n          onChange: value => SettingsUtil.apply(setting.tag, value)\n        }\n\n        await game.settings.register(MODULE_ID, setting.tag, settingObj);\n\n        if(SettingsUtil.get(setting.tag)===undefined){\n          SettingsUtil.set(setting.tag, setting.default);\n        }\n\n        LogUtil.log(\"registerSettings\",[setting.tag, SettingsUtil.get(setting.tag)]);\n      });\n\n      Hooks.on(HOOKS_CORE.RENDER_SCENE_CONTROLS, SettingsUtil.applyLeftControlsSettings);\n      Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, SettingsUtil.applyPlayersListSettings); \n      Hooks.on(HOOKS_CORE.RENDER_HOTBAR, SettingsUtil.applyHotBarSettings);\n      SettingsUtil.applySceneNavSettings();\n      \n      // apply chat style settings\n      if(SettingsUtil.get(SETTINGS.enableChatStyles.tag)){ \n        document.querySelector(\"body\").classList.add(\"crlngn-chat\"); \n      }\n\n      // apply custom font settings\n      const customFont = SettingsUtil.get(SETTINGS.customFont.tag);\n      if(customFont){\n        const root = document.querySelector(\"body.crlngn-ui\");\n        root.style.setProperty('--crlngn-font-family', customFont);\n      }\n    }\n\n    /**\n     * Retrieve the value of a setting for this module\n     * @param {String} settingName \n     * @param {String} moduleName \n     * @returns {*} // current value of the setting\n     */\n    static get(settingName, moduleName=MODULE_ID){\n      if(!settingName){ return null; }\n\n      let setting = false;\n\n      if(moduleName===MODULE_ID){\n        setting = game.settings.get(moduleName, settingName);\n      }else{\n        const client = game.settings.storage.get(\"client\");\n        let selectedSetting = client[`${moduleName}.${settingName}`];\n        //\n        if(selectedSetting===undefined){\n          const world = game.settings.storage.get(\"world\");\n          selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n        }\n        setting = selectedSetting?.value;\n        LogUtil.log(\"GET Setting\", [selectedSetting, setting]);\n      }\n\n      return setting;\n    }\n    /**\n     * Retrieve the value of a setting for this module\n     * @param {String} settingName \n     * @param {String} moduleName \n     * @returns {*} // current value of the setting\n     */\n    static set(settingName, newValue, moduleName=MODULE_ID){ \n      if(!settingName){ return false; }\n\n      let selectedSetting = game.settings.storage.get(\"client\")[`${moduleName}.${settingName}`];\n\n      if(!selectedSetting){\n        const world = game.settings.storage.get(\"world\");\n        selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n      } \n      LogUtil.log(\"Setting\",[settingName, selectedSetting]);\n\n      try{\n        game.settings.set(moduleName, settingName, newValue);\n        // selectedSetting.update({value: newValue});\n      }catch(e){\n        LogUtil.log(\"Unable to change setting\",[settingName, selectedSetting]);\n      }\n\n      return true;\n    }\n\n    /**\n     * Apply current settings\n     */\n    static apply(settingTag, value=undefined){\n\n      if(value===undefined){\n        value = SettingsUtil.get(settingTag);\n      }\n      LogUtil.log(\"SettingsUtil.apply\",[settingTag, value, SettingsUtil.get(settingTag)]); \n      switch(settingTag){\n        case SETTINGS.enableMacroLayout.tag:\n          SettingsUtil.applyHotBarSettings(); break;\n        case SETTINGS.autoHideLeftControls.tag:\n          SettingsUtil.applyLeftControlsSettings(); break;\n        case SETTINGS.autoHidePlayerList.tag:\n          SettingsUtil.applyPlayersListSettings(); break;\n        default:\n          // do nothing\n      }\n      \n    }\n\n\n    static applySettings(){\n      // const settingsList = Object.entries(SETTINGS);\n      // settingsList.forEach((entry) => {\n      //   const setting = entry[1]; \n      //   let currSetting = SettingsUtil.get(setting.tag);\n      //   SettingsUtil.apply(setting.tag, currSetting);\n      // });\n    }\n\n    static applyHotBarSettings(){\n      const macroSizeOption = SettingsUtil.get(SETTINGS.enableMacroLayout.tag);\n      const uiBottom = document.querySelector(\"#hotbar\");\n\n      if(!macroSizeOption){\n        uiBottom.classList.add(\"foundry-default\");\n      }else{\n        uiBottom.classList.remove(\"foundry-default\");\n      }\n    }\n\n    static applyLeftControlsSettings(){\n      const controlsAutoHide = SettingsUtil.get(SETTINGS.autoHideLeftControls.tag);\n      const controls = document.querySelector(\"#ui-left\");\n\n      if(controlsAutoHide){\n        controls.classList.add(\"auto-hide\");\n      }else{\n        controls.classList.remove(\"auto-hide\");\n      }\n    }\n\n    static applyPlayersListSettings(){\n      LogUtil.log(\"applyPlayersListSettings\",[document.querySelector(\"#players\"), SettingsUtil.get(SETTINGS.autoHidePlayerList.tag)]); \n      if(SettingsUtil.get(SETTINGS.autoHidePlayerList.tag)){\n        document.querySelector(\"#players\")?.classList.add(\"auto-hide\");\n      }else{\n        document.querySelector(\"#players\")?.classList.remove(\"auto-hide\");\n      }\n    }\n\n    static applySceneNavSettings(){\n      SettingsUtil.set(SETTINGS.sceneNavPos.tag, 0);\n    }\n}\n\n","import { DEBUG_TAG } from \"../constants/General.mjs\";\nimport { SETTINGS } from \"../constants/Settings.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class LogUtil {\n    /**\n     * Outputs information on console, adding module name and reference\n     * @param {string} ref - Reference information to log after module name\n     * @param {any[]} data - data to log on console\n     */\n    static log(ref=\"\", data=[], bypassSettings=false){\n      try{\n        const debugSetting = SettingsUtil.get(SETTINGS.debugMode.tag);\n        const isDebugModeOn = bypassSettings || debugSetting;\n        if(!isDebugModeOn){ return };\n\n        console.log(...DEBUG_TAG, ref, ...data);\n      }catch(e){\n        console.log(...DEBUG_TAG, ref, ...data);\n      }\n    }\n\n    /**\n     * Outputs information on console, adding module name and reference\n     * @param {string} ref - Reference information to log after module name\n     * @param {any[]} data - data to log on console\n     */\n    static warn(ref=\"\", data=[]){\n      console.warn(...DEBUG_TAG, ref, ...data);\n    }\n\n    /**\n     * Logs an error on the console and/or ui notification\n     * @param {string} strRef - Reference string for the error. \n     * @param {object} options - \n     */\n    static logError(strRef, options){ // = { ui:false, console:true, permanent:false }) {\n        if(options.ui){\n            // console.log(ui.notifications);\n            ui.notifications?.error(strRef, { localize: true, permanent: options.permanent });\n        }\n        if(options.console) console.error(...DEBUG_TAG, strRef);\n    }\n}\n\n","\nexport class GeneralUtil {\n  /**\n   * Checks if module is currently installed and active\n   * @param {string} moduleName \n   * @returns \n   */\n  static isModuleOn(moduleName){\n    const module = game.modules?.get(moduleName);\n    // LogUtil.log(\"isModuleOn\", [module?.active]);\n    return module?.active ? true : false;\n  }\n\n  static html(parent, selector) {\n    return parent.querySelector(selector);\n  }\n\n  static getFullWidth(element) {\n    const style = window.getComputedStyle(element);\n    if (style.width === '0px') {\n      return 0;\n    }\n    return element.offsetWidth;\n  }\n\n  static getOffsetBottom(element) {\n    const offsetTop = element.offsetTop;\n    const elementHeight = element.offsetHeight;\n    const offsetParent = element.offsetParent;\n    const parentHeight = offsetParent ? offsetParent.clientHeight : window.innerHeight;\n  \n    return parentHeight - (offsetTop + elementHeight);\n  }\n}\n","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { SETTINGS } from \"../constants/Settings.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class TopNavigation {\n  static #navElem;\n  static #scenesList;\n  static #navTimeout;\n  static #navExtras;\n  static #navToggle;\n\n  static init(){\n    // if user disabled Scene Navigation Styles,\n    // skip everything\n    if(SettingsUtil.get(SETTINGS.sceneNavDisabled.tag)){\n      document.querySelector(\"#ui-middle\")?.classList.remove(\"crlngn-ui\");\n      return;\n    }else{\n      document.querySelector(\"#ui-middle\")?.classList.add(\"crlngn-ui\");\n    }\n\n    TopNavigation.addListeners(); \n\n    LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, [ui.nav, SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)]); \n    TopNavigation.setNavPosition(0);\n    \n    TopNavigation.placeNavButtons(); \n    if(SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)){ \n      ui.nav.collapse();\n    }else{\n      ui.nav.expand();\n    }\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_NAV, () => { \n      TopNavigation.addListeners(); \n\n      LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, [ui.nav, SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)]); \n      TopNavigation.setNavPosition();\n      \n      TopNavigation.placeNavButtons(); \n      if(SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)){ \n        ui.nav.collapse();\n      }else{\n        ui.nav.expand();\n      }\n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SIDE_BAR, (value) => { \n      TopNavigation.placeNavButtons(); \n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SCENE_NAV, (nav, value) => {\n      SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, value); \n      LogUtil.log(\"NAV toggle\", [nav, value]); \n    }); \n\n    Hooks.on(HOOKS_CORE.EXPAND_SCENE_NAV, (nav, value) => {\n      SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, false); \n      LogUtil.log(\"NAV expand\", [nav, false]); \n    }); \n\n    SettingsUtil.apply(SETTINGS.sceneNavCollapsed.tag); \n    \n  } \n\n  static addListeners(){\n    this.#navElem = document.querySelector(\"#navigation\"); \n    this.#scenesList = document.querySelector(\"#scene-list\"); \n    this.#navExtras = document.querySelector(\"#navigation .nav-item.is-root\"); \n    this.#navToggle = document.querySelector(\"#nav-toggle\"); \n\n    this.#navElem?.addEventListener(\"mouseenter\", ()=>{\n      if( !SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag) ||\n          !SettingsUtil.get(SETTINGS.showSceneNavOnHover.tag) ){ \n            return;\n      }\n      clearTimeout(this.#navTimeout);\n\n      const list = document.querySelector(\"#scene-list\");\n      list.style.display = \"flex\";\n      const navigation = document.querySelector(\"#navigation\");\n      navigation.classList.remove(\"collapsed\");\n    });\n\n    this.#navElem?.addEventListener(\"mouseleave\", (e)=>{\n      if( !SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag) ||\n          !SettingsUtil.get(SETTINGS.showSceneNavOnHover.tag) ){ \n            return;\n      }\n      if (!e) var e = window.event;\n      e.cancelBubble = true;\n      if (e.stopPropagation) e.stopPropagation();\n\n      this.#navTimeout = setTimeout(()=>{\n        clearTimeout(this.#navTimeout);\n        this.#navTimeout = null;\n        const list = document.querySelector(\"#scene-list\");\n        list.style.display = \"none\";\n        const navigation = document.querySelector(\"#navigation\");\n        navigation.classList.add(\"collapsed\");\n      }, 700);\n    });\n\n  }\n\n  static placeNavButtons(){ \n    const existingButtons = this.#navElem?.querySelectorAll(\"button.crlngn-nav\");\n    const isNavOverflowing = this.#scenesList?.scrollWidth >= this.#navElem?.offsetWidth;\n    LogUtil.log(\"placeNavButtons\", [ isNavOverflowing, existingButtons, this.#scenesList?.scrollWidth, this.#navElem?.offsetWidth]);\n    if(!isNavOverflowing || existingButtons.length > 0){\n      return;\n    }\n\n    const btnLast = document.createElement(\"button\"); \n    btnLast.classList.add(\"crlngn-nav\"); \n    btnLast.classList.add(\"ui-nav-left\"); \n    const arrowLeft = document.createElement(\"i\"); \n    arrowLeft.classList.add(\"fa\"); \n    arrowLeft.classList.add(\"fa-chevron-left\"); \n    btnLast.addEventListener(\"click\", this.#onNavLast);\n    btnLast.append(arrowLeft); \n\n    const btnNext = document.createElement(\"button\"); \n    btnNext.classList.add(\"crlngn-nav\"); \n    btnNext.classList.add(\"ui-nav-right\"); \n    const arrowRight = document.createElement(\"i\"); \n    arrowRight.classList.add(\"fa\"); \n    arrowRight.classList.add(\"fa-chevron-right\"); \n    btnNext.append(arrowRight); \n    btnNext.addEventListener(\"click\", this.#onNavNext);\n\n    this.#navElem?.appendChild(btnLast);\n    this.#navElem?.appendChild(btnNext);\n  }\n\n\n  static #onNavLast = (e) => {\n    const toggleWidth = this.#navToggle?.offsetWidth;\n    const extrasWidth = GeneralUtil.isModuleOn(\"compact-scene-navigation\") ? this.#navExtras?.offsetWidth : 0;\n    const firstScene = this.#scenesList?.querySelector(\"li.nav-item:not(.is-root)\");\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item\") || [];\n    const itemWidth = firstScene.offsetWidth;\n    const currPos = SettingsUtil.get(SETTINGS.sceneNavPos.tag) || 0;\n    const itemsPerPage = Math.floor((this.#navElem?.offsetWidth - (currPos === 0 ? extrasWidth : 0) - (toggleWidth*2))/itemWidth);\n\n    LogUtil.log(\"onNavLast\", [\"currPos\", currPos, itemsPerPage]);\n\n    let newPos = currPos - itemsPerPage;\n    newPos = newPos < 0 ? 0 : newPos;\n\n    LogUtil.log(\"onNavLast\", [\"sceneCount\", scenes.length, currPos, newPos]);\n    TopNavigation.setNavPosition(newPos); \n    \n    // LogUtil.log(\"onNavLast\", [itemsPerPage, newPos]);\n  }\n\n  static #onNavNext = (e) => {\n    const toggleWidth = this.#navToggle?.offsetWidth;\n    const extrasWidth = GeneralUtil.isModuleOn(\"compact-scene-navigation\") ? this.#navExtras?.offsetWidth : 0;\n    const firstScene = this.#scenesList?.querySelector(\"li.nav-item:not(.is-root)\");\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item:not(.is-root)\") || [];\n    const itemWidth = firstScene.offsetWidth;\n    const currPos = SettingsUtil.get(SETTINGS.sceneNavPos.tag) || 0;\n    const itemsPerPage = Math.floor((this.#navElem?.offsetWidth - (currPos === 0 ? extrasWidth : 0) - (toggleWidth*2))/itemWidth);\n\n    LogUtil.log(\"onNavLast\", [\"currPos\", currPos, itemsPerPage]);\n\n    let newPos = currPos + itemsPerPage;\n    newPos = newPos > scenes.length ? scenes.length : newPos;\n\n    TopNavigation.setNavPosition(newPos); \n    \n\n    \n  }\n\n  static setNavPosition(pos){\n    const position = pos !== undefined ? pos : SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n    const scenes = this.#scenesList?.querySelectorAll(\"li.nav-item\") || [];\n\n    const newMargin = scenes[position]?.offsetLeft * -1;\n    this.#scenesList.style.marginLeft = newMargin + 'px';\n\n    SettingsUtil.set(SETTINGS.sceneNavPos.tag, position);\n\n    LogUtil.log(\"setNavPosition\", [pos, position, scenes[position], newMargin]);\n  }\n}\n\n","import { SETTINGS } from \"../constants/Settings.mjs\";\nimport \"../styles/chat.css\"\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class ChatUtil {\n\n  static enrichCard(chatMessage, html){\n    if(SettingsUtil.get(SETTINGS.enableChatStyles.tag)){ \n      const rollType = chatMessage.flags?.dnd5e?.activity?.type || chatMessage.flags?.dnd5e?.roll?.type || \"custom\";\n      const elem = html.get(0);\n      elem.classList.add('crlngn');\n      elem.classList.add(rollType);\n    }    \n  }\n\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { SETTINGS } from \"../constants/Settings.mjs\";\nimport { GeneralUtil } from \"./GeneralUtil.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class CameraUtil {\n  static #offsetX = 0;\n  static #offsetY = 0;\n  static isDragging = false;\n  static cameraContainer;\n\n  static init(){\n    if(SettingsUtil.get(SETTINGS.enableCameraStyles.tag)){ \n\n      Hooks.on(HOOKS_CORE.RENDER_CAMERA_VIEWS, CameraUtil.onRender);\n      LogUtil.log(\"CameraUtil\", [SettingsUtil.get(SETTINGS.enableCameraStyles.tag)]);\n      // CameraUtil.onRender();\n    }    \n  }\n\n  static onRender(){\n    document.querySelector('#camera-views')?.classList.add('crlngn-ui');\n    CameraUtil.cameraContainer = document.querySelector('#camera-views .camera-container');\n\n    const controlsElem = document.querySelector('#camera-views .user-controls');\n    const cameraGrid = document.querySelector('#camera-views .camera-grid');\n\n    LogUtil.log(\"CameraUtil.onRender\", [ SettingsUtil.get(SETTINGS.cameraDockPosX.tag), SettingsUtil.get(SETTINGS.cameraDockPosY.tag) ]);\n\n    CameraUtil.resetPosition();\n    CameraUtil.placeControlsToggle();\n\n    if(CameraUtil.cameraContainer && cameraGrid && controlsElem){\n      CameraUtil.cameraContainer.insertBefore(controlsElem, cameraGrid);\n      document.querySelector('#camera-views .camera-container')?.classList.add('visible');\n    }\n    CameraUtil.makeDraggable();\n  }\n\n  static placeControlsToggle(){ \n    const camControls = document.querySelector('#camera-views .user-controls');\n    const existingButtons = camControls?.querySelectorAll(\".crlngn-video-toggle\");\n    LogUtil.log(\"placeControlsToggle\", [camControls, existingButtons]);\n\n    if(existingButtons.length > 0){\n      return; \n    }\n\n    const controlBar = document.querySelector('#camera-views .user-controls .control-bar');\n    const btnToggle = document.createElement(\"button\"); \n    btnToggle.classList.add(\"crlngn-video-toggle\"); \n    btnToggle.innerHTML = '<i class=\"fa fa-play-circle\" aria-hidden=\"true\"></i>';\n\n    camControls?.insertBefore(btnToggle, controlBar);\n  }\n\n  static makeDraggable(){\n    // const dragHandle = CameraUtil.cameraContainer.querySelector(\"drag-handle\");\n    const body = document.querySelector(\"body.crlngn-ui\");\n    CameraUtil.cameraContainer.addEventListener(\"mousedown\", (e) => {\n      const offsetBottom = GeneralUtil.getOffsetBottom(CameraUtil.cameraContainer);\n      CameraUtil.isDragging = true;\n      CameraUtil.#offsetX = e.clientX - CameraUtil.cameraContainer.offsetLeft;\n      CameraUtil.#offsetY = (window.innerHeight - e.clientY) - offsetBottom;\n      CameraUtil.cameraContainer.style.zIndex = \"1001\";\n\n      e.stopPropagation();\n    });\n\n    body.addEventListener(\"mousemove\", (e) => {\n      if (!CameraUtil.isDragging) return; \n      const offsetBottom = GeneralUtil.getOffsetBottom(CameraUtil.cameraContainer);\n      LogUtil.log(\"mousemove\", [ offsetBottom, e.clientX - CameraUtil.#offsetX, (window.innerHeight - e.clientY) - CameraUtil.#offsetY ]);\n\n      CameraUtil.cameraContainer.style.left = `${e.clientX - CameraUtil.#offsetX}px`;\n      CameraUtil.cameraContainer.style.bottom = `${(window.innerHeight - e.clientY) -  CameraUtil.#offsetY}px`;\n      // e.stopPropagation();\n    });\n\n    body.addEventListener(\"mouseup\", (e) => {\n      CameraUtil.isDragging = false; \n      SettingsUtil.set(SETTINGS.cameraDockPosX.tag, parseInt(CameraUtil.cameraContainer.style.left));\n      SettingsUtil.set(SETTINGS.cameraDockPosY.tag, parseInt(CameraUtil.cameraContainer.style.bottom));\n      LogUtil.log(\"mouseup\", [ GeneralUtil.getOffsetBottom(CameraUtil.cameraContainer), CameraUtil.#offsetX, CameraUtil.#offsetY ]);\n\n      e.stopPropagation();\n    });\n  }\n\n  static resetPosition(){\n    const savedPosX = SettingsUtil.get(SETTINGS.cameraDockPosX.tag);\n    const savedPosY = SettingsUtil.get(SETTINGS.cameraDockPosY.tag);\n\n    if(!savedPosX || !savedPosY){return;}\n    CameraUtil.cameraContainer.style.left = `${savedPosX}px`;\n    CameraUtil.cameraContainer.style.bottom = `${savedPosY}px`;\n  }\n\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { SETTINGS } from \"../constants/Settings.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class PlayersListUtil {\n\n  static init(){\n    Hooks.on(HOOKS_CORE.RENDER_PLAYERS_LIST, PlayersListUtil.onRender); \n  }\n\n  static onRender(){\n    const playersList = document.querySelector(`aside#players`);\n    const playersTitle = document.querySelector(`aside#players h3[aria-label=\"Players\"]`);\n\n    const playersHeight = playersList.offsetHeight;\n    const root = document.querySelector(\"body.crlngn-ui\");\n    root.style.setProperty('--players-list-height', playersHeight+'px');\n\n    playersTitle.addEventListener('click', ()=>{\n      if(playersList.classList.contains('expanded')){\n        playersList.classList.remove('expanded');\n      }else{\n        playersList.classList.add('expanded');\n      }\n    })\n\n  }\n\n}","import { HOOKS_CORE } from \"../constants/Hooks.mjs\"; \nimport { LogUtil } from \"./LogUtil.mjs\"; \nimport { SettingsUtil } from \"./SettingsUtil.mjs\"; \nimport { TopNavigation } from \"./TopNavUtil.mjs\"; \nimport { ChatUtil } from \"./ChatUtil.mjs\";\nimport { CameraUtil } from \"./CameraUtil.mjs\";\nimport { PlayersListUtil } from \"./PlayersListUtil.mjs\";\n\nexport class Main {\n\n  static init(){\n\n    Hooks.once(HOOKS_CORE.INIT, () => { \n      document.querySelector(\"#ui-middle\")?.classList.add(\"crlngn-ui\");\n      LogUtil.log(\"Initiating module\", [], true); \n      // Main.setupKeyListeners(); \n      SettingsUtil.registerSettings();\n      Hooks.on(HOOKS_CORE.RENDER_CHAT_MESSAGE, Main.#onRenderChatMessage); \n    });\n\n    Hooks.once(HOOKS_CORE.READY, () => {\n      var isDebugOn = SettingsUtil.get('debug-mode');\n      if(isDebugOn){CONFIG.debug.hooks = true};\n      LogUtil.log(\"Core Ready\", []);\n\n      TopNavigation.init(); \n      CameraUtil.init(); \n      PlayersListUtil.init(); \n    })\n    \n  }\n\n  static setupKeyListeners(){\n    // Listen to keydown event and store keys\n    window.addEventListener('keydown', (event) => {\n      const keyPressed = event.key;\n      const index = Main.keysPressed.indexOf(keyPressed);\n\n      if(index < 0){\n        Main.keysPressed.push(keyPressed);\n      }\n      LogUtil.log(\"Keydown\", [Main.keysPressed]);\n    });\n\n    // Listen to keyup event and remove keys\n    window.addEventListener('keyup', (event) => {\n      const keyReleased = event.key;\n      const index = Main.keysPressed.indexOf(keyReleased);\n\n      if(index >= 0){\n        Main.keysPressed.splice(index,1);\n      }\n      LogUtil.log(\"Keyup\", [Main.keysPressed]); \n    });\n  }\n\n  static #onRenderChatMessage = (chatMessage, html) => { \n    LogUtil.log(HOOKS_CORE.RENDER_CHAT_MESSAGE,[chatMessage, html]);\n  \n    ChatUtil.enrichCard(chatMessage, html);\n  }\n\n}\n","\nimport \"./styles/main.css\";\nimport \"./styles/ui-middle.css\";\nimport \"./styles/ui-top.css\";\nimport \"./styles/ui-right.css\";\nimport \"./styles/ui-bottom.css\";\nimport \"./styles/ui-left.css\";\nimport \"./styles/camera.css\";\nimport \"./styles/chat.css\";\nimport \"./styles/players-list.css\";\nimport \"./styles/other-modules.css\";\n\nimport { Main } from \"./components/Main.mjs\";\n\nMain.init();"],"names":["HOOKS_CORE","MODULE_ID","MODULE_SHORT","DEBUG_TAG","SETTING_INPUT","SETTING_SCOPE","SETTINGS","SettingsUtil","entry","setting","LogUtil","settingObj","value","customFont","settingName","moduleName","selectedSetting","newValue","settingTag","macroSizeOption","uiBottom","controlsAutoHide","controls","_a","_b","ref","data","bypassSettings","debugSetting","strRef","options","GeneralUtil","module","parent","selector","element","offsetTop","elementHeight","offsetParent","_navElem","_scenesList","_navTimeout","_navExtras","_navToggle","_onNavLast","_onNavNext","_TopNavigation","nav","__privateSet","__privateGet","list","e","_c","_d","_e","_f","_g","existingButtons","isNavOverflowing","btnLast","arrowLeft","btnNext","arrowRight","pos","position","scenes","newMargin","__privateAdd","toggleWidth","extrasWidth","firstScene","itemWidth","currPos","itemsPerPage","newPos","TopNavigation","ChatUtil","chatMessage","html","rollType","elem","_offsetX","_offsetY","_CameraUtil","controlsElem","cameraGrid","camControls","controlBar","btnToggle","body","offsetBottom","savedPosX","savedPosY","__publicField","CameraUtil","PlayersListUtil","playersList","playersTitle","playersHeight","_onRenderChatMessage","_Main","isDebugOn","event","keyPressed","keyReleased","index","Main"],"mappings":"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"}