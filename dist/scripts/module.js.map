{"version":3,"file":"module.js","sources":["../../src/constants/Hooks.mjs","../../src/constants/General.mjs","../../src/constants/Settings.mjs","../../src/components/SettingsUtil.mjs","../../src/components/LogUtil.mjs","../../src/components/TopNavUtil.mjs","../../src/components/Main.mjs","../../src/module.mjs"],"sourcesContent":["import { collapseSceneNavigation } from \"../../foundry/client/hooks.mjs\"\n\n/**\n * Foundry Core hooks\n * https://foundryvtt.com/api/classes/client.Hooks.html\n * https://foundryvtt.com/api/modules/hookEvents.html\n * */ \nexport const HOOKS_CORE = {\n  CHAT_MESSAGE: \"chatMessage\", \n  INIT: \"init\", \n  READY: \"ready\", \n  PRE_CREATE_CHAT_MESSAGE: \"preCreateChatMessage\", \n  CREATE_CHAT_MESSAGE: \"createChatMessage\", \n  RENDER_CHAT_MESSAGE: \"renderChatMessage\" ,\n  CREATE_MEASURED_TEMPLATE: \"createMeasuredTemplate\",\n  REFRESH_MEASURED_TEMPLATE: \"refreshMeasuredTemplate\",\n  GET_SCENE_CONTROLS: \"getSceneControlButtons\",\n  RENDER_SCENE_NAV: \"renderSceneNavigation\",\n  COLLAPSE_SCENE_NAV: \"collapseSceneNavigation\",\n  EXPAND_SCENE_NAV: \"expandSceneNavigation\"\n}\n\n/**\n * Hooks for DnD5e 4.x\n * According to https://github.com/foundryvtt/dnd5e/wiki/Hooks\n */\nexport const HOOKS_DND5E ={\n  // Rolls\n  PRE_ROLL_V2: \"dnd5e.preRollV2\",\n  PRE_ROLL_ABILITY_TEST: \"dnd5e.preRollAbilityTest\",\n  PRE_ROLL_ABILITY_SAVE: \"dnd5e.preRollAbilitySave\",\n  PRE_ROLL_SAVING_THROW: \"dnd5e.preRollSavingThrow\",\n  PRE_ROLL_ATTACK_V2: \"dnd5e.preRollAttackV2\",\n  PRE_ROLL_CLASS_HIT_POINTS: \"dnd5e.preRollClassHitPoints\",\n  PRE_ROLL_CONCENTRATION: \"dnd5e.preRollConcentration\",\n  PRE_ROLL_DAMAGE_V2: \"dnd5e.preRollDamageV2\",\n  PRE_ROLL_DEATH_SAVE: \"dnd5e.preRollDeathSave\",\n  PRE_ROLL_FORMULA_V2: \"dnd5e.preRollFormulaV2\", \n  PRE_ROLL_HIT_DIE_V2: \"dnd5e.preRollHitDieV2\",\n  PRE_ROLL_INITIATIVE: \"dnd5e.preRollInitiative\",\n  PRE_ROLL_NPC_HIT_POINTS: \"dnd5e.preRollNPCHitPoints\",\n  PRE_ROLL_RECHARGE_V2: \"dnd5e.preRollRechargeV2\",\n  PRE_ROLL_SKILL: \"dnd5e.preRollSkill\",\n  PRE_ROLL_TOOL_CHECK: \"dnd5e.preRollToolCheck\",\n  PRE_USE_ITEM: \"dnd5e.preUseItem\",\n  ROLL_ABILITY_TEST: \"dnd5e.rollAbilityTest\",\n  ROLL_ABILITY_SAVE: \"dnd5e.rollAbilitySave\",\n  ROLL_ATTACK_V2: \"dnd5e.rollAttackV2\",\n  ROLL_CLASS_HIT_POINTS: \"dnd5e.rollClassHitPoints\",\n  ROLL_CONCENTRATION: \"dnd5e.rollConcentration\",\n  ROLL_DEATH_SAVE: \"dnd5e.rollDeathSave\",\n  ROLL_DAMAGE_V2: \"dnd5e.rollDamageV2\",\n  ROLL_FORMULA_V2: \"dnd5e.rollFormulaV2\", \n  ROLL_HIT_DIE_V2: \"dnd5e.rollHitDieV2\",\n  ROLL_INITIATIVE: \"dnd5e.rollInitiative\",\n  ROLL_NPC_HIT_POINTS: \"dnd5e.rollNPCHitPoints\",\n  ROLL_RECHARGE_V2: \"dnd5e.rollRechargeV2\",\n  ROLL_SKILL: \"dnd5e.rollSkill\",\n  ROLL_TOOL_CHECK: \"dnd5e.rollToolCheck\",\n\n  // Rendering / Chat Messages\n  DISPLAY_CARD: \"dnd5e.preDisplayCardV2\",\n  PRE_DISPLAY_CARD_V2: \"dnd5e.preDisplayCardV2\",\n  RENDER_CHAT_MESSAGE: \"dnd5e.renderChatMessage\",\n\n  // Rest\n  PRE_LONG_REST: \"dnd5e.preLongRest\",\n  PRE_REST_COMPLETED: \"dnd5e.preRestCmpleted\",\n  PRE_SHORT_REST: \"dnd5e.preShortRest\",\n  REST_COMPLETED: \"dnd5e.restCmpleted\",\n\n  // Activities\n  ACTIVITY_CONSUMPTION: \"dnd5e.activityConsumption\",\n  POST_ACTIVITY_CONSUMPTION: \"dnd5e.postActivityConsumption\",\n  POST_CREATE_USAGE_MESSAGE: \"dnd5e.postCreateUsageMessage\",\n  POST_USE_ACTIVITY: \"dnd5e.postUseActivity\",\n  PRE_ACTIVITY_CONSUMPTION: \"dnd5e.preActivityConsumption\",\n  PRE_CREATE_USAGE_MESSAGE: \"dnd5e.preCreateUsageMessage\",\n  PRE_USE_ACTIVITY: \"dnd5e.preUseActivity\",\n\n}\n\nexport const HOOKS_DDBGL = {\n  PENDING_ROLL: \"ddb-game-log.pendingRoll\",\n  FULFILLED_ROLL: \"ddb-game-log.fulfilledRoll\"\n}","export const MODULE_ID = \"crlngn-ui\";\nexport const MODULE_TITLE = \"Carolingian UI\";\nexport const MODULE_SHORT = \"crlngn-ui\";\nexport const DEBUG_TAG = [\n  `%cCarolingian UI`,\n  `color:rgb(54, 0, 119); font-weight: bold;`,\n  `|`,\n];\n","export const SETTING_INPUT = {\n  select: \"select\", \n  checkbox: \"checkbox\",\n  text: \"text\"\n}\nexport const SETTING_SCOPE = {\n  client: \"client\",\n  world: \"world\"\n}\n\nexport const SETTINGS = { \n\n  enableChatStyles: { \n    tag: \"enable-chat-styles\", \n    label: \"Enable styles for chat messages\", \n    hint: \"(DnD5e only) Adds style modifications to chat cards. When dark mode is selected on Foundry, makes chat cards dark as well.\", \n    propType: Boolean, \n    inputType: SETTING_INPUT.checkbox, \n    default: true, \n    scope: SETTING_SCOPE.client, \n    config: true \n  }, \n\n  customFont: { \n    tag: \"custom-font\", \n    label: \"Custom fonts\", \n    hint: \"You can type the name of custom fonts loaded on Foundry core and they will be used throughout the interface. Names with spaces must be written with double quotes (\\\"Font Name\\\"). If the font doesn't load you haven't typed the name correctly, or the font was not found. Default value: \"+`\"Work Sans\", Arial, sans-serif`, \n    propType: String, \n    inputType: SETTING_INPUT.text, \n    default: `\"Work Sans\", Arial, sans-serif`, \n    scope: SETTING_SCOPE.client, \n    config: true, \n    requiresReload: true \n  }, \n\n  debugMode: { \n    tag: \"debug-mode\", \n    label: \"Debug Mode\",\n    hint: \"Enable or disable debug messages on browser console\",\n    propType: Boolean,\n    inputType: SETTING_INPUT.checkbox,\n    default: false,\n    scope: SETTING_SCOPE.client,\n    config: true\n  },\n\n  sceneNavCollapsed: { \n    tag: \"scene-nav-collapsed\", \n    label: \"Scene Navigation Collapsed\", \n    hint: \"Current state of the scene navigation toggle. Is it collapsed?\", \n    propType: Boolean, \n    inputType: SETTING_INPUT.checkbox, \n    default: true, \n    scope: SETTING_SCOPE.client, \n    config: false \n  },\n\n  sceneNavPos: { \n    tag: \"scene-nav-pos\", \n    label: \"Scene Navigation Position\", \n    hint: \"Stores current position of navigation for reset when it's re-rendered\", \n    propType: Number, \n    inputType: SETTING_INPUT.number, \n    default: 0, \n    scope: SETTING_SCOPE.client, \n    config: false \n  },\n\n}","import { MODULE_ID, MODULE_SHORT } from \"../constants/General.mjs\";\nimport { SETTINGS } from \"../constants/Settings.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\n\nexport class SettingsUtil {\n    /**\n     * Registers settings for this module\n     */\n    static registerSettings(){\n      document.querySelector(\"body\").classList.add(MODULE_SHORT); \n      \n      /**\n       * Register each of the settings defined in the SETTINGS constant \n       */\n      const settingsList = Object.entries(SETTINGS);\n      settingsList.forEach(async(entry) => {\n        const setting = entry[1]; \n        LogUtil.log(\"Registering... \",[entry]);\n\n        await game.settings.register(MODULE_ID, setting.tag, { \n          name: setting.label,\n          hint: setting.hint,\n          default: setting.default,\n          type: setting.propType,\n          scope: setting.scope,\n          config: setting.config,\n          requiresReload: setting.requiresReload || false,\n          onChange: value => SettingsUtil.apply(setting.tag, value)\n        });\n\n        if(SettingsUtil.get(setting.tag)===undefined){\n          SettingsUtil.set(setting.tag, setting.default);\n        }\n\n        if(SettingsUtil.get(SETTINGS.enableChatStyles.tag)){ \n          document.querySelector(\"body\").classList.add(\"crlngn-chat\"); \n        }\n\n        const customFont = SettingsUtil.get(SETTINGS.customFont.tag);\n        if(customFont){\n          const root = document.querySelector(\"body.crlngn-ui\");\n          root.style.setProperty('--crlngn-font-family', customFont);\n        }\n        LogUtil.log(\"registerSettings\",[setting.tag, SettingsUtil.get(setting.tag)]);\n      });\n      \n    }\n\n    /**\n     * Retrieve the value of a setting for this module\n     * @param {String} settingName \n     * @param {String} moduleName \n     * @returns {*} // current value of the setting\n     */\n    static get(settingName, moduleName=MODULE_ID){\n      if(!settingName){ return null; }\n\n      let setting = false;\n\n      if(moduleName===MODULE_ID){\n        setting = game.settings.get(moduleName, settingName);\n      }else{\n        const client = game.settings.storage.get(\"client\");\n        let selectedSetting = client[`${moduleName}.${settingName}`];\n        //\n        if(selectedSetting===undefined){\n          const world = game.settings.storage.get(\"world\");\n          selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n        }\n        setting = selectedSetting?.value;\n        LogUtil.log(\"GET Setting\", [selectedSetting, setting]);\n      }\n\n      return setting;\n    }\n    /**\n     * Retrieve the value of a setting for this module\n     * @param {String} settingName \n     * @param {String} moduleName \n     * @returns {*} // current value of the setting\n     */\n    static set(settingName, newValue, moduleName=MODULE_ID){ \n      if(!settingName){ return false; }\n\n      let selectedSetting = game.settings.storage.get(\"client\")[`${moduleName}.${settingName}`];\n\n      if(!selectedSetting){\n        const world = game.settings.storage.get(\"world\");\n        selectedSetting = world.getSetting(`${moduleName}.${settingName}`);\n      } \n      LogUtil.log(\"Setting\",[settingName, selectedSetting]);\n\n      try{\n        game.settings.set(moduleName, settingName, newValue);\n        // selectedSetting.update({value: newValue});\n      }catch(e){\n        LogUtil.log(\"Unable to change setting\",[settingName, selectedSetting]);\n      }\n\n      return true;\n    }\n\n    /**\n     * Apply current settings\n     */\n    static apply(settingTag, value=undefined){\n\n      if(value===undefined){\n        value = SettingsUtil.get(settingTag);\n      }\n      LogUtil.log(\"SettingsUtil.apply\",[settingTag, value, SettingsUtil.get(settingTag)]); \n      switch(settingTag){\n        default:\n          // do nothing\n      }\n      \n    }\n\n\n    static applySettings(){\n      const settingsList = Object.entries(SETTINGS);\n      settingsList.forEach((entry) => {\n        const setting = entry[1]; \n        let currSetting = SettingsUtil.get(setting.tag);\n        SettingsUtil.apply(setting.tag, currSetting);\n      });\n    }\n}\n\n","import { DEBUG_TAG } from \"../constants/General.mjs\";\nimport { SETTINGS } from \"../constants/Settings.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class LogUtil {\n    /**\n     * Outputs information on console, adding module name and reference\n     * @param {string} ref - Reference information to log after module name\n     * @param {any[]} data - data to log on console\n     */\n    static log(ref=\"\", data=[], bypassSettings=false){\n      try{\n        const debugSetting = SettingsUtil.get(SETTINGS.debugMode.tag);\n        const isDebugModeOn = bypassSettings || debugSetting;\n        if(!isDebugModeOn){ return };\n\n        console.log(...DEBUG_TAG, ref, ...data);\n      }catch(e){\n        console.log(...DEBUG_TAG, ref, ...data);\n      }\n    }\n\n    /**\n     * Outputs information on console, adding module name and reference\n     * @param {string} ref - Reference information to log after module name\n     * @param {any[]} data - data to log on console\n     */\n    static warn(ref=\"\", data=[]){\n      console.warn(...DEBUG_TAG, ref, ...data);\n    }\n\n    /**\n     * Logs an error on the console and/or ui notification\n     * @param {string} strRef - Reference string for the error. \n     * @param {object} options - \n     */\n    static logError(strRef, options){ // = { ui:false, console:true, permanent:false }) {\n        if(options.ui){\n            // console.log(ui.notifications);\n            ui.notifications?.error(strRef, { localize: true, permanent: options.permanent });\n        }\n        if(options.console) console.error(...DEBUG_TAG, strRef);\n    }\n}\n\n","import { HOOKS_CORE } from \"../constants/Hooks.mjs\";\nimport { SETTINGS } from \"../constants/Settings.mjs\";\nimport { LogUtil } from \"./LogUtil.mjs\";\nimport { SettingsUtil } from \"./SettingsUtil.mjs\";\n\nexport class TopNavigation {\n  static #navElem;\n  static #scenesList;\n  static #navTimeout;\n\n  static init(){\n\n    Hooks.on(HOOKS_CORE.RENDER_SCENE_NAV, (a, b, c) => { \n      TopNavigation.addListeners()\n\n      LogUtil.log(HOOKS_CORE.RENDER_SCENE_NAV, [ui.nav, SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)]); \n      TopNavigation.setNavPosition();\n      TopNavigation.placeNavButtons(); \n\n      if(SettingsUtil.get(SETTINGS.sceneNavCollapsed.tag)){ \n        ui.nav.collapse();\n      }else{\n        ui.nav.expand();\n      }\n    }); \n\n    Hooks.on(HOOKS_CORE.COLLAPSE_SCENE_NAV, (nav, value) => {\n      SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, value); \n      LogUtil.log(\"NAV toggle\", [nav, value]); \n    }); \n\n    Hooks.on(HOOKS_CORE.EXPAND_SCENE_NAV, (nav, value) => {\n      SettingsUtil.set(SETTINGS.sceneNavCollapsed.tag, false); \n      LogUtil.log(\"NAV expand\", [nav, false]); \n    }); \n\n    SettingsUtil.apply(SETTINGS.sceneNavCollapsed.tag); \n    \n  } \n\n  static addListeners(){\n    this.#navElem = document.querySelector(\"#navigation\"); \n    this.#scenesList = document.querySelector(\"#scene-list\"); \n\n    this.#navElem.addEventListener(\"mouseenter\", ()=>{\n      clearTimeout(this.#navTimeout);\n      ui.nav.expand();\n    });\n\n    this.#navElem.addEventListener(\"mouseleave\", (e)=>{\n      if (!e) var e = window.event;\n      e.cancelBubble = true;\n      if (e.stopPropagation) e.stopPropagation();\n\n      this.#navTimeout = setTimeout(()=>{\n        clearTimeout(this.#navTimeout);\n        this.#navTimeout = null;\n        ui.nav.collapse();\n      }, 700);\n    });\n\n  }\n\n  static placeNavButtons(){ \n\n    const btnLast = document.createElement(\"button\"); \n    btnLast.classList.add(\"crlngn\"); \n    btnLast.classList.add(\"ui-nav-left\"); \n    const arrowLeft = document.createElement(\"i\"); \n    arrowLeft.classList.add(\"fa\"); \n    arrowLeft.classList.add(\"fa-chevron-left\"); \n    btnLast.addEventListener(\"click\", this.#onNavLast);\n    btnLast.append(arrowLeft); \n\n    const btnNext = document.createElement(\"button\"); \n    btnNext.classList.add(\"crlngn\"); \n    btnNext.classList.add(\"ui-nav-right\"); \n    const arrowRight = document.createElement(\"i\"); \n    arrowRight.classList.add(\"fa\"); \n    arrowRight.classList.add(\"fa-chevron-right\"); \n    btnNext.append(arrowRight); \n    btnNext.addEventListener(\"click\", this.#onNavNext);\n\n    this.#navElem.appendChild(btnLast);\n    this.#navElem.appendChild(btnNext);\n  }\n\n  static #onNavLast = (e) => {\n    const firstElem = this.#scenesList?.querySelector(\"li:first-child\");\n    const itemWidth = firstElem.offsetWidth;\n    const itemsPerPage = Math.floor(this.#scenesList?.offsetWidth/itemWidth);\n    const currScrollPos = parseInt(firstElem.style.marginLeft || 0); \n    let newPos = 0;\n\n    if(currScrollPos < 0){\n      const newMargin = Number(currScrollPos + (itemWidth*itemsPerPage));\n      newPos = (newMargin < 0 ? newMargin : 0);\n    }\n    SettingsUtil.set(SETTINGS.sceneNavPos.tag, newPos);\n    TopNavigation.setNavPosition(newPos);\n    \n    LogUtil.log(\"onNavLast\", [itemsPerPage, itemWidth, currScrollPos, newPos]);\n  }\n\n  static #onNavNext = (e) => {\n    const firstElem = this.#scenesList?.querySelector(\"li:first-child\");\n    const itemWidth = firstElem.offsetWidth;\n    const itemsPerPage = Math.floor(this.#scenesList?.offsetWidth/itemWidth);\n    const currScrollPos = parseInt(firstElem.style.marginLeft || 0); \n    let newPos = 0;\n    LogUtil.log(\"onNavNext\", [firstElem.style.marginLeft, currScrollPos]);\n\n    if(this.#scenesList?.scrollWidth + currScrollPos > this.#scenesList?.offsetWidth ){\n      const newMargin = Number(currScrollPos - (itemWidth*itemsPerPage));\n      const minMargin = -(this.#scenesList?.offsetWidth - itemWidth);\n      newPos = (newMargin > minMargin ? newMargin : minMargin);\n    }\n    SettingsUtil.set(SETTINGS.sceneNavPos.tag, newPos);\n    TopNavigation.setNavPosition(newPos);\n    \n    LogUtil.log(\"onNavNext\", [itemsPerPage, itemWidth, currScrollPos, newPos, this.#scenesList?.offsetWidth]);\n  }\n\n  static setNavPosition(pos){\n    const position = pos || SettingsUtil.get(SETTINGS.sceneNavPos.tag);\n    const firstElem = this.#scenesList?.querySelector(\"li:first-child\");\n    firstElem.style.marginLeft = position + 'px';\n  }\n}\n\n","import { HOOKS_CORE } from \"../constants/Hooks.mjs\"; \nimport { LogUtil } from \"./LogUtil.mjs\"; \nimport { SettingsUtil } from \"./SettingsUtil.mjs\"; \nimport { TopNavigation } from \"./TopNavUtil.mjs\"; \n\nexport class Main {\n\n  static init(){\n\n    Hooks.once(HOOKS_CORE.INIT, () => { \n\n      LogUtil.log(\"Initiating module\", [], true); \n      // Main.setupKeyListeners(); \n      SettingsUtil.registerSettings();\n\n    });\n\n    Hooks.once(HOOKS_CORE.READY, () => {\n      \n      TopNavigation.init(); \n\n      var isDebugOn = SettingsUtil.get('debug-mode');\n      if(isDebugOn){CONFIG.debug.hooks = true};\n      LogUtil.log(\"Core Ready\", []);\n    })\n  }\n\n  static setupKeyListeners(){\n    // Listen to keydown event and store keys\n    window.addEventListener('keydown', (event) => {\n      const keyPressed = event.key;\n      const index = Main.keysPressed.indexOf(keyPressed);\n\n      if(index < 0){\n        Main.keysPressed.push(keyPressed);\n      }\n      LogUtil.log(\"Keydown\", [Main.keysPressed]);\n    });\n\n    // Listen to keyup event and remove keys\n    window.addEventListener('keyup', (event) => {\n      const keyReleased = event.key;\n      const index = Main.keysPressed.indexOf(keyReleased);\n\n      if(index >= 0){\n        Main.keysPressed.splice(index,1);\n      }\n      LogUtil.log(\"Keyup\", [Main.keysPressed]); \n    });\n  }\n\n}\n","\nimport \"./styles/main.css\";\nimport \"./styles/ui-middle.css\";\nimport \"./styles/ui-top.css\";\nimport \"./styles/ui-right.css\";\nimport \"./styles/ui-bottom.css\";\nimport \"./styles/ui-left.css\";\nimport \"./styles/camera.css\";\nimport \"./styles/chat.css\";\n\nimport { Main } from \"./components/Main.mjs\";\n\nMain.init();"],"names":["HOOKS_CORE","MODULE_ID","MODULE_SHORT","DEBUG_TAG","SETTING_INPUT","SETTING_SCOPE","SETTINGS","SettingsUtil","entry","setting","LogUtil","value","customFont","settingName","moduleName","selectedSetting","newValue","settingTag","currSetting","ref","data","bypassSettings","debugSetting","strRef","options","_a","_navElem","_scenesList","_navTimeout","_onNavLast","_onNavNext","_TopNavigation","a","b","c","nav","__privateSet","__privateGet","btnLast","arrowLeft","btnNext","arrowRight","pos","position","firstElem","__privateAdd","e","_b","itemWidth","itemsPerPage","currScrollPos","newPos","newMargin","_c","_d","_e","_f","minMargin","TopNavigation","Main","isDebugOn","event","keyPressed","keyReleased","index"],"mappings":"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"}